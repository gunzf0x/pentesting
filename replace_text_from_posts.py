import re
import argparse
import os


def parse_arguments()->argparse.Namespace:
        parser = argparse.ArgumentParser(description="Replace [[ and ]] with ` and netcat|nc with netcat")
        parser.add_argument("file", help="Input file to process")
        return parser.parse_args()


def process_content(content: str):
        # Replace "[[" and "]]" with "`"
        content = re.sub(r'\[\[', '`', content)
        content = re.sub(r'\]\]', '`', content)

        # Replace "netcat|nc" with "netcat"
        content = re.sub(r'netcat\|nc', 'netcat', content)
        return content


def process_file(file_path: str):
    if not os.path.isfile(file_path):
        print("Error: Input file not found.")
        return None

    # Read the content of the input file
    with open(file_path, 'r') as f:
        content = f.read()

    modified_content = process_content(content)

    # Write the modified content back to the file
    with open(file_path, 'w') as f:
        f.write(modified_content)

    return file_path


if __name__ == "__main__":
    args: argparse.Namespace = parse_arguments()
    processed_file = process_file(args.file)

    if processed_file:
        print("Replacement completed successfully for", processed_file)
